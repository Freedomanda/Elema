*&---------------------------------------------------------------------*
*& Report  YTEST2015_07_28
*&
*&---------------------------------------------------------------------*
*&
*&
*&---------------------------------------------------------------------*

REPORT  YTEST2015_07_28.




START-OF-SELECTION.

DATA:
LST_GOODSMVT_HEADER TYPE BAPI2017_GM_HEAD_01,
LST_GOODSMVT_CODE   TYPE BAPI2017_GM_CODE,
LW_TESTRUN          TYPE BAPI2017_GM_GEN-TESTRUN,
LW_MATERIALDOCUMENT TYPE BAPI2017_GM_HEAD_RET-MAT_DOC,
LW_MATDOCUMENTYEAR  TYPE BAPI2017_GM_HEAD_RET-DOC_YEAR,
LTD_GOODSMVT_ITEM   TYPE STANDARD TABLE OF BAPI2017_GM_ITEM_CREATE,
Lst_GOODSMVT_ITEM   TYPE BAPI2017_GM_ITEM_CREATE,
LTD_RETURN          TYPE STANDARD TABLE OF BAPIRET2.

LST_GOODSMVT_HEADER-PSTNG_DATE = '20150728'.
LST_GOODSMVT_HEADER-DOC_DATE = '20150728'.
LST_GOODSMVT_HEADER-PR_UNAME = 'ISID17'.

LST_GOODSMVT_CODE-GM_CODE    = '01'.

Lst_GOODSMVT_ITEM-MATERIAL = 'BY05-09S16M'.
Lst_GOODSMVT_ITEM-PLANT = 'P040'.
Lst_GOODSMVT_ITEM-STGE_LOC = 'H000'.
Lst_GOODSMVT_ITEM-MOVE_TYPE = '101'.
Lst_GOODSMVT_ITEM-STCK_TYPE = '3'.
Lst_GOODSMVT_ITEM-ENTRY_QNT = 10.
Lst_GOODSMVT_ITEM-ENTRY_UOM = 'ST'.
Lst_GOODSMVT_ITEM-PO_NUMBER = '4503200059'.
Lst_GOODSMVT_ITEM-PO_ITEM = '00010'.
Lst_GOODSMVT_ITEM-MVT_IND = 'B'.
APPEND Lst_GOODSMVT_ITEM to LTD_GOODSMVT_ITEM.

CALL FUNCTION 'BAPI_GOODSMVT_CREATE'
EXPORTING
GOODSMVT_HEADER  = LST_GOODSMVT_HEADER
GOODSMVT_CODE    = LST_GOODSMVT_CODE
TESTRUN          = LW_TESTRUN
IMPORTING
MATERIALDOCUMENT = LW_MATERIALDOCUMENT
MATDOCUMENTYEAR  = LW_MATDOCUMENTYEAR
TABLES
GOODSMVT_ITEM    = LTD_GOODSMVT_ITEM
RETURN           = LTD_RETURN.

clear: LST_GOODSMVT_HEADER,
LST_GOODSMVT_CODE,
LW_TESTRUN,
LW_MATERIALDOCUMENT,
LW_MATDOCUMENTYEAR,
LTD_GOODSMVT_ITEM,
LTD_RETURN.

LST_GOODSMVT_HEADER-PSTNG_DATE = '20150728'.
LST_GOODSMVT_HEADER-DOC_DATE = '20150728'.
LST_GOODSMVT_HEADER-PR_UNAME = 'ISID17'.

LST_GOODSMVT_CODE-GM_CODE    = '01'.

Lst_GOODSMVT_ITEM-MATERIAL = 'BY05-09S16M'.
Lst_GOODSMVT_ITEM-PLANT = 'P040'.
Lst_GOODSMVT_ITEM-STGE_LOC = 'H000'.
Lst_GOODSMVT_ITEM-MOVE_TYPE = '101'.
Lst_GOODSMVT_ITEM-STCK_TYPE = '3'.
Lst_GOODSMVT_ITEM-ENTRY_QNT = 10.
Lst_GOODSMVT_ITEM-ENTRY_UOM = 'ST'.
Lst_GOODSMVT_ITEM-PO_NUMBER = '4503200061'.
Lst_GOODSMVT_ITEM-PO_ITEM = '00010'.
Lst_GOODSMVT_ITEM-MVT_IND = 'B'.
APPEND Lst_GOODSMVT_ITEM to LTD_GOODSMVT_ITEM.

CALL FUNCTION 'BAPI_GOODSMVT_CREATE'
EXPORTING
GOODSMVT_HEADER  = LST_GOODSMVT_HEADER
GOODSMVT_CODE    = LST_GOODSMVT_CODE
TESTRUN          = LW_TESTRUN
IMPORTING
MATERIALDOCUMENT = LW_MATERIALDOCUMENT
MATDOCUMENTYEAR  = LW_MATDOCUMENTYEAR
TABLES
GOODSMVT_ITEM    = LTD_GOODSMVT_ITEM
RETURN           = LTD_RETURN.

CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'
EXPORTING
WAIT = 'X'.

*  CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.
