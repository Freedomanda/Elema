************************************************************************
*& Program           : Z_UTILITY_UPGRADE                               *
*& Developer(Company): IBM India                                       *
*& Create Date       : 05/26/2007                                      *
*& Program Type      : Report                                          *
*& Description       :                                                 *
************************************************************************

REPORT  z_ibm_utility_upgrade          LINE-SIZE 200
LINE-COUNT 65
MESSAGE-ID 00
NO STANDARD PAGE HEADING .

INCLUDE z_ibm_zzn_data_decl.
INCLUDE z_ibm_excel_data_decl.
INCLUDE z_ibm_excel_download.

INCLUDE <icon>.
* Start of change by TDEY ----
TYPE-POOLS: vrm.
* End of change by TDEY ----

*---------------------------------------------------------------------*
*             S E L E C T I O N    S C R E E N   D E S I G N          *
*---------------------------------------------------------------------*



SELECTION-SCREEN BEGIN OF BLOCK chk_parm
WITH FRAME TITLE text-001.

SELECTION-SCREEN BEGIN OF LINE.

* standard code modifiaction
PARAMETERS: std_modf   AS CHECKBOX DEFAULT 'X'.

SELECTION-SCREEN COMMENT 2(30) text-002 FOR FIELD std_modf.
SELECTION-SCREEN POSITION 50.

* all custom developments
PARAMETERS:  cus_dev  AS CHECKBOX DEFAULT 'X'
** Begin of change ** RKUMAR7 **
USER-COMMAND ucomm2.
** End of change ** RKUMAR7 **
SELECTION-SCREEN COMMENT 55(35) text-003 FOR FIELD cus_dev.
SELECTION-SCREEN END OF LINE.

* Start of change by TDEY ----
SELECTION-SCREEN BEGIN OF BLOCK cdev
WITH FRAME TITLE text-236.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN POSITION 25.
PARAMETERS: p_cver TYPE char4 AS LISTBOX VISIBLE LENGTH 14
MODIF ID upg.
SELECTION-SCREEN COMMENT 1(20) text-234 FOR FIELD p_cver MODIF ID upg.
SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN POSITION 25.
PARAMETERS: p_ver TYPE char4 AS LISTBOX VISIBLE LENGTH 14 MODIF ID upg.
SELECTION-SCREEN COMMENT 1(20) text-207 FOR FIELD p_ver MODIF ID upg.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS: p_ucode AS CHECKBOX DEFAULT 'X' MODIF ID upg.
SELECTION-SCREEN COMMENT 2(30) text-235 FOR FIELD p_ucode MODIF ID upg.
SELECTION-SCREEN END OF LINE.

***>>>Begin of change by Rudra R
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS : p_upgrd AS CHECKBOX DEFAULT ' ' MODIF ID upg.
SELECTION-SCREEN COMMENT 2(60) text-260 FOR FIELD p_upgrd MODIF ID upg.
SELECTION-SCREEN END OF LINE.

***>>>End of change by Rudra R
** Begin of change ** RKUMAR7 **
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN POSITION 30.
PARAMETERS: p_count TYPE i VISIBLE LENGTH 2 DEFAULT 4 MODIF ID upg.
SELECTION-SCREEN COMMENT 1(26) text-205 FOR FIELD p_count MODIF ID upg.
SELECTION-SCREEN END OF LINE.
** End of change ** RKUMAR7 **

SELECTION-SCREEN END OF BLOCK cdev.
* End of change by TDEY ----


SELECTION-SCREEN BEGIN OF LINE.
* details of custom tables/views/structures
PARAMETERS: cus_det   AS CHECKBOX DEFAULT 'X'.

SELECTION-SCREEN COMMENT 2(45) text-022 FOR FIELD cus_det.
SELECTION-SCREEN POSITION 50.

PARAMETERS:  cus_ind  AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 55(35) text-041 FOR FIELD cus_ind.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.

* details of custom query
PARAMETERS: cus_que   AS CHECKBOX DEFAULT 'X'.

SELECTION-SCREEN COMMENT 2(30) text-043 FOR FIELD cus_que.
SELECTION-SCREEN POSITION 50.

* all custom messages details
PARAMETERS:  cus_var  AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 55(35) text-044 FOR FIELD cus_var.
SELECTION-SCREEN END OF LINE.


SELECTION-SCREEN BEGIN OF LINE.

* details of custom area menu
PARAMETERS: cus_area   AS CHECKBOX DEFAULT 'X'.

SELECTION-SCREEN COMMENT 2(45) text-042 FOR FIELD cus_area.
SELECTION-SCREEN POSITION 50.

* all custom messages details
PARAMETERS:  cus_mes  AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 55(35) text-023 FOR FIELD cus_mes.
SELECTION-SCREEN END OF LINE.


SELECTION-SCREEN BEGIN OF LINE.

* Display custom progs according to application
****Begin of change by Rudra R
*PARAMETERS: dev_appl   AS CHECKBOX DEFAULT 'X'.
*SELECTION-SCREEN COMMENT 2(40) text-004 FOR FIELD dev_appl.

* Display WorkFlow
PARAMETERS: workflow   AS CHECKBOX DEFAULT 'X' USER-COMMAND wfl.
SELECTION-SCREEN COMMENT 2(40) text-139 FOR FIELD workflow.
****End of change by Rudra R

SELECTION-SCREEN POSITION 50.


* Display Enhancement according to application
PARAMETERS: enhan   AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 55(55) text-121 FOR FIELD enhan.
SELECTION-SCREEN END OF LINE.


****Begin of change by Rudra R
SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN COMMENT 2(25) text-416 FOR FIELD p_date MODIF ID wfl.
SELECTION-SCREEN POSITION 28.
SELECT-OPTIONS : p_date FOR swr_timint-low NO-EXTENSION MODIF ID wfl.
** Display WorkFlow
*PARAMETERS: workflow   AS CHECKBOX DEFAULT 'X'.
*SELECTION-SCREEN COMMENT 2(40) text-139 FOR FIELD workflow.
*SELECTION-SCREEN POSITION 50.
SELECTION-SCREEN END OF LINE.
***End of change by Rudra R

SELECTION-SCREEN SKIP 1 .
SELECTION-SCREEN BEGIN OF BLOCK filter
WITH FRAME TITLE text-079.

SELECT-OPTIONS : s_name FOR
zibm_cust_object_type-object_id
NO INTERVALS  OBLIGATORY ,
s_pack FOR tadir-devclass.

*SELECTION-SCREEN SKIP 1 .
SELECTION-SCREEN END OF BLOCK filter.


SELECTION-SCREEN END OF BLOCK chk_parm.

SELECTION-SCREEN BEGIN OF BLOCK intf_conv
WITH FRAME TITLE text-075.
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS: p_ale   AS CHECKBOX DEFAULT 'X'.

SELECTION-SCREEN COMMENT 2(40) text-076 FOR FIELD p_ale.
SELECTION-SCREEN POSITION 50.

* SAP Outputs MAINTAINED IN MUL LANGUAGE
PARAMETERS:  p_lsmw  AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 55(50) text-077 FOR FIELD p_lsmw.

SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN END OF BLOCK intf_conv.

SELECTION-SCREEN BEGIN OF BLOCK chk_parm_basis
WITH FRAME TITLE text-066.
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS  p_comp AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 2(30) text-068 FOR FIELD p_comp.

SELECTION-SCREEN POSITION 50.

PARAMETERS  p_lang AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 55(35) text-070 FOR FIELD p_lang.

SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS p_land AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 2(30) text-071 FOR FIELD p_land.
SELECTION-SCREEN POSITION 50.

PARAMETERS p_hrdw AS CHECKBOX DEFAULT 'X'.

SELECTION-SCREEN COMMENT 55(35) text-072 FOR FIELD p_hrdw.
SELECTION-SCREEN END OF LINE.

* Start of change by TDEY ----
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS p_user AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 2(30) text-208 FOR FIELD p_user.

SELECTION-SCREEN POSITION 50.
PARAMETERS p_server AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 55(35) text-209 FOR FIELD p_server.

SELECTION-SCREEN END OF LINE.
* End of change by TDEY ----

** Begin of change ** RKUMAR7 **
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS  p_rfc AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 2(30) text-201 FOR FIELD p_rfc.
SELECTION-SCREEN POSITION 50.
PARAMETERS p_gtway AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 55(35) text-203 FOR FIELD p_gtway.
SELECTION-SCREEN END OF LINE.
*SELECTION-SCREEN BEGIN OF LINE.
*PARAMETERS p_bkgrnd AS CHECKBOX DEFAULT 'X'.
*SELECTION-SCREEN COMMENT 2(30) text-204 FOR FIELD p_bkgrnd.
*SELECTION-SCREEN POSITION 50.
*SELECTION-SCREEN END OF LINE.
** End of change ** RKUMAR7 **
SELECTION-SCREEN END OF BLOCK chk_parm_basis.

SELECTION-SCREEN BEGIN OF BLOCK chk_parm_his
WITH FRAME TITLE text-067.
SELECTION-SCREEN BEGIN OF LINE.

PARAMETERS:
p_pghis DEFAULT 'X' AS CHECKBOX.
SELECTION-SCREEN COMMENT 2(30) text-073 FOR FIELD p_pghis.
SELECTION-SCREEN POSITION 50.
PARAMETERS p_dbhis DEFAULT 'X' AS CHECKBOX.
SELECTION-SCREEN COMMENT 55(35) text-074 FOR FIELD p_dbhis.

SELECTION-SCREEN END OF LINE.
** Begin of change ** RKUMAR7 ** 30.07.2009
SELECTION-SCREEN BEGIN OF LINE.
PARAMETERS p_bkgrnd AS CHECKBOX DEFAULT 'X'.
SELECTION-SCREEN COMMENT 2(30) text-204 FOR FIELD p_bkgrnd.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
SELECTION-SCREEN POSITION 30.
*PARAMETERS: p_month TYPE i DEFAULT 6.
PARAMETERS: p_month TYPE numc3 DEFAULT 6.
SELECTION-SCREEN COMMENT 1(26) text-210 FOR FIELD p_month.
SELECTION-SCREEN END OF LINE.
** End of change ** RKUMAR7 ** 30.07.2009
SELECTION-SCREEN END OF BLOCK chk_parm_his.



SELECTION-SCREEN BEGIN OF BLOCK chk_parm_gen
WITH FRAME TITLE text-069.

PARAMETERS :  p_summ  RADIOBUTTON  GROUP rad1 .
* Start of change by TDEY ----
*USER-COMMAND ucomm1.
* End of change by TDEY ----

PARAMETERS :  p_det  RADIOBUTTON  GROUP   rad1  .

PARAMETERS: p_estm RADIOBUTTON  GROUP
rad1.

SELECTION-SCREEN END OF BLOCK chk_parm_gen.

SELECTION-SCREEN FUNCTION KEY 1.
SELECTION-SCREEN FUNCTION KEY 2.


*********************************************************************
*                  INITIALIZATION                                   *
*********************************************************************


INITIALIZATION.

** Start of change by RKUMAR7 ** 29.10.2009 12:44:50 **
AUTHORITY-CHECK OBJECT 'ZIBM_SUET'
ID 'ACTVT' FIELD '16'.
IF sy-subrc NE 0.
MESSAGE a001 WITH
'You are not authorized to run this transaction'(174).
ENDIF.
** End of change by RKUMAR7 ** 29.10.2009 12:44:53 **


s_name-sign = 'I'.
s_name-option  =   'EQ'.
s_name-low = 'Y*' .
APPEND s_name .

s_name-sign = 'I'.
s_name-option  =   'EQ'.
s_name-low = 'Z*' .
APPEND s_name .

s_name-sign = 'I'.
s_name-option  =   'EQ'.
s_name-low = 'SAPMZ*' .
APPEND s_name .

s_name-sign = 'I'.
s_name-option  =   'EQ'.
s_name-low = 'SAPMY*' .
APPEND s_name .

* restricting the select option to single value only
PERFORM sub_restr_param.

MOVE '@4B@' TO smp_dyntxt-icon_id .
MOVE 'Select All'(006) TO smp_dyntxt-quickinfo.
MOVE smp_dyntxt TO sscrfields-functxt_01.

MOVE '@4D@' TO smp_dyntxt-icon_id .
MOVE 'Deselect All'(007) TO smp_dyntxt-quickinfo.
MOVE smp_dyntxt TO sscrfields-functxt_02.

* Initialize Excel Download
PERFORM initialize_excel_download.

****Begin of change by Rudra R
PERFORM default_date_range_wflow.

****End of change by Rudra R
*********************************************************************
*                  At selection-screen  Event                       *
*********************************************************************

AT SELECTION-SCREEN.

v_ucomm = sy-ucomm.

IF sy-ucomm EQ space   OR
sy-ucomm EQ c_onli  OR
sy-ucomm EQ c_sjob  OR
sy-ucomm EQ c_spos  OR
sy-ucomm EQ c_prin.

IF  p_estm = 'X'.
PERFORM sub_chk_est .
ENDIF.

*** check atleast one checkbox is checked
PERFORM sub_chk_chkbox .

ENDIF.

*********************************************************************
*                  At selection-screen output Event                 *
*********************************************************************

AT SELECTION-SCREEN OUTPUT.
IF  v_ucomm = 'FC01'.
cus_dev = c_flag .
*    dev_appl = c_flag . " Rudra R
cus_det = c_flag .
cus_ind = c_flag .
cus_area = c_flag .
cus_mes = c_flag .
std_modf =  c_flag .
cus_var = c_flag .
cus_que = c_flag.
p_comp = c_flag.
p_dbhis = c_flag.
p_hrdw = c_flag.
* Start of change by TDEY ----
p_ucode = c_flag.
p_user = c_flag.
p_server = c_flag.
* End of change by TDEY ----
p_land = c_flag.
p_lang = c_flag.
** Begin of change ** RKUMAR7 **
p_gtway = c_flag.
p_rfc  = c_flag.
p_bkgrnd = c_flag.
** End of change ** RKUMAR7 **
p_pghis = c_flag.
p_dbhis = c_flag.
p_lsmw  = c_flag.
p_ale  = c_flag.
enhan = c_flag.
workflow = c_flag.

ELSEIF  v_ucomm = 'FC02'.
cus_dev = space .
*    dev_appl = space . "Rudra R
cus_det = space .
cus_mes = space .
cus_ind = space .
cus_area = space .
std_modf =  space .
cus_var = space .
cus_que = space.
p_comp = space.
p_dbhis = space.
p_hrdw = space.
* Start of change by TDEY ----
p_ucode = space.
p_user = space.
p_server = space.
* End of change by TDEY ----
p_land = space.
p_lang = space.
** Begin of change ** RKUMAR7 **
p_rfc  = space.
p_gtway = space.
p_bkgrnd = space.
** End of change ** RKUMAR7 **
p_pghis = space.
p_dbhis = space.
p_lsmw = space.
p_ale  = space.
enhan = space.
workflow = space.

ENDIF.

** Begin of change ** RKUMAR7 **
LOOP AT SCREEN.

* Start of change by TDEY ----
IF screen-name = 'P_CVER'
OR screen-name = '%F234012_1000'
OR screen-name = 'P_VER'
OR screen-name = '%F207015_1000'
OR screen-name = 'P_UCODE'
OR screen-name = '%F235019_1000'
OR screen-group1 = 'UPG' "Rudra
OR screen-group1 = 'WFL'. "Rudra

IF cus_dev = c_flag.
screen-active = 1.
IF screen-name = 'P_CVER'
OR screen-name = 'P_VER'.
screen-required = 1.
ENDIF.

screen-input = 1.
IF p_cver IS INITIAL.
p_cver = '46C'.
ENDIF.
IF p_ver IS INITIAL.
p_ver = 'ECC6'.
ENDIF.

screen-invisible = 0.

ELSE.
p_cver = space.
p_ver = space.
screen-active = 0.
screen-required = 0.
screen-input = 0.
screen-invisible = 1.
ENDIF.

****Begin of change by Rudra R
IF screen-group1 = 'WFL'.
IF workflow = c_flag.
screen-active = 1.
*          screen-required = 1.
screen-input = 1.
screen-invisible = 0.
ELSE.
screen-active = 0.
screen-required = 0.
screen-input = 0.
screen-invisible = 1.
ENDIF.
** Begin of change ** RKUMAR7 ** 27.10.2009 20:29:02
IF screen-name = '%_P_DATE_%_APP_%-OPTI_PUSH'.
screen-input = 0.
ENDIF.
** End of change ** RKUMAR7 ** 27.10.2009 20:29:06
ENDIF.

MODIFY SCREEN.
ENDIF.
****End of change by Rudra R
* End of change by TDEY ----

IF screen-name = 'P_COUNT'
OR screen-name = '%F205022_1000'.
IF cus_dev = c_flag.
screen-active = 1.
screen-input = 1.
ELSE.
screen-active = 0.
screen-input = 0.
ENDIF.
MODIFY SCREEN.
ENDIF.
ENDLOOP.
** End of change ** RKUMAR7 **


* Start of change by TDEY ----
PERFORM sub_populate_sap_version.
* End of change by TDEY ----


*******************************************************
*  START OF SELECTION
*******************************************************


START-OF-SELECTION.

LOOP AT s_name .

IF s_name-low CS '*' .
wa_object-low  = s_name-low .
ELSE .
CONCATENATE s_name-low '*' INTO  wa_object-low .
ENDIF.
wa_object-sign = 'I'.
wa_object-option = 'CP'.
APPEND wa_object TO r_object.
CLEAR wa_object .

ENDLOOP.
** get all the objects and their corrsponding desc
PERFORM sub_get_obj_desc .

IF p_estm = 'X'.

PERFORM sub_get_index .
PERFORM sub_get_query .
PERFORM sub_get_area_menu .
PERFORM sub_get_ale_info.


IF p_lsmw = 'X'.
PERFORM sub_get_lsmw_info.
ENDIF.
IF std_modf = c_flag .
*   check any standard code is modifed or not
PERFORM sub_check_std_code .
ENDIF.

IF cus_dev = c_flag OR cus_det = c_flag.
*   findout all custom developmets
PERFORM sub_cus_dev .
ENDIF.
IF cus_det = c_flag .
*   get all details of view/tables/structures
PERFORM sub_field_details .
ENDIF.
IF enhan = c_flag.
PERFORM sub_get_enhancements.
ENDIF.

ELSE.
IF std_modf = c_flag .
* check any standard code is modifed or not
PERFORM sub_check_std_code .
ENDIF.

IF cus_dev = c_flag
OR cus_det = c_flag.
* findout all custom developmets
PERFORM sub_cus_dev .
ENDIF.

IF enhan = c_flag.
PERFORM sub_get_enhancements.
ENDIF.

IF workflow = c_flag.
PERFORM sub_get_workflow.
ENDIF.


IF cus_det = c_flag .
* get all details of view/tables/structures
PERFORM sub_field_details .
ENDIF.



IF cus_ind = c_flag .
* get all details for custom indexes
PERFORM sub_get_index .
ENDIF.


IF cus_que = c_flag .
* get all the custom query created
PERFORM sub_get_query .
ENDIF.

IF cus_var = c_flag .
* get variant for all custom programs
PERFORM sub_get_variants .
ENDIF.


IF cus_area = c_flag .
* get  all custom area menu
PERFORM sub_get_area_menu .
ENDIF.

IF cus_mes = c_flag .
* get  all custom messages
PERFORM sub_get_mssg .

ENDIF.

****Begin of change by Rudra R
*    IF dev_appl = c_flag .
** get all the progs according to their description
*      PERFORM sub_get_all_progs .
*    ENDIF.
****End of change by Rudra R

IF p_ale = 'X'.
PERFORM sub_get_ale_info.
ENDIF.
IF p_lsmw = 'X'.
PERFORM sub_get_lsmw_info.
ENDIF.
IF p_comp = 'X'.
PERFORM sub_get_basis_info.
ENDIF.

IF p_lang = 'X'.
PERFORM sub_get_lang_info.
ENDIF.

IF p_land = 'X'.
PERFORM sub_get_tms_info.
ENDIF.
IF p_hrdw = 'X'.
PERFORM sub_get_hwd_info.
ENDIF.

* Start of change by TDEY ----
IF p_user = 'X'.
PERFORM sub_get_client_user_info.
ENDIF.

IF p_server = 'X'.
PERFORM sub_get_server_info.
ENDIF.
* End of change by TDEY ----

** Begin of change ** RKUMAR7 **
IF p_rfc = c_flag.
PERFORM sub_get_rfc_connections.
ENDIF.

IF p_bkgrnd = c_flag.
PERFORM sub_get_backgrnd_jobs.
ENDIF.

IF p_gtway = c_flag.
PERFORM sub_get_gateway_connections.
ENDIF.

** End of change ** RKUMAR7 **


IF p_pghis = 'X' OR p_dbhis = 'X'.
PERFORM sub_get_prog_stat.
ENDIF.
ENDIF.
*******************************************************
*  END OF SELECTION
*******************************************************

END-OF-SELECTION.

** Begin of change ** RKUMAR7 ** 07.08.2009 12:53:54
*  IF p_estm = 'X'.
** End of change ** RKUMAR7 ** 07.08.2009 12:54:29

**  Sudipta Mod Esti report starts ------------------------

CALL FUNCTION 'RS_REFRESH_FROM_SELECTOPTIONS'
EXPORTING
curr_report     = sy-cprog
TABLES
selection_table = i_params.

CALL FUNCTION 'RS_LIST_SELECTION_TABLE'
EXPORTING
report        = sy-cprog
seltext       = 'X'
TABLES
sel_tab       = i_params
EXCEPTIONS
sel_tab_empty = 01.


IF std_modf = c_flag .

* display any standard code is modifed or not
PERFORM sub_disp_std_code .
ENDIF.

IF cus_dev = c_flag .
* list all custom developmets
PERFORM sub_list_cus_dev .
ENDIF.


****Begin of change by Rudra R
*  IF dev_appl = c_flag .
** display all the progs according to their description
*    PERFORM sub_disp_all_progs .
*  ENDIF.
****End of change by Rudra R


* Perform to populate the layout structure.
PERFORM sub_populate_layout.

REFRESH: i_fieldcat.
CLEAR wa_fieldlayout.

* Macro definition for Field Catalog
DEFINE m_fieldcat.
wa_fieldcat-tabname       = &1.  " table name
wa_fieldcat-fieldname     = &2.  " field name
wa_fieldcat-reptext_ddic  = &3.  " Field description
** Begin of change ** RKUMAR7 ** 07.08.2009 13:01:34
if not p_estm = 'X'.
wa_fieldcat-hotspot       = &4.  " Hyperlink
endif.
** End of change ** RKUMAR7 ** 07.08.2009 13:01:39
wa_fieldcat-outputlen     = &6 . " Output length
append wa_fieldcat to &5 .
clear wa_fieldcat.
END-OF-DEFINITION.

** Begin of change ** RKUMAR7 ** 07.08.2009 12:56:41
IF p_estm = c_flag.
** End of change ** RKUMAR7 ** 07.08.2009 12:56:45
PERFORM sub_estimate_report .

*  Sudipa Mod Esti report ends-----------------------------


** Begin of comment ** RKUMAR7 ** 07.08.2009 12:54:20
*  ELSE.
*    IF p_summ = 'X'.


***  SET PF-STATUS 'ZSUET'.
**
**      CALL FUNCTION 'RS_REFRESH_FROM_SELECTOPTIONS'
**        EXPORTING
**          curr_report     = sy-cprog
**        TABLES
**          selection_table = i_params.
**
**      CALL FUNCTION 'RS_LIST_SELECTION_TABLE'
**        EXPORTING
**          report        = sy-cprog
**          seltext       = 'X'
**        TABLES
**          sel_tab       = i_params
**        EXCEPTIONS
**          sel_tab_empty = 01.
**    ENDIF.
**    IF std_modf = c_flag .
**
*** display any standard code is modifed or not
**      PERFORM sub_disp_std_code .
**    ENDIF.
**
**    IF cus_dev = c_flag .
*** list all custom developmets
**      PERFORM sub_list_cus_dev .
**    ENDIF.
**
**    IF dev_appl = c_flag .
*** display all the progs according to their description
**      PERFORM sub_disp_all_progs .
**    ENDIF.
**
**
*** Perform to populate the layout structure.
**    PERFORM sub_populate_layout.
**
**    REFRESH: i_fieldcat.
**    CLEAR wa_fieldlayout.
**
*** Macro definition for Field Catalog
**    DEFINE m_fieldcat.
**      wa_fieldcat-tabname       = &1.  " table name
**      wa_fieldcat-fieldname     = &2.  " field name
**      wa_fieldcat-reptext_ddic  = &3.  " Field description
**      wa_fieldcat-hotspot       = &4.  " Hyperlink
**      wa_fieldcat-outputlen     = &6 . " Output length
**      append wa_fieldcat to &5 .
**      clear wa_fieldcat.
**    END-OF-DEFINITION.
** End of comment ** RKUMAR7 ** 07.08.2009 12:54:24

ELSEIF p_det = c_flag .
* Display report
PERFORM sub_display_report.
ELSEIF p_summ = c_flag.
* summary report
PERFORM sub_summ_report .
ENDIF.
** Begin of comment ** RKUMAR7 ** 07.08.2009 12:59:12
*  ENDIF.
** End of comment ** RKUMAR7 ** 07.08.2009 12:59:21
TOP-OF-PAGE.

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

*******************************************************
*  AT USER-COMMAND
*******************************************************
*AT USER-COMMAND.
*
*  CHECK sy-ucomm EQ 'EXCEL'.
*
** Download report to Excel Spreadsheet
*  PERFORM download_to_excel.

*----------------------------------------------------------------------
*                         At line selection
*----------------------------------------------------------------------

AT LINE-SELECTION.


IF p_summ = c_flag .
* display line details for the line clicked
PERFORM sub_display_line_det .


ENDIF.


*&---------------------------------------------------------------------*
*&      Form  sub_chk_chkbox
*&---------------------------------------------------------------------*
*        check atleast one checkbox is checked
*----------------------------------------------------------------------*
FORM sub_chk_chkbox .

IF     cus_dev = space
*  AND    dev_appl = space "Rudra R
AND    cus_det = space
AND    cus_mes = space
AND    cus_ind = space
AND    cus_area = space
AND    std_modf =  space
AND    cus_var = space
AND    cus_que = space
AND    p_comp = space
AND    p_hrdw = space
AND    p_land = space
* Start of change by TDEY ----
AND    p_user = space
AND    p_server = space
* End of change by TDEY ----
AND    p_lang = space
AND    p_pghis = space
AND    p_dbhis = space
AND    p_ale   = space
AND    p_lsmw  = space
AND    enhan   = space
** Begin of change ** RKUMAR7 **
AND    p_rfc  = space
AND    p_gtway = space
AND    p_bkgrnd = space
** End of change ** RKUMAR7 **
AND    workflow   = space.

MESSAGE e398 WITH'Select atleast one checkbox'(008)
.

ENDIF.
ENDFORM.                    " sub_chk_chkbox


*&---------------------------------------------------------------------*
*&      Form  sub_chk_est
*&---------------------------------------------------------------------*
*        check atleast one checkbox is checked
*----------------------------------------------------------------------*
FORM sub_chk_est .

IF  p_estm = 'X'  AND    cus_dev = space
*  OR  p_estm = 'X'  AND    dev_appl = space "Rudra R
OR  p_estm = 'X'  AND    cus_det = space
OR  p_estm = 'X'  AND    cus_mes = space
OR  p_estm = 'X'  AND    cus_ind = space
OR  p_estm = 'X'  AND    cus_area = space
OR  p_estm = 'X'  AND    std_modf =  space
OR  p_estm = 'X'  AND    cus_var = space
OR  p_estm = 'X'  AND    cus_que = space
OR  p_estm = 'X'  AND    p_comp = space
OR  p_estm = 'X'  AND    p_hrdw = space
OR  p_estm = 'X'  AND    p_land = space
* Start of change by TDEY ----
OR  p_estm = 'X'  AND    p_user = space
OR  p_estm = 'X'  AND    p_server = space
* End of change by TDEY ----
OR  p_estm = 'X'  AND    p_lang = space
OR  p_estm = 'X'  AND    p_pghis = space
OR  p_estm = 'X'  AND    p_dbhis = space
OR  p_estm = 'X'  AND    p_ale   = space
OR  p_estm = 'X'  AND    p_lsmw  = space
OR  p_estm = 'X'  AND    enhan   = space
OR  p_estm = 'X'  AND    workflow   = space
** Begin of change ** RKUMAR7 **
OR p_estm = 'X'   AND   p_bkgrnd = space
OR p_estm = 'X'   AND   p_rfc    = space
OR p_estm = 'X'   AND   p_gtway   = space.
** End of change ** RKUMAR7 **


MESSAGE e398 WITH
'All checkboxes must be enabled for Estimation Report'(132).
.

ENDIF.
ENDFORM.                    " sub_chk_est

*&---------------------------------------------------------------------*
*&      Form  sub_check_std_code
*&---------------------------------------------------------------------*
*       check any standard code is modifed or not
*----------------------------------------------------------------------*
FORM sub_check_std_code .

DATA: lv_nameclass(1) TYPE c.

SELECT    *
FROM smodilog
INTO TABLE i_adir
WHERE (   operation <> 'TRSL'
OR prot_only = space )
AND inactive <> 'R'
AND inactive <> 'D'
AND inactive <> '1'.

LOOP AT i_adir INTO wa_adir.

CALL FUNCTION 'TRINT_OBJECT_NAMESPACE_INFO'
EXPORTING
iv_pgmid               = 'R3TR'
iv_object              = wa_adir-obj_type
iv_objname             = wa_adir-obj_name
IMPORTING
ev_nameclass           = lv_nameclass
EXCEPTIONS
namespace_not_existing = 1
namespace_use_rejected = 2
invalid_object         = 3
OTHERS                 = 4.

IF sy-subrc <> 0 OR lv_nameclass NE 'S'.

DELETE i_adir.

ENDIF.

ENDLOOP.

SORT i_adir BY obj_type obj_name sub_type sub_name.
DELETE ADJACENT DUPLICATES FROM i_adir COMPARING obj_type obj_name
sub_type sub_name.

DELETE i_adir WHERE ( obj_type EQ 'LODE' OR obj_type EQ 'IATU' OR
obj_type EQ 'LODC' OR obj_type EQ 'LOIE' OR obj_type EQ 'IARP'
OR obj_type EQ 'PFCS' ).

ENDFORM.                    " sub_check_std_code
*&---------------------------------------------------------------------*
*&      Form  sub_disp_std_code
*&---------------------------------------------------------------------*
*       display any standard code is modifed or not
*----------------------------------------------------------------------*
FORM sub_disp_std_code .

LOOP AT i_adir INTO wa_adir .
wa_adir_final-object = wa_adir-obj_type .
wa_adir_final-obj_name = wa_adir-obj_name .

* get the object desc
READ TABLE i_ko100 INTO wa_ko100
WITH KEY object = wa_adir-obj_type BINARY SEARCH .

IF sy-subrc EQ 0.
CONCATENATE
'SAP'
wa_ko100-text
INTO wa_adir_final-text
SEPARATED BY space.
ENDIF.

wa_adir_final-sub_type = wa_adir-sub_type .
wa_adir_final-sub_name = wa_adir-sub_name .

* get the sub_type desc
READ TABLE i_ko100 INTO wa_ko100
WITH KEY object = wa_adir-sub_type BINARY SEARCH .

IF sy-subrc EQ 0.
CONCATENATE
'SAP'
wa_ko100-text
INTO wa_adir_final-sub_text
SEPARATED BY space.
ENDIF.


APPEND wa_adir_final TO i_adir_final .
CLEAR wa_adir_final .

ENDLOOP.
ENDFORM.                    " sub_disp_std_code
*&---------------------------------------------------------------------*
*&      Form  sub_display_report
*&---------------------------------------------------------------------*
*       display report
*----------------------------------------------------------------------*
FORM sub_display_report .


* Perform building of events table
*  PERFORM sub_populate_events   .

DATA : l_count TYPE i .

IF std_modf = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Standard Objects Modified :'(015).
DESCRIBE TABLE i_adir_final LINES wa_summ-number .
wa_summ-form = 'SUB_REP_STD_MODF' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .
ENDIF.

IF cus_dev = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =    'All Custom Developments :'(025) .
DESCRIBE TABLE i_cust_final LINES wa_summ-number .

wa_summ-form = 'SUB_REP_CUS_DEV' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF cus_det = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Custom Table Field Details :'(036).
DESCRIBE TABLE i_tabl_details LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_DET_TAB' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Custom View Field Details :'(040).
DESCRIBE TABLE i_view_details LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_DET_VIEW' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Custom Structure Field Details :'(039).
DESCRIBE TABLE i_stru_details LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_DET_STRU' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF enhan = c_flag.
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-107.
DESCRIBE TABLE i_exit LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_FEXIT' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-114.
DESCRIBE TABLE i_vofm LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_VOFM' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-122.
DESCRIBE TABLE i_bte LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_BTE' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-127.
DESCRIBE TABLE i_uexit_sd LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_UEXIT_SD' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-133.
DESCRIBE TABLE i_badi LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_BADI' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF workflow = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-145.
DESCRIBE TABLE i_std_wflow LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_STD_WFLOW' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .


l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-141.
DESCRIBE TABLE i_wflow LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_WFLOW' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .
ENDIF.

IF cus_ind = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Index on Custom Tables:'(013).
DESCRIBE TABLE i_index LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_IND' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Index on Standard Tables:'(084).
DESCRIBE TABLE i_std_index LINES wa_summ-number .

wa_summ-form = 'SUB_REP_STD_IND' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .
ENDIF.


IF cus_que = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = 'Custom Query Details :'(010).
DESCRIBE TABLE i_query LINES wa_summ-number .

wa_summ-form = 'SUB_REP_CUS_QUE'.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.
IF cus_var = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Variant of Custom Programs:'(021).
DESCRIBE TABLE i_varid LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_VAR' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Variant of Standard Programs:'(085).
DESCRIBE TABLE i_std_varid LINES wa_summ-number .
wa_summ-form = 'SUB_REP_STD_VAR' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF cus_area = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .

wa_summ-category =  'Custom Area Menu Details :'(024).
DESCRIBE TABLE i_area LINES wa_summ-number .

wa_summ-form = 'SUB_REP_CUS_AREA' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF cus_mes = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .

wa_summ-category =  'Custom Message Details :'(055).
DESCRIBE TABLE i_t100 LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_MES' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.
****Begin of change by Rudra R
*  IF dev_appl = c_flag .
*    l_count = l_count + 1 .
*    wa_summ-line = l_count .
*
*    wa_summ-category =  'Programs in Different Applications :'(050) .
*    DESCRIBE TABLE i_prog LINES wa_summ-number .
*    wa_summ-form = 'SUB_REP_DEV_APPL' .
*    APPEND wa_summ TO i_summ .
*    CLEAR wa_summ .
*
*  ENDIF.
****End of change by Rudra R


PERFORM download_to_excel.

WRITE:/20
'Please refer to the spreadsheet for the detail report'(239).

WRITE:/20 'Please save the report for further analysis'(240).


*  CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_INIT'
*    EXPORTING
*      i_callback_program = sy-cprog.
*
*  IF std_modf = c_flag .
*
*    PERFORM sub_rep_std_modf .
*
*  ENDIF.
*
*
*  IF cus_dev = c_flag .
*
*    PERFORM sub_rep_cus_dev .
*  ENDIF.
*
*
*  IF cus_det = c_flag .
*
*    PERFORM sub_rep_cus_det_tab .
*
*    PERFORM sub_rep_cus_det_view .
*
*    PERFORM sub_rep_cus_det_stru .
*
*  ENDIF.
*
*  IF enhan = c_flag.
*    PERFORM sub_display_fexit.
*    PERFORM sub_display_vofm.
*    PERFORM sub_display_bte.
*    PERFORM sub_display_uexit_sd.
*    PERFORM sub_display_badi.
*  ENDIF.
*
*  IF workflow = c_flag.
*    PERFORM sub_display_wflow.
*  ENDIF.
*
*  IF cus_ind = c_flag.
*
*    PERFORM sub_rep_cus_ind .
*
*    PERFORM sub_rep_std_ind .
*
*  ENDIF.
*
*  IF cus_que = c_flag .
*
*    PERFORM sub_rep_cus_que .
*
*  ENDIF.
*
*
*  IF cus_var = c_flag .
*
*    PERFORM sub_rep_cus_var .
*
*    PERFORM sub_rep_std_var .
*
*  ENDIF .
*
*  IF cus_area = c_flag .
*
*    PERFORM sub_rep_cus_area .
*
*  ENDIF .
*
*
*  IF cus_mes = c_flag .
*
*    PERFORM sub_rep_cus_mes .
*  ENDIF .
*
*  IF dev_appl = c_flag .
*
*    PERFORM sub_rep_dev_appl .
*
*  ENDIF.
*
*
*  IF p_ale = c_flag.
*    PERFORM sub_display_info TABLES
*                                i_ale_inbound
*                                i_events14
*                              USING
*                                i_fieldcat14
*                                'I_ALE_INBOUND'
*                                c_formname14.
*    PERFORM sub_display_info TABLES
*                                i_ale_std_inbound
*                                i_events14
*                              USING
*                                i_fieldcat14
*                                'I_ALE_STD_INBOUND'
*                                c_formname20.
*    PERFORM sub_display_info TABLES
*                                i_ale_outbound
*                                i_events14
*                              USING
*                                i_fieldcat14
*                                'I_ALE_OUTBOUND'
*                                c_formname21.
*    PERFORM sub_display_info TABLES
*                                i_ale_std_outbound
*                                i_events14
*                              USING
*                                i_fieldcat14
*                                'I_ALE_STD_OUTBOUND'
*                                c_formname22.
*  ENDIF.
*
*  IF p_lsmw = c_flag.
*    PERFORM sub_display_info TABLES
*                               i_lsmw_objects
*                                i_events14
*                             USING
*                               i_fieldcat14
*                               'I_LSMW_OBJECTS'
*                                c_formname23.
*  ENDIF.
*
*  IF p_comp = c_flag.
*    PERFORM sub_display_info TABLES
*                                i_component
*                                i_events14
*                              USING
*                                i_fieldcat14
*                                'I_COMPONENT'
*                                c_formname24.
*  ENDIF.
*
*  IF p_lang = c_flag.
*    PERFORM sub_display_info TABLES
*                                 i_lang_final
*                                 i_events14
*                               USING
*                                 i_fieldcat14
*                                 'I_LANG_FINAL'
*                                c_formname25.
*  ENDIF.
*
*  IF p_land = c_flag.
*    PERFORM sub_display_info TABLES
*                                 i_landscape
*                                 i_events14
*                               USING
*                                 i_fieldcat14
*                                 'I_LANDSCAPE'
*                                 c_formname26.
*  ENDIF.
*  IF p_hrdw = c_flag.
*    PERFORM sub_display_info TABLES
*                               i_hw_info
*                               i_events14
*                             USING
*                               i_fieldcat14
*                               'I_HW_INFO'
*                                c_formname27.
*  ENDIF.
**  IF cus_dev = 'X'.
**    PERFORM sub_rep_no_of_lines.
**  ENDIF.
*  IF p_pghis = 'X' OR p_dbhis = 'X'.
*    sy-lisel+9(11) = 'Program Usa'.
*    PERFORM sub_display_info TABLES
*                                 i_prog_stat1
*                                 i_events14
*                               USING
*                                 i_fieldcat16
*                                 'I_PROG_STAT'
*                                c_formname28.
*  ENDIF.
*
*  wa_print-reserve_lines = 2.
*
*  CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_DISPLAY'
*    EXPORTING
*      is_print = wa_print.

ENDFORM.                    " sub_display_report

*&---------------------------------------------------------------------*
*&      Form  sub_populate_layout
*&---------------------------------------------------------------------*
*        Perform to populate the layout structure
*----------------------------------------------------------------------*
FORM sub_populate_layout .
wa_fieldlayout-zebra = c_flag.             " Striped pattern
wa_fieldlayout-max_linesize = '5000'.

ENDFORM.                    " sub_populate_layout

*&---------------------------------------------------------------------*
*&      Form  sub_populate_events
*&---------------------------------------------------------------------*
*        Populate the events table
*----------------------------------------------------------------------*

FORM sub_populate_events .

IF std_modf = c_flag .

* populate TOP OF PAGE event for 1st block
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname .
APPEND wa_events TO i_events .
CLEAR wa_events .

ENDIF.

***** for 2nd block
IF cus_dev = c_flag .

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname2 .
APPEND wa_events TO i_events2 .
CLEAR wa_events .
ENDIF.


***** for 3rd /4th /5th block
IF cus_det = c_flag .

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname3 .
APPEND wa_events TO i_events3 .
CLEAR wa_events .

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname4 .
APPEND wa_events TO i_events4 .
CLEAR wa_events .


wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname5 .
APPEND wa_events TO i_events5 .
CLEAR wa_events .


ENDIF.

IF enhan = c_flag.
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname19 .
APPEND wa_events TO i_events19.
CLEAR wa_events.

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname30 .
APPEND wa_events TO i_events20.
CLEAR wa_events.

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname31 .
APPEND wa_events TO i_events21.
CLEAR wa_events.

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname32 .
APPEND wa_events TO i_events22.
CLEAR wa_events.

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname33 .
APPEND wa_events TO i_events23.
CLEAR wa_events.
ENDIF.

IF workflow = c_flag.
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname34 .
APPEND wa_events TO i_events24.
CLEAR wa_events.
ENDIF.

IF cus_ind = c_flag .
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname6 .
APPEND wa_events TO i_events6 .
CLEAR wa_events .


ENDIF.

IF cus_que = c_flag .
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname7 .
APPEND wa_events TO i_events7 .
CLEAR wa_events .

ENDIF.

IF cus_var = c_flag .
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname8 .
APPEND wa_events TO i_events8 .
CLEAR wa_events .

ENDIF.

IF cus_area = c_flag .
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname9 .
APPEND wa_events TO i_events9 .
CLEAR wa_events .

ENDIF.

IF cus_mes = c_flag .
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname10 .
APPEND wa_events TO i_events10 .
CLEAR wa_events .

ENDIF.


****Begin of change by Rudra R
*  IF dev_appl = c_flag .
*    wa_events-name = slis_ev_top_of_page .
*    wa_events-form = c_formname13 .
*    APPEND wa_events TO i_events13 .
*    CLEAR wa_events .
*
*
*  ENDIF.
****End of change by Rudra R

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname14 .
APPEND wa_events TO i_events14 .
CLEAR wa_events .

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname15 .
APPEND wa_events TO i_events15 .
CLEAR wa_events .


IF cus_mes = c_flag .
wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname10 .
APPEND wa_events TO i_events10 .
CLEAR wa_events .

ENDIF.

IF p_pghis = c_flag OR p_dbhis = c_flag .

wa_events-name = slis_ev_top_of_page .
wa_events-form = c_formname16 .
APPEND wa_events TO i_events16 .
CLEAR wa_events .

ENDIF.


ENDFORM.                    " sub_populate_events
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .
SKIP 2 .
WRITE :/  'Standard Objects Modified :'(015).


ENDFORM.                    " sub_report_heading

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading2
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading2 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'All Custom Developments :'(025).


ENDFORM.                    " sub_report_heading2
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading3
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading3 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .
SKIP 2 .
WRITE :/  'Custom Table Field Details :'(036).


ENDFORM.                    " sub_report_heading3

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading3
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading4 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Custom View Field Details :'(040).


ENDFORM.                    " sub_report_heading3

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading3
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading5 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Custom Structure Field Details :'(039).


ENDFORM.                    " sub_report_heading3

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading3
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading6 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Index on Custom/Standard Tables:'(102).


ENDFORM.                    " sub_report_heading3

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading3
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading7 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Custom Query Details :'(010).


ENDFORM.                    " sub_report_heading3

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading8 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Variant of Custom/Standard Programs:'(103).


ENDFORM.                    " sub_report_heading8

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading9 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Custom Area Menu Details :'(024).


ENDFORM.                    " sub_report_heading9
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading13 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Programs in Different Applications :'(050) .


ENDFORM.                    " sub_report_heading9



*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading10 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Custom Message Details :'(055).


ENDFORM.                    " sub_report_heading9

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading11 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/ 'Custom Sapscripts Maintained in Different Languages :'(048).


ENDFORM.                    " sub_report_heading9

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading12 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/ 'Custom Samrtforms Maintained in Different Languages :'(049).


ENDFORM.                    " sub_report_heading9

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading19
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading19 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Function Exits :'(106).

ENDFORM.                    " sub_report_heading19


*&---------------------------------------------------------------------*
*&      Form  sub_report_heading30
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading30 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'VOFM Routine:'(115).

ENDFORM.                    " sub_report_heading30


*&---------------------------------------------------------------------*
*&      Form  sub_report_heading31
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading31 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Business Transaction Events:'(126).

ENDFORM.                    " sub_report_heading31


*&---------------------------------------------------------------------*
*&      Form  sub_report_heading32
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading32 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Sales User Exit:'(128).

ENDFORM.                    " sub_report_heading32

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading33
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading33 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Business Add-Ins - implementations:'(134).

ENDFORM.                    " sub_report_heading33

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading34
*&---------------------------------------------------------------------*
*      for writing Report header

*----------------------------------------------------------------------*
FORM sub_report_heading34 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Work Flow :'(140).
WRITE :/  'TS = Single Step Workflow.'(146).
WRITE :/  'WS = Multi Step WorkFlow'(147).
SKIP 1 .

ENDFORM.                    " sub_report_heading34
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading35
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading35 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .
SKIP 2 .
WRITE :/  'RFC Connections'(201).

ENDFORM.                    " sub_report_heading35

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading36
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading36 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .
SKIP 2 .
WRITE :/  'Gateway Connections'(203).

ENDFORM.                    " sub_report_heading36

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading37
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading37 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .
SKIP 2 .
WRITE :/  'Scheduled Jobs'(204).

ENDFORM.                    " sub_report_heading37

*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcalaog_std
*&---------------------------------------------------------------------*
*        prepare field catalog
*----------------------------------------------------------------------*
FORM sub_prep_fcalaog_std .

m_fieldcat 'I_ADIR_FINAL_TMP2' 'OBJECT'
'Object'(016)  ' '  i_fieldcat '10' .

m_fieldcat 'I_ADIR_FINAL_TMP2' 'TEXT'
'Object Description'(017)  ' '  i_fieldcat  '40'.

m_fieldcat 'I_ADIR_FINAL_TMP2' 'OBJ_NAME'
'Object Name'(018)  ' '  i_fieldcat '30' .

m_fieldcat 'I_ADIR_FINAL_TMP2' 'SUB_TYPE'
'Sub Type'(082)  ' '  i_fieldcat '10' .

m_fieldcat 'I_ADIR_FINAL_TMP2' 'SUB_TEXT'
'Sub Type Description'(083)  ' '  i_fieldcat  '40'.

m_fieldcat 'I_ADIR_FINAL_TMP2' 'SUB_NAME'
'Sub-Object Name'(241)  ' '  i_fieldcat '50' .

ENDFORM.                    " sub_prep_fcalaog_std
*&---------------------------------------------------------------------*
*&      Form  sub_cus_dev
*&---------------------------------------------------------------------*
*       find out all custom d3evelopments
*----------------------------------------------------------------------*
FORM sub_cus_dev .

* internal table for range
*  DATA: r_obj TYPE RANGE OF  char15 INITIAL SIZE 0 .
*
** Work area for range table
*  DATA: wa_obj LIKE LINE OF r_obj .
*
***>>>Begin of change by Rudra R
DATA : li_sprog_objects TYPE STANDARD TABLE OF zibm_cust_object_type
INITIAL SIZE 0.
***>>>End of change by Rudra R



LOOP AT s_name .
* populate initial list
wa_list_init-object_id = s_name-low .

wa_list_init-object_type = 'TABL' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'VIEW' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'TTYP' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'DTEL' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'STRU' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'DOMA' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'SHLP' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'RPROG' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

*    wa_list_init-object_type = 'MPROG' .
*    APPEND  wa_list_init TO i_list_init .
*    CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'SPROG' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'IPROG' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'FUNC' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'FUGR' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'TRAN' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'DEVC' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

*    wa_list_init-object_type = 'CMOD' .
*    APPEND  wa_list_init TO i_list_init .
*    CLEAR wa_list_init-object_type .

wa_list_init-object_type = 'CLAS' .
APPEND  wa_list_init TO i_list_init .
CLEAR wa_list_init-object_type .

*    wa_list_init-object_type = 'SXCI' .
*    APPEND  wa_list_init TO i_list_init .
*    CLEAR wa_list_init-object_type .

ENDLOOP.
LOOP AT s_pack.
MOVE-CORRESPONDING s_pack TO wa_filter.
wa_filter-filter_name = 'DEVC'.
APPEND wa_filter TO i_filter.
ENDLOOP.
CALL FUNCTION 'Z_IBM_GET_CUSTOM_OBJECTS'
TABLES
tb_object_type = i_list_init
tb_filter      = i_filter
tb_objects     = i_list_final
EXCEPTIONS
no_type_found  = 1
OTHERS         = 2.
IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
ENDIF.

***>>>Begin of change by Rudra R
*Get the details of SPROG type object to filter
*Workflow method program and Subroutine pool
li_sprog_objects[] = i_list_final[].
DELETE  li_sprog_objects WHERE object_type NE 'SPROG'.
IF NOT li_sprog_objects[] IS INITIAL.

SELECT name
clas
INTO TABLE i_sprog_obj
FROM trdir
FOR ALL ENTRIES IN li_sprog_objects
WHERE name = li_sprog_objects-object_id.

SORT i_sprog_obj BY name ASCENDING.

ENDIF.

***>>>End of change by Rudra R

* populate range table for forms

*  wa_obj-sign = 'I'.
*  wa_obj-option = 'EQ'.
*  wa_obj-low = 'FORM' .
*  APPEND wa_obj TO r_obj .
*  CLEAR wa_obj .

PERFORM cus_dev_mpool.

SELECT a~obj_name
a~object a~devclass
FROM tadir AS a INNER JOIN stxh AS b
ON a~object = b~tdobject
AND a~obj_name = b~tdname
APPENDING TABLE i_list_final
WHERE a~pgmid EQ 'R3TR'
AND a~object EQ 'FORM'
AND a~devclass IN s_pack
AND a~obj_name IN r_object
AND b~mandt = sy-mandt
AND b~tdid = 'DEF'
AND b~tdspras = sy-langu.


SELECT obj_name
object tadir~devclass
FROM tadir INNER JOIN stxfadm
ON tadir~obj_name = stxfadm~formname
APPENDING table i_list_final
WHERE pgmid EQ 'R3TR'
AND object EQ 'SSFO'
AND tadir~devclass IN s_pack
AND   obj_name IN r_object
AND  formtype EQ space.


* Start of change by TDEY ----
*{   REPLACE        DEVK901208                                        1
*\  IF p_summ IS NOT INITIAL
*\     OR p_det IS NOT INITIAL.
IF NOT p_summ IS INITIAL
OR NOT p_det IS INITIAL.
*}   REPLACE
*   Get the custom object details
CALL FUNCTION 'Z_IBM_SUET_GET_OBJECT_DETAILS'
EXPORTING
p_src_vrn        = p_cver
p_trg_vrn        = p_ver
TABLES
tb_objects       = i_list_final
CHANGING
p_upgrade_impact = p_upgrd
EXCEPTIONS
*        object_not_found = 1 "This exception won't be raised
processing_cancelled = 2
OTHERS           = 3.
IF sy-subrc = 2. "User has cancelled processing
* Give proper message and go back to selection screen
MESSAGE s398(00) WITH 'Processing cancelled by user'(004).
LEAVE LIST-PROCESSING.
ENDIF.

CALL FUNCTION 'SAPGUI_PROGRESS_INDICATOR'
EXPORTING
*        percentage = l_percent
text       = 'Selecting other attributes'(080).
ENDIF.
* End of change by TDEY ----

ENDFORM.                    " sub_cus_dev
*&---------------------------------------------------------------------*
*&      Form  sub_list_cus_dev
*&---------------------------------------------------------------------*
*       list all custom developmets
*----------------------------------------------------------------------*
FORM sub_list_cus_dev .

* SELECT obj_name devclass FROM tadir INTO TABLE i_pkg
*  FOR ALL ENTRIES IN i_list_final
*  WHERE obj_name = i_list_final-object_id.

** Begin of change ** RKUMAR7 **
DATA: l_i_prog_in TYPE STANDARD TABLE OF bal_rfield INITIAL SIZE 0,
l_i_transaction TYPE STANDARD TABLE OF bal_rfield INITIAL SIZE
0,
l_i_prog_used TYPE STANDARD TABLE OF bal_rfield INITIAL SIZE 0,
l_i_trans_used TYPE STANDARD TABLE OF bal_rfield INITIAL SIZE 0,
l_i_fm_used TYPE STANDARD TABLE OF bal_rfield INITIAL SIZE 0,
l_wa_prog TYPE bal_rfield,
l_wa_prog_stat LIKE LINE OF i_prog_stat1,
l_wa_tran_stat  LIKE LINE OF i_tran_stat2,
l_i_include_used TYPE STANDARD TABLE OF bal_rfield INITIAL
SIZE 0,
l_object_id  TYPE sobj_name,
l_i_name  TYPE STANDARD TABLE OF bal_rfield INITIAL SIZE 0.

* Get the programs populated
l_wa_prog-sign = 'I'.
l_wa_prog-option = 'EQ'.
LOOP AT i_prog_stat1 INTO l_wa_prog_stat.
l_wa_prog-low  = l_wa_prog_stat-entry_id.
APPEND l_wa_prog TO l_i_prog_in.
ENDLOOP.

* Get the transactions populated
LOOP AT i_tran_stat2 INTO l_wa_tran_stat.
l_wa_prog-low  = l_wa_tran_stat-entry_id.
APPEND l_wa_prog TO l_i_transaction.
ENDLOOP.
CLEAR: l_wa_prog, l_wa_prog_stat,l_wa_tran_stat.
* Get the name space
l_i_name[] = r_object[].

* Call the FM to get the Program details, This fm finds out all the FM,
*  includes, submit, externe perform in program.
CALL FUNCTION 'Z_IBM_SUET_PROGRAM_DETAILS'
EXPORTING
p_level        = p_count
p_month        = p_month
TABLES
t_name         = l_i_name
t_prog_in      = l_i_prog_in
t_transaction  = l_i_transaction
t_prog_used    = l_i_prog_used
t_trans_used   = l_i_trans_used
t_fm_used      = l_i_fm_used
t_include_used = l_i_include_used.

** End of change ** RKUMAR7 **

LOOP AT i_list_final INTO wa_list_final .

wa_cust_final-obj_name = wa_list_final-object_id .
wa_cust_final-object = wa_list_final-object_type .
wa_cust_final-devclass = wa_list_final-devclass.

* get the object desc
READ TABLE i_ko100 INTO wa_ko100
WITH KEY object = wa_list_final-object_type BINARY SEARCH .

IF sy-subrc EQ 0.
wa_cust_final-text = wa_ko100-text .
ENDIF.

* Begin of change by Rudra R
*** This logic has been incorporated to distinguised between
*** Subroutine pool and Method program for BOR.
IF wa_list_final-object_type = 'SPROG'.
CLEAR i_sprog_obj.
READ TABLE i_sprog_obj WITH KEY name = wa_list_final-object_id
BINARY SEARCH.
IF sy-subrc = 0 AND i_sprog_obj-clas = 'SWOP'.
wa_cust_final-text = 'Method Program for BOR'(237).
ENDIF.
ENDIF.
* End of change by Rudra R
* Start of change by TDEY ----

*    READ TABLE i_pkg INTO wa_pkg
*    WITH KEY objname = wa_list_final-object_id BINARY SEARCH.
*
*    IF sy-subrc EQ 0.
*      wa_cust_final-devclass = wa_pkg-devclass .
*    ENDIF.

wa_cust_final-object_desc      = wa_list_final-object_desc.
wa_cust_final-devclass_desc    = wa_list_final-devclass_desc.
wa_cust_final-appl             = wa_list_final-appl.
wa_cust_final-appl_desc        = wa_list_final-appl_desc.
wa_cust_final-source_system    = wa_list_final-source_system.
wa_cust_final-cretd_on         = wa_list_final-cretd_on.
wa_cust_final-obj_vern         = wa_list_final-obj_vern.
wa_cust_final-lines_of_code    = wa_list_final-lines_of_code.
*{   REPLACE        DEVK901208                                        1
*\    IF p_upgrd IS NOT INITIAL.
IF NOT p_upgrd IS INITIAL.
*}   REPLACE
wa_cust_final-release_impact   = wa_list_final-release_impact.
wa_cust_final-unicode_impact   = wa_list_final-unicode_impact.
wa_cust_final-obsolete_count   = wa_list_final-obsolete_count.
wa_cust_final-obsolete_count_fm = wa_list_final-obsolet_count_fm.
ELSE.
wa_cust_final-release_impact   = 'NC'. "Not calculated
wa_cust_final-unicode_impact   = 'NC'.
wa_cust_final-obsolete_count   = 'NC'.
wa_cust_final-obsolete_count_fm   = 'NC'.
ENDIF.
wa_cust_final-last_chngd_by    = wa_list_final-last_chngd_by.
wa_cust_final-last_chngd_on    = wa_list_final-last_chngd_on.
wa_cust_final-last_transp      = wa_list_final-last_transp.
wa_cust_final-last_transp_date = wa_list_final-last_transp_date.
* End of change by TDEY ----

** Begin of change ** RKUMAR7 **
IF wa_list_final-object_type EQ 'CLAS'
OR wa_list_final-object_type EQ 'TTYP'
OR wa_list_final-object_type EQ 'IPROG'.

READ TABLE l_i_include_used WITH KEY low =
wa_list_final-object_id+0(30)
BINARY SEARCH TRANSPORTING NO FIELDS .
IF sy-subrc = 0.
wa_cust_final-used = 'X'.
ENDIF.
ELSEIF wa_list_final-object_type EQ 'RPROG'
OR wa_list_final-object_type EQ 'MPROG'
OR wa_list_final-object_type EQ 'FUGR'.

*     Taking the program name in a variable
l_object_id = wa_list_final-object_id+0(30).

*     Add SAPL as prefix for the Funtion groups
IF wa_list_final-object_type EQ 'FUGR'.
CONCATENATE 'SAPL' l_object_id INTO l_object_id.
ENDIF.

READ TABLE l_i_prog_used WITH KEY low = l_object_id
BINARY SEARCH TRANSPORTING NO FIELDS .
IF sy-subrc = 0.
wa_cust_final-used = 'X'.
ENDIF.

ELSEIF wa_list_final-object_type EQ 'FUNC'.
READ TABLE l_i_fm_used WITH KEY low =
wa_list_final-object_id+0(30)
BINARY SEARCH TRANSPORTING NO FIELDS .
IF sy-subrc = 0.
wa_cust_final-used = 'X'.
ENDIF.
ELSEIF wa_list_final-object_type EQ 'TRAN'.
READ TABLE l_i_trans_used WITH KEY low =
wa_list_final-object_id+0(30)
BINARY SEARCH TRANSPORTING NO FIELDS .
IF sy-subrc = 0.
wa_cust_final-used = 'X'.
ENDIF.

ENDIF.
** End of change ** RKUMAR7 **
APPEND wa_cust_final TO i_cust_final .
CLEAR wa_cust_final .


ENDLOOP.

ENDFORM.                    " sub_list_cus_dev
*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcalaog_cus
*&---------------------------------------------------------------------*
*       for custom developmenmts block
*----------------------------------------------------------------------*
FORM sub_prep_fcalaog_cus .

* Start of change by TDEY ----

*  m_fieldcat 'I_CUST_FINAL_TMP2' 'OBJECT'
*         'Object'(016)  ' '  i_fieldcat2  '10'.
*
*  m_fieldcat 'I_CUST_FINAL_TMP2' 'TEXT'
*         'Object Description'(017)  ' '  i_fieldcat2  '60' .
*
*  m_fieldcat 'I_CUST_FINAL_TMP2' 'OBJ_NAME'
*         'Object Name'(018)  ' '  i_fieldcat2  '40' .
*
*  m_fieldcat 'I_CUST_FINAL_TMP2' 'DEVCLASS'
*         'Package'(098)  ' '  i_fieldcat2  '40' .

m_fieldcat 'I_CUST_FINAL_TMP2' 'OBJECT'
'ObjTy'(242)  ' '  i_fieldcat2  '15'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'TEXT'
'Object Type Desc'(243)  ' '  i_fieldcat2  '60'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'OBJ_NAME'
'Object Name'(244)  ' '  i_fieldcat2  '40'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'OBJECT_DESC'
'Object Description'(245)  ' '  i_fieldcat2  '120'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'DEVCLASS'
'Package'(246)  ' '  i_fieldcat2  '30'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'DEVCLASS_DESC'
'Package Description'(247)  ' '  i_fieldcat2  '60'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'APPL'
'Application'(248)  ' '  i_fieldcat2  '11'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'APPL_DESC'
'Application Desc'(249)  ' '  i_fieldcat2  '16'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'SOURCE_SYSTEM'
'Source System'(250)  ' '  i_fieldcat2  '13'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'OBJ_VERN'
'Obj Ver'(251)  ' '  i_fieldcat2  '7'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'CRETD_ON'
'Created on'(252)  ' '  i_fieldcat2  '10'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'LAST_CHNGD_BY'
'Last Changed by'(253)  ' '  i_fieldcat2  '15'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'LAST_CHNGD_ON'
'Last Changed on'(254)  ' '  i_fieldcat2  '15'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'LAST_TRANSP'
'Last Transport'(255)  ' '  i_fieldcat2  '20'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'LAST_TRANSP_DATE'
'Last Transport Date'(256)  ' '  i_fieldcat2  '19'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'LINES_OF_CODE'
'Lines of Code'(257)  ' '  i_fieldcat2  '13'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'RELEASE_IMPACT'
'Release Impact(Warning)'(258)  ' '  i_fieldcat2  '24'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'UNICODE_IMPACT'
'Unicode Impact(Error)'(259)  ' '  i_fieldcat2  '24'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'OBSOLETE_COUNT'
'Obsolete Count(Warning)'(238)  ' '  i_fieldcat2  '24'.
m_fieldcat 'I_CUST_FINAL_TMP2' 'OBSOLETE_COUNT_FM'
'Obsolete FM Count(Warning)'(081)  ' '  i_fieldcat2  '24'.

* End of change by TDEY ----

** Begin of change ** RKUMAR7 **
m_fieldcat 'I_CUST_FINAL_TMP2' 'USED'
'Used'(261) ' ' i_fieldcat2 '10'.
** End of change ** RKUMAR7 **

ENDFORM.                    " sub_prep_fcalaog_cus
*&---------------------------------------------------------------------*
*&      Form  sub_get_obj_desc
*&---------------------------------------------------------------------*
*      get all the objects and their corrsponding desc
*----------------------------------------------------------------------*
FORM sub_get_obj_desc .

CALL FUNCTION 'TR_OBJECT_TABLE'
TABLES
wt_object_text = i_ko100.


wa_ko100-pgmid ='R3TR'   .
wa_ko100-object = 'STRU' .
wa_ko100-text = 'Structure'(262) .

APPEND wa_ko100 TO i_ko100 .
CLEAR wa_ko100 .

wa_ko100-pgmid ='R3TR'   .
wa_ko100-object = 'IPROG' .
wa_ko100-text = 'Include Program'(263) .

APPEND wa_ko100 TO i_ko100 .
CLEAR wa_ko100 .

wa_ko100-pgmid ='R3TR'   .
wa_ko100-object = 'RPROG' .
wa_ko100-text = 'Report Program'(264) .

APPEND wa_ko100 TO i_ko100 .
CLEAR wa_ko100 .

wa_ko100-pgmid ='R3TR'   .
wa_ko100-object = 'MPROG' .
wa_ko100-text = 'Module Pool Program'(265) .

APPEND wa_ko100 TO i_ko100 .
CLEAR wa_ko100 .

SORT i_ko100 BY object .


ENDFORM.                    " sub_get_obj_desc
*&---------------------------------------------------------------------*
*&      Form  sub_field_details
*&---------------------------------------------------------------------*
*       get all details of view/tables/structures
*----------------------------------------------------------------------*
FORM sub_field_details .

DATA : i_list_final_tmp TYPE STANDARD TABLE OF
zibm_cust_object_type  INITIAL SIZE 0.

DATA : i_tabl_details_tmp TYPE STANDARD TABLE OF
zibm_table_structure  INITIAL SIZE 0.

DATA : i_view_details_tmp TYPE STANDARD TABLE OF
zibm_table_structure  INITIAL SIZE 0.

DATA : i_stru_details_tmp TYPE STANDARD TABLE OF
zibm_table_structure  INITIAL SIZE 0.


***************** popuyalte all table fields
i_list_final_tmp[] = i_list_final[] .

DELETE i_list_final_tmp WHERE object_type NE 'TABL' .

IF NOT i_list_final_tmp[] IS INITIAL .
LOOP AT i_list_final_tmp INTO wa_list_final .
CALL FUNCTION 'Z_IBM_GET_TABLE_DETAILS'
EXPORTING
im_object_id  = wa_list_final-object_id+0(30)
TABLES
tb_tab_struc  = i_tabl_details_tmp
EXCEPTIONS
no_data_found = 1
OTHERS        = 2.
IF sy-subrc = 0.

APPEND LINES OF i_tabl_details_tmp TO i_tabl_details .
REFRESH i_tabl_details_tmp[] .

ENDIF.


ENDLOOP.

ENDIF.

***************** popuyalte all view fields

REFRESH : i_list_final_tmp[] .
i_list_final_tmp[] = i_list_final[] .

DELETE i_list_final_tmp WHERE object_type NE 'VIEW' .

IF NOT i_list_final_tmp[] IS INITIAL .
LOOP AT i_list_final_tmp INTO wa_list_final .
CALL FUNCTION 'Z_IBM_GET_VIEW_DETAILS'
EXPORTING
im_object_id  = wa_list_final-object_id+0(30)
TABLES
tb_tab_struc  = i_view_details_tmp
EXCEPTIONS
no_data_found = 1
OTHERS        = 2.
IF sy-subrc = 0.

APPEND LINES OF i_view_details_tmp TO i_view_details .
REFRESH i_view_details_tmp[] .

ENDIF.

ENDLOOP.

ENDIF.

***************** popuyalte all structure fields

REFRESH : i_list_final_tmp[] .
i_list_final_tmp[] = i_list_final[] .

DELETE i_list_final_tmp WHERE object_type NE 'STRU' .

IF NOT i_list_final_tmp[] IS INITIAL .
LOOP AT i_list_final_tmp INTO wa_list_final .
CALL FUNCTION 'Z_IBM_GET_STRUC_DETAILS'
EXPORTING
im_object_id  = wa_list_final-object_id+0(30)
TABLES
tb_tab_struc  = i_stru_details_tmp
EXCEPTIONS
no_data_found = 1
OTHERS        = 2.
IF sy-subrc = 0.

APPEND LINES OF i_stru_details_tmp TO i_stru_details .
REFRESH i_stru_details_tmp[] .

ENDIF.

ENDLOOP.

ENDIF.



ENDFORM.                    " sub_field_details
*&---------------------------------------------------------------------*
*&      Form  sub_get_index
*&---------------------------------------------------------------------*
*       get the indexes
*----------------------------------------------------------------------*
FORM sub_get_index .

* get the indexes
SELECT  sqltab       " Table Name
indexname    " Unique Index ID in a Table
ddtext       " description
FROM dd12v
INTO TABLE i_index
WHERE NOT as4user IN ('SAP','DDIC')
AND   ddlanguage EQ sy-langu.

i_std_index[] = i_index[].

DELETE i_index WHERE NOT sqltab IN r_object.

*  get the index for standards

DELETE i_std_index WHERE sqltab IN r_object.




ENDFORM.                    " sub_get_index
*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_index
*&---------------------------------------------------------------------*
*      for index
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_index .

m_fieldcat 'I_INDEX' 'INDEXNAME' 'Index Name'(009)  ' '
i_fieldcat6  '15'.

m_fieldcat 'I_INDEX' 'DDTEXT' 'Description'(266)  ' '
i_fieldcat6  '65' .

m_fieldcat 'I_INDEX' 'SQLTAB' 'Table Name'(026)  ' '
i_fieldcat6  '30' .

ENDFORM.                    " sub_prep_fcatalog_index

*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_fexit
*&---------------------------------------------------------------------*
*      for index
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_fexit .

m_fieldcat 'I_EXIT' 'ENH' 'Enhancement'(095)  ' '
i_fieldcat19  '15'.

m_fieldcat 'I_EXIT' 'MEMBER' 'Enh. Component'(104)  ' '
i_fieldcat19  '60' .

m_fieldcat 'I_EXIT' 'PROJ' 'CMOD Project'(105)  ' '
i_fieldcat19  '15'.

m_fieldcat 'I_EXIT' 'DCLASS' 'Package'(098)  ' '
i_fieldcat19  '30'.

ENDFORM.                    " sub_prep_fcatalog_fexit

*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_wflow
*&---------------------------------------------------------------------*
*      for index
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_wflow .

*Begin of change by Rudra R
*  m_fieldcat 'I_WFLOW' 'OTYPE' 'Obj Type'(142)  ' '
*  i_fieldcat24  '8'.
*
*  m_fieldcat 'I_WFLOW' 'OBJID' 'Object ID'(143)  ' '
*  i_fieldcat24  '20' .
*
*  m_fieldcat 'I_WFLOW' 'STEXT' 'Short Text'(144)  ' '
*  i_fieldcat24  '60'.

m_fieldcat 'I_CUST_WFLOW' 'OTYPE' 'Obj Type'(142)  ' '
i_fieldcat24  '8'.

m_fieldcat 'I_CUST_WFLOW' 'OBJID' 'Object ID'(143)  ' '
i_fieldcat24  '20' .

m_fieldcat 'I_CUST_WFLOW' 'STEXT' 'Short Text'(144)  ' '
i_fieldcat24  '60'.

m_fieldcat 'I_CUST_WFLOW' 'COUNT' 'Usage Count'(233)  ' '
i_fieldcat24  '60'.

*End of change by Rudra R

ENDFORM.                    " sub_prep_fcatalog_wflow

*&---------------------------------------------------------------------*
*&      Form  SUB_PREP_FCATALOG_VOFM
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_vofm .

m_fieldcat 'I_VOFM' 'GRPZE' 'Group Indicator'(116)  ' '
i_fieldcat20  '15'.

m_fieldcat 'I_VOFM' 'DDTEXT' 'Group Indicator Text'(117)  ' '
i_fieldcat20  '50'.

m_fieldcat 'I_VOFM' 'GRPNO' 'No of the routine'(118)  ' '
i_fieldcat20  '20' .

m_fieldcat 'I_VOFM' 'KAPPL' 'Application'(119)  ' '
i_fieldcat20  '12'.

m_fieldcat 'I_VOFM' 'BEZEI' 'Description'(120)  ' '
i_fieldcat20  '30'.


ENDFORM.                    " SUB_PREP_FCATALOG_VOFM


*&---------------------------------------------------------------------*
*&      Form  SUB_PREP_FCATALOG_BADI
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_badi .

m_fieldcat 'I_BADI' 'IMP_NAME' 'BADI Implementation'(135)  ' '
i_fieldcat23  '30'.

m_fieldcat 'I_BADI' 'EXIT_NAME' 'BADI Definition'(136)  ' '
i_fieldcat23  '30'.

m_fieldcat 'I_BADI' 'DEVCLASS' 'Package'(137)  ' '
i_fieldcat23  '30' .


ENDFORM.                    " SUB_PREP_FCATALOG_BADI

*&---------------------------------------------------------------------*
*&      Form  SUB_PREP_FCATALOG_UEXIT_SD
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_uexit_sd .

m_fieldcat 'I_UEXIT_SD' 'OBJ_NAME' 'Object Name'(129)  ' '
i_fieldcat22  '15'.

m_fieldcat 'I_UEXIT_SD' 'INT_NAME' 'User Exit Name'(130)  ' '
i_fieldcat22  '30'.


ENDFORM.                    " SUB_PREP_FCATALOG_UEXIT_SD

*&---------------------------------------------------------------------*
*&      Form  SUB_PREP_FCATALOG_BTE
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_bte .

m_fieldcat 'I_BTE' 'EVENT' 'Event/Process'(123)  ' '
i_fieldcat21  '15'.

m_fieldcat 'I_BTE' 'TEXT1' 'Description'(124)  ' '
i_fieldcat21  '60'.

m_fieldcat 'I_BTE' 'STDFB' 'Function Module'(125)  ' '
i_fieldcat21  '40' .

ENDFORM.                    " SUB_PREP_FCATALOG_VOFM



*&---------------------------------------------------------------------*
*&      Form  sub_get_query
*&---------------------------------------------------------------------*
*       get all the custom query created
*----------------------------------------------------------------------*
FORM sub_get_query .
DATA : BEGIN OF i_query_temp OCCURS 0,
query(26) TYPE c,
END OF i_query_temp.
DATA:
l_num LIKE aqgqcat-num,
l_qnum LIKE aqgqcat-qnum.

SELECT *
FROM aqgqcat
INTO CORRESPONDING FIELDS OF TABLE i_query
WHERE qnum IN r_object.

SELECT *
FROM aqlqcat
CLIENT SPECIFIED
APPENDING TABLE i_query
WHERE qnum IN r_object.

SELECT obj_name
FROM tadir
INTO TABLE i_query_temp
WHERE pgmid = 'R3TR'
AND object = 'AQQU'
AND obj_name IN r_object
AND devclass IN s_pack.

LOOP AT i_query_temp.
SPLIT i_query_temp AT space INTO l_num l_qnum.
CONDENSE:
l_num NO-GAPS,
l_qnum NO-GAPS.

READ TABLE i_query INTO wa_query WITH KEY
num = l_num
qnum = l_qnum.
IF sy-subrc <> 0.
wa_query-num = 'X'.
MODIFY i_query FROM wa_query TRANSPORTING num
WHERE num = l_num AND qnum = l_qnum.
ENDIF.
ENDLOOP.
IF NOT i_query_temp[] IS INITIAL.
DELETE i_query WHERE num = 'X'.
ELSE.
DELETE i_query WHERE num <> 'X'.
ENDIF.
ENDFORM.                    " sub_get_query
*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_query
*&---------------------------------------------------------------------*
*       for query
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_query .

m_fieldcat 'I_QUERY' 'MANDT' 'Client'(131)  ' '
i_fieldcat7  '6' .

m_fieldcat 'I_QUERY' 'NUM' 'User Group'(064)  ' '
i_fieldcat7  '15'.

m_fieldcat 'I_QUERY' 'QNUM' 'Query Name'(011)  ' '
i_fieldcat7  '15'.

m_fieldcat 'I_QUERY' 'CLAS' 'Infoset Name'(012)  ' '
i_fieldcat7  '30' .


ENDFORM.                    " sub_prep_fcatalog_query
*&---------------------------------------------------------------------*
*&      Form  sub_get_variants
*&---------------------------------------------------------------------*
*       get all variants
*----------------------------------------------------------------------*
FORM sub_get_variants .

* For custom variant
SELECT report  " code
variant " variant name
FROM varid
INTO TABLE i_varid
WHERE ename  NE 'SAP' .

i_std_varid[] = i_varid[] .

DELETE i_varid WHERE NOT report IN r_object.

* For Standard variant
DELETE i_std_varid WHERE report IN r_object.

ENDFORM.                    " sub_get_variants
*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_varnt
*&---------------------------------------------------------------------*
*       for variants
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_varnt .

m_fieldcat 'I_VARID' 'REPORT' 'Report Name'(014)  ' '
i_fieldcat8  '40'.

m_fieldcat 'I_VARID' 'VARIANT' 'Variant Name'(019)  ' '
i_fieldcat8  '15' .


ENDFORM.                    " sub_prep_fcatalog_varnt
*&---------------------------------------------------------------------*
*&      Form  sub_get_area_menu
*&---------------------------------------------------------------------*
*       area menu
*----------------------------------------------------------------------*
FORM sub_get_area_menu .

SELECT id devclass
INTO TABLE i_area
FROM ttree INNER JOIN tadir
ON ttree~id = tadir~obj_name
WHERE id IN r_object
AND   type EQ 'BMENU'
AND  pgmid EQ 'R3TR'
AND  object EQ 'SHI3'
AND  devclass IN s_pack.
ENDFORM.                    " sub_get_area_menu
*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_area
*&---------------------------------------------------------------------*
*       area menu
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_area .
m_fieldcat 'I_AREA' 'DEVCLASS' 'Package'(098)  ' '
i_fieldcat9  '35'.

m_fieldcat 'I_AREA' 'ID' 'Area Menu Name'(020)  ' '
i_fieldcat9  '35'.

ENDFORM.                    " sub_prep_fcatalog_area
*&---------------------------------------------------------------------*
*&      Form  sub_get_mssg
*&---------------------------------------------------------------------*
*       get custom messages
*----------------------------------------------------------------------*
FORM sub_get_mssg .

SELECT  arbgb  " Application Area
msgnr  " Message number
text   " Message text
devclass
INTO TABLE i_t100
FROM t100 INNER JOIN tadir
ON t100~arbgb = tadir~obj_name
WHERE sprsl =  sy-langu
AND   arbgb IN r_object
AND   text  NE space
AND   pgmid EQ 'R3TR'
AND   object EQ 'MSAG'
AND   devclass IN s_pack.
ENDFORM.                    " sub_get_mssg
*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_msg
*&---------------------------------------------------------------------*
*       messages
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_msg .
m_fieldcat 'I_T100' 'DEVCLASS' 'Package'(098)  ' '
i_fieldcat10  '25'.

m_fieldcat 'I_T100' 'ARBGB' 'Message Class'(045)  ' '
i_fieldcat10  '25'.

m_fieldcat 'I_T100' 'MSGNR' 'Message Number'(057)  ' '
i_fieldcat10  '5'.

m_fieldcat 'I_T100' 'TEXT' 'Message'(056)  ' '
i_fieldcat10  '75'.

ENDFORM.                    " sub_prep_fcatalog_msg

*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_sapsc
*&---------------------------------------------------------------------*
*       for sapscripts
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_sapsc .

m_fieldcat 'I_STXH' 'TDFORM' 'Formname'(046)  ' '
i_fieldcat11  '20'.

m_fieldcat 'I_STXH' 'TDSPRAS' 'Language'(047)  ' '
i_fieldcat11  '20'.

m_fieldcat 'I_STXH' 'TDTITLE' 'Description'(035)  ' '
i_fieldcat11  '55'.

ENDFORM.                    " sub_prep_fcatalog_sapsc

*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_smart
*&---------------------------------------------------------------------*
*       for smartforms
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_smart .
m_fieldcat 'I_STXFADMT' 'FORMNAME' 'Formname'(046)  ' '
i_fieldcat12  '30'.

m_fieldcat 'I_STXFADMT' 'LANGU' 'Language'(047)  ' '
i_fieldcat12  '20'.

m_fieldcat 'I_STXFADMT' 'CAPTION' 'Description'(035)  ' '
i_fieldcat12  '55'.

ENDFORM.                    " sub_prep_fcatalog_smart

*&---------------------------------------------------------------------
*
*&      Form  sub_restr_param
*&---------------------------------------------------------------------
*
*      restriction to single value
*----------------------------------------------------------------------
*
FORM sub_restr_param .


* Define the object to be passed to the RESTRICTION parameter
DATA wa_restrict TYPE sscr_restrict.

* Auxiliary objects for filling RESTRICT
DATA : wa_optlist TYPE sscr_opt_list,
wa_ass TYPE sscr_ass.

* Restricting the  Parameter selection to only EQ .
wa_optlist-name = 'OBJECTKEY1'.
wa_optlist-options-eq = c_flag .
APPEND wa_optlist TO wa_restrict-opt_list_tab.

wa_ass-kind = 'S' .
wa_ass-name = 'S_NAME'.
wa_ass-sg_main = 'I'.
wa_ass-op_main = 'OBJECTKEY1'.
APPEND wa_ass TO wa_restrict-ass_tab.


CALL FUNCTION 'SELECT_OPTIONS_RESTRICT'
EXPORTING
restriction            = wa_restrict
EXCEPTIONS
too_late               = 1
repeated               = 2
selopt_without_options = 3
selopt_without_signs   = 4
invalid_sign           = 5
empty_option_list      = 6
invalid_kind           = 7
repeated_kind_a        = 8
OTHERS                 = 9.
IF sy-subrc <> 0.
MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
ENDIF.


ENDFORM.                    " sub_restr_param
*&---------------------------------------------------------------------*
*&      Form  sub_get_all_progs
*&---------------------------------------------------------------------*
*       get all the progs according to their description
*----------------------------------------------------------------------*
FORM sub_get_all_progs .


SELECT prog   " code name
appl       " application
FROM d010sinf INNER JOIN tadir
ON d010sinf~prog = tadir~obj_name
INTO TABLE i_prog
WHERE prog IN r_object
AND   r3state  EQ 'A'
AND (  subc = '1'
OR     subc = 'M' )
AND pgmid = 'R3TR'
AND object = 'PROG'
AND devclass IN s_pack.

SELECT *
FROM taplt
INTO TABLE i_taplp
WHERE sprsl = sy-langu .

IF sy-subrc EQ 0.
SORT i_prog BY appl .
ENDIF.
ENDFORM.                    " sub_get_all_progs
*&---------------------------------------------------------------------*
*&      Form  sub_disp_all_progs
*&---------------------------------------------------------------------*
*       display all the progs according to their description
*----------------------------------------------------------------------*
FORM sub_disp_all_progs .

LOOP AT  i_prog INTO wa_prog .
READ TABLE i_taplp INTO wa_taplp
WITH KEY appl = wa_prog-appl BINARY SEARCH .

IF sy-subrc EQ 0.
wa_prog-appl = wa_taplp-atext .
ENDIF.

MODIFY i_prog FROM wa_prog TRANSPORTING appl .
ENDLOOP.

SORT i_prog BY appl .
ENDFORM.                    " sub_disp_all_progs
*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_dev
*&---------------------------------------------------------------------*
*       for programs in diff appl
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_dev .

m_fieldcat 'I_PROG' 'APPL' 'Application'(051)  ' '
i_fieldcat13  '20'.

m_fieldcat 'I_PROG' 'PROGNAME' 'Program Name'(052)  ' '
i_fieldcat13  '40'.


ENDFORM.                    " sub_prep_fcatalog_dev
*&---------------------------------------------------------------------*
*&      Form  sub_summ_report
*&---------------------------------------------------------------------*
*       display summary report
*----------------------------------------------------------------------*
FORM sub_summ_report .

PERFORM sub_populate_events .
DATA : l_count TYPE i .

IF std_modf = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Standard Objects Modified :'(015).
DESCRIBE TABLE i_adir_final LINES wa_summ-number .
wa_summ-form = 'SUB_REP_STD_MODF' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .
ENDIF.

IF cus_dev = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =    'All Custom Developments :'(025) .
DESCRIBE TABLE i_cust_final LINES wa_summ-number .

wa_summ-form = 'SUB_REP_CUS_DEV' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF cus_det = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Custom Table Field Details :'(036).
DESCRIBE TABLE i_tabl_details LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_DET_TAB' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Custom View Field Details :'(040).
DESCRIBE TABLE i_view_details LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_DET_VIEW' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Custom Structure Field Details :'(039).
DESCRIBE TABLE i_stru_details LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_DET_STRU' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF enhan = c_flag.
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-107.
DESCRIBE TABLE i_exit LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_FEXIT' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-114.
DESCRIBE TABLE i_vofm LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_VOFM' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-122.
DESCRIBE TABLE i_bte LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_BTE' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-127.
DESCRIBE TABLE i_uexit_sd LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_UEXIT_SD' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-133.
DESCRIBE TABLE i_badi LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_BADI' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF workflow = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-145.
DESCRIBE TABLE i_std_wflow LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_STD_WFLOW' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .


l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = text-141.
DESCRIBE TABLE i_wflow LINES wa_summ-number.
wa_summ-form = 'SUB_DISPLAY_WFLOW' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .
ENDIF.

IF cus_ind = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Index on Custom Tables:'(013).
DESCRIBE TABLE i_index LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_IND' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Index on Standard Tables:'(084).
DESCRIBE TABLE i_std_index LINES wa_summ-number .

wa_summ-form = 'SUB_REP_STD_IND' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .
ENDIF.


IF cus_que = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = 'Custom Query Details :'(010).
DESCRIBE TABLE i_query LINES wa_summ-number .

wa_summ-form = 'SUB_REP_CUS_QUE'.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.
IF cus_var = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Variant of Custom Programs:'(021).
DESCRIBE TABLE i_varid LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_VAR' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Variant of Standard Programs:'(085).
DESCRIBE TABLE i_std_varid LINES wa_summ-number .
wa_summ-form = 'SUB_REP_STD_VAR' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF cus_area = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .

wa_summ-category =  'Custom Area Menu Details :'(024).
DESCRIBE TABLE i_area LINES wa_summ-number .

wa_summ-form = 'SUB_REP_CUS_AREA' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.

IF cus_mes = c_flag .
l_count = l_count + 1 .
wa_summ-line = l_count .

wa_summ-category =  'Custom Message Details :'(055).
DESCRIBE TABLE i_t100 LINES wa_summ-number .
wa_summ-form = 'SUB_REP_CUS_MES' .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

ENDIF.
****Begin of change by Rudra R

*  IF dev_appl = c_flag .
*    l_count = l_count + 1 .
*    wa_summ-line = l_count .
*
*    wa_summ-category =  'Programs in Different Applications :'(050) .
*    DESCRIBE TABLE i_prog LINES wa_summ-number .
*    wa_summ-form = 'SUB_REP_DEV_APPL' .
*    APPEND wa_summ TO i_summ .
*    CLEAR wa_summ .
*
*  ENDIF.
****End of change by Rudra R



PERFORM sub_write_report .

PERFORM sub_get_print_release.


ENDFORM.                    " sub_summ_report
*&---------------------------------------------------------------------*
*&      Form  sub_write_report
*&---------------------------------------------------------------------*
*       write report
*----------------------------------------------------------------------*
FORM sub_write_report .

* for ADIRACCESS table for report
DATA: i_adir_final_tmp1 TYPE
STANDARD TABLE OF x_adir_final INITIAL SIZE 0.
DATA : l_line TYPE char10 ,
l_index TYPE char5 .
DATA : i_cust_final_tmp1 TYPE STANDARD TABLE OF x_adir_final
INITIAL SIZE 0.

DATA : l_tabix TYPE sy-tabix .

SORT i_adir BY obj_type obj_name sub_type sub_name.
SORT i_cust_final BY object .

i_adir_final_tmp1[] = i_adir_final[] .
DELETE ADJACENT DUPLICATES FROM i_adir_final_tmp1
COMPARING object .

i_cust_final_tmp1[] = i_cust_final[] .
DELETE ADJACENT DUPLICATES FROM i_cust_final_tmp1
COMPARING object .
IF NOT i_summ[] IS INITIAL.
WRITE:/ 'Development Related Information'(267).
* Format the output

FORMAT COLOR COL_HEADING INTENSIFIED OFF.
ULINE AT /(82).
WRITE: / sy-vline, 'No.' , 8 sy-vline ,  25 'Category'(053),
64 sy-vline, 66 'Total Count'(054) .
WRITE AT 82 sy-vline.
ULINE AT /(82).

FORMAT COLOR COL_NORMAL.

IF p_estm <> 'X'.
FORMAT HOTSPOT ON.
ENDIF.
ENDIF.
LOOP AT i_summ INTO wa_summ .

wa_summ_det = wa_summ .
APPEND wa_summ_det TO i_summ_det .


WRITE: / sy-vline, wa_summ_det-line , 8 sy-vline ,
wa_summ_det-category, 64 sy-vline,
wa_summ_det-number  .

HIDE : wa_summ_det-category .

WRITE AT 82 sy-vline.
ULINE AT /(82).
* for subdivison of first category
IF wa_summ_det-form = 'SUB_REP_STD_MODF' AND wa_summ_det-line > 0 .

l_index = '1.00' .

LOOP AT i_adir_final_tmp1 INTO wa_adir_final .

i_adir_final_tmp2[] = i_adir_final[] .
DELETE i_adir_final_tmp2
WHERE object NE wa_adir_final-object .
DESCRIBE TABLE i_adir_final_tmp2 LINES l_line.
l_index = l_index + ( 1 / 100 ) .
wa_summ-line = l_index .

wa_summ_det-line = l_index .
wa_summ_det-category = wa_adir_final-text .
wa_summ_det-number = l_line.
wa_summ_det-form = 'SUB_REP_STD_MODF' .



WRITE: / sy-vline, 8 sy-vline ,
wa_summ_det-category, 64 sy-vline,
l_line   .
WRITE AT 82 sy-vline.
ULINE AT /(82).

APPEND wa_summ_det TO i_summ_det .

HIDE : wa_summ_det-category .



ENDLOOP.
ENDIF.

* for subdivison of second category
IF wa_summ-form = 'SUB_REP_CUS_DEV' AND wa_summ-line > 0 .

CONCATENATE wa_summ-line '.00' INTO l_index .
LOOP AT i_cust_final_tmp1 INTO wa_cust_final .

l_tabix = l_tabix + 1 .

i_cust_final_tmp2[] = i_cust_final[] .
DELETE i_cust_final_tmp2
WHERE object NE wa_cust_final-object .
DESCRIBE TABLE i_cust_final_tmp2 LINES l_line.

l_index = l_index + ( 1 / 100 ) .
wa_summ-line = l_index .

wa_summ_det-line = l_index .
wa_summ_det-category = wa_cust_final-text .
wa_summ_det-number = l_line.
wa_summ_det-form = 'SUB_REP_CUS_DEV' .

WRITE: / sy-vline, 8 sy-vline ,
wa_summ_det-category, 64 sy-vline,
l_line   .

WRITE AT 82 sy-vline.
ULINE AT /(82).


APPEND wa_summ_det TO i_summ_det .

HIDE : wa_summ_det-category .

ENDLOOP.
ENDIF.


ENDLOOP.
FORMAT HOTSPOT OFF.

FORMAT COLOR OFF.



ENDFORM.                    " sub_write_report
*&---------------------------------------------------------------------*
*&      Form  sub_rep_std_modf
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_rep_std_modf .

REFRESH i_adir_final_tmp2 .
i_adir_final_tmp2[] = i_adir_final[] .

IF p_summ = c_flag AND
wa_summ_det-category NE  'Standard Objects Modified :'(015).
DELETE i_adir_final_tmp2
WHERE text NE wa_summ_det-category .
ENDIF.

REFRESH i_fieldcat[] .
SORT i_adir_final_tmp2 BY object sub_type obj_name sub_name.
* prepare field catalog
* build field catalog for 1st block

PERFORM sub_prep_fcalaog_std .

CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat
i_tabname                  = 'I_ADIR_FINAL_TMP2'
it_events                  = i_events
TABLES
t_outtab                   = i_adir_final_tmp2
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " sub_rep_std_modf
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_dev
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_rep_cus_dev .

REFRESH i_fieldcat2[] .

REFRESH : i_cust_final_tmp2 .
i_cust_final_tmp2[] = i_cust_final[] .

IF p_summ = c_flag AND
wa_summ_det-category NE  'All Custom Developments :'(025) .
DELETE i_cust_final_tmp2
WHERE text NE wa_summ_det-category .
ENDIF.

* build field catalog for 2nd block
PERFORM sub_prep_fcalaog_cus .

CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat2
i_tabname                  = 'I_CUST_FINAL_TMP2'
it_events                  = i_events2
TABLES
t_outtab                   = i_cust_final_tmp2
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.


ENDFORM.                    " sub_rep_cus_dev
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_ind
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_rep_cus_ind .

*tables p_tab_idx
*using p_tabname_idx type char30.

REFRESH i_fieldcat6[] .

* prepare field catalog
* build field catalog for 4th block
PERFORM sub_prep_fcatalog_index .


* for index
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat6
i_tabname                  = 'I_INDEX'
it_events                  = i_events6
TABLES
t_outtab                   = i_index
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.



ENDFORM.                    " sub_rep_cus_ind
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_que
*&---------------------------------------------------------------------*
*      for custom query
*----------------------------------------------------------------------*
FORM sub_rep_cus_que .

REFRESH i_fieldcat7[] .

* prepare field catalog
* build field catalog for 5th block
PERFORM sub_prep_fcatalog_query .


* for query
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat7
i_tabname                  = 'I_QUERY'
it_events                  = i_events7
TABLES
t_outtab                   = i_query
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.



ENDFORM.                    " sub_rep_cus_que
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_var
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_rep_cus_var .

REFRESH i_fieldcat8[] .

* prepare field catalog
* build field catalog for 5th block
PERFORM sub_prep_fcatalog_varnt.


* for variants
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat8
i_tabname                  = 'I_VARID'
it_events                  = i_events8
TABLES
t_outtab                   = i_varid
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.


ENDFORM.                    " sub_rep_cus_var
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_area
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_rep_cus_area .
REFRESH i_fieldcat9[] .

* prepare field catalog
* build field catalog for 6th block
PERFORM sub_prep_fcatalog_area.


* for area menu
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat9
i_tabname                  = 'I_AREA'
it_events                  = i_events9
TABLES
t_outtab                   = i_area
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " sub_rep_cus_area
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_mes
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_rep_cus_mes .

REFRESH i_fieldcat10[] .

* prepare field catalog
* build field catalog for 7th block
PERFORM sub_prep_fcatalog_msg.


* for messages
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat10
i_tabname                  = 'I_T100'
it_events                  = i_events10
TABLES
t_outtab                   = i_t100
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.


ENDFORM.                    " sub_rep_cus_mes
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_forms
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_rep_cus_forms .

REFRESH i_fieldcat11[] .

REFRESH i_fieldcat12[] .

* prepare field catalog
* build field catalog for 8th block
PERFORM sub_prep_fcatalog_sapsc.

PERFORM sub_prep_fcatalog_smart.


* for sapscripts text
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat11
i_tabname                  = 'I_STXH'
it_events                  = i_events11
TABLES
t_outtab                   = i_stxh
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

* for smartforms texts
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat12
i_tabname                  = 'I_STXFADMT'
it_events                  = i_events12
TABLES
t_outtab                   = i_stxfadmt
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.


ENDFORM.                    " sub_rep_cus_forms
*&---------------------------------------------------------------------*
*&      Form  sub_rep_dev_appl
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_rep_dev_appl .

REFRESH i_fieldcat13[] .

* prepare field catalog
PERFORM sub_prep_fcatalog_dev.

* for programs in different application
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat13
i_tabname                  = 'I_PROG'
it_events                  = i_events13
TABLES
t_outtab                   = i_prog
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.


ENDFORM.                    " sub_rep_dev_appl
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_det_tab
*&---------------------------------------------------------------------*
*       custom details for tables
*----------------------------------------------------------------------*
FORM sub_rep_cus_det_tab .

REFRESH i_fieldcat3[] .

PERFORM sub_prep_fcatalog_field_tab .

* for table fields
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat3
i_tabname                  = 'I_TABL_DETAILS'
it_events                  = i_events3
TABLES
t_outtab                   = i_tabl_details
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " sub_rep_cus_det_tab
*&---------------------------------------------------------------------*
*&      Form  sub_prep_fcatalog_field_tab
*&---------------------------------------------------------------------*
*       for table fields
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_field_tab .

**********for table details
m_fieldcat 'I_TABL_DETAILS' 'TABNAME' 'Table Name'(026)  ' '
i_fieldcat3  '16'.

m_fieldcat 'I_TABL_DETAILS' 'FIELDNAME' 'Field Name'(027)  ' '
i_fieldcat3  '16' .

m_fieldcat 'I_TABL_DETAILS' 'IS_PRIMARY_KEY' 'Key ?'(028)  ' '
i_fieldcat3  '1'.

m_fieldcat 'I_TABL_DETAILS' 'DATAELEMENT' 'Data Element'(029)  ' '
i_fieldcat3  '16' .

m_fieldcat 'I_TABL_DETAILS' 'CHECKTABLE' 'Check Table'(030)  ' '
i_fieldcat3  '16' .

m_fieldcat 'I_TABL_DETAILS' 'DOMNAME' 'Domain'(031)  ' '
i_fieldcat3  '30' .

m_fieldcat 'I_TABL_DETAILS' 'DATATYPE' 'Data Type'(032)  ' '
i_fieldcat3  '10'.

m_fieldcat 'I_TABL_DETAILS' 'LENGTH' 'Length'(033)  ' '
i_fieldcat3  '6'.

m_fieldcat 'I_TABL_DETAILS' 'DECIMALS' 'Decimal Places'(034)  ' '
i_fieldcat3  '6'.

m_fieldcat 'I_TABL_DETAILS' 'FIELDTEXT' 'Description'(035)  ' '
i_fieldcat3  '60'.
m_fieldcat 'I_TABL_DETAILS' 'AREA' 'Function Group'(093)  ' '
i_fieldcat3  '25'.


ENDFORM.                    " sub_prep_fcatalog_field_tab
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_det_view
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_rep_cus_det_view .

REFRESH i_fieldcat4[] .
**********for view details

m_fieldcat 'I_VIEW_DETAILS' 'TABNAME' 'View Name'(037)  ' '
i_fieldcat4  '16'.

m_fieldcat 'I_VIEW_DETAILS' 'FIELDNAME' 'Field Name'(027)  ' '
i_fieldcat4  '16' .

m_fieldcat 'I_VIEW_DETAILS' 'DATAELEMENT' 'Data Element'(029)  ' '
i_fieldcat4  '16'.

m_fieldcat 'I_VIEW_DETAILS' 'DOMNAME' 'Domain'(031)  ' '
i_fieldcat4  '30'.

m_fieldcat 'I_VIEW_DETAILS' 'DATATYPE' 'Data Type'(032)  ' '
i_fieldcat4  '10'.

m_fieldcat 'I_VIEW_DETAILS' 'LENGTH' 'Length'(033)  ' '
i_fieldcat4  '6'.

m_fieldcat 'I_VIEW_DETAILS' 'DECIMALS' 'Decimal Places'(034)  ' '
i_fieldcat4  '6'.

m_fieldcat 'I_VIEW_DETAILS' 'FIELDTEXT' 'Description'(035)  ' '
i_fieldcat4  '60'.

m_fieldcat 'I_VIEW_DETAILS' 'AREA' 'Function Group'(093)  ' '
i_fieldcat4  '25'.
* for view fields
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat4
i_tabname                  = 'I_VIEW_DETAILS'
it_events                  = i_events4
TABLES
t_outtab                   = i_view_details
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " sub_rep_cus_det_view
*&---------------------------------------------------------------------*
*&      Form  sub_rep_cus_det_stru
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_rep_cus_det_stru .
REFRESH i_fieldcat5[] .
***********for structure details

m_fieldcat 'I_STRU_DETAILS' 'TABNAME' 'Structure Name'(038)  ' '
i_fieldcat5  '30' .

m_fieldcat 'I_STRU_DETAILS' 'FIELDNAME' 'Field Name'(027)  ' '
i_fieldcat5 '16' .

m_fieldcat 'I_STRU_DETAILS' 'DATAELEMENT' 'Data Element'(029)  ' '
i_fieldcat5  '16'.

m_fieldcat 'I_STRU_DETAILS' 'DOMNAME' 'Domain'(031)  ' '
i_fieldcat5  '30' .

m_fieldcat 'I_STRU_DETAILS' 'DATATYPE' 'Data Type'(032)  ' '
i_fieldcat5  '10' .

m_fieldcat 'I_STRU_DETAILS' 'LENGTH' 'Length'(033)  ' '
i_fieldcat5  '6' .

m_fieldcat 'I_STRU_DETAILS' 'DECIMALS' 'Decimal Places'(034)  ' '
i_fieldcat5  '6' .

m_fieldcat 'I_STRU_DETAILS' 'FIELDTEXT' 'Description'(035)  ' '
i_fieldcat5  '60' .

* for structure fields
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat5
i_tabname                  = 'I_STRU_DETAILS'
it_events                  = i_events5
TABLES
t_outtab                   = i_stru_details
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.


ENDFORM.                    " sub_rep_cus_det_stru


*&---------------------------------------------------------------------*
*&      Form  sub_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_SY_TITLE  text
*      -->P_SPACE  text
*----------------------------------------------------------------------*
FORM sub_header USING p_hdr_line1 TYPE sy-title
p_hdr_line2 TYPE tx72.

* Local data declarations----------------------------------------------*
DATA: l_pagno(5)   TYPE c,         " Page no
l_page_len   TYPE p,         " String length of page no
l_name_len   TYPE p,         " String length of company name
l_hdr1_len   TYPE p,         " String length of header line 1
l_hdr2_len   TYPE p,         " String length of header line 2
l_line1_pos  TYPE p,         " Printing pos of company name
l_line2_pos  TYPE p,         " Printing pos of header line 1
l_line3_pos  TYPE p,         " Printing pos of header line 2
l_right_pos1 TYPE p,         " Position from right margin
l_right_pos2 TYPE p,         " Position from right margin
l_center     TYPE p.         " Center of page

*----------------------------------------------------------------------*


v_count = v_count + 1 .
* Calculate string lengths and printing positions
l_name_len = STRLEN( 'Utility Tool for Upgrade'(058) ).
l_hdr1_len = STRLEN( p_hdr_line1 ).

l_center = ( sy-linsz / 2 ).

l_line1_pos = l_center - ( l_name_len / 2 ).
l_line2_pos = l_center - ( l_hdr1_len / 2 ).
l_line3_pos = l_center - ( l_hdr2_len / 2 ).

l_right_pos1 = sy-linsz - 10.
l_right_pos2 = sy-linsz - 16.

* Write 1st line of report header--------------------------------------*
WRITE: 'Report:'(062).
WRITE 9 sy-repid.

WRITE: AT l_line1_pos  'Utility Tool for Upgrade'(058),
AT l_right_pos2 'Page:'(059).

POSITION l_right_pos1.
* Left justify the page number
l_pagno = sy-pagno.
SHIFT l_pagno LEFT DELETING LEADING space.

l_page_len = STRLEN( l_pagno ).

IF l_page_len > 3.
WRITE (12) l_pagno USING EDIT MASK '_,___'.
ELSE.
WRITE (12) l_pagno.
ENDIF.

* Write 2nd line of report header--------------------------------------*
WRITE:/ 'System:'(268), AT 9  sy-sysid,
AT 12 '-',
AT 13 sy-mandt.

WRITE: AT l_line2_pos  p_hdr_line1,
AT l_right_pos2 'Date:'(269).

POSITION l_right_pos1.
WRITE (11) sy-datum.

* Write 3rd line of report header--------------------------------------*
WRITE:/ 'UserID:'(060), AT 9 sy-uname.

WRITE: AT l_right_pos2 'Time:'(061).

POSITION l_right_pos1.
WRITE (11) sy-uzeit.

ULINE.
ENDFORM.                               "SUB_HEADER

*&---------------------------------------------------------------------*
*&      Form  sub_header
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_SY_TITLE  text
*      -->P_SPACE  text
*----------------------------------------------------------------------*
FORM sub_header_all USING p_hdr_line1 TYPE sy-title
p_hdr_line2 TYPE tx72
p_heading.

* Local data declarations----------------------------------------------*
DATA: l_pagno(5)   TYPE c,         " Page no
l_page_len   TYPE p,         " String length of page no
l_name_len   TYPE p,         " String length of company name
l_hdr1_len   TYPE p,         " String length of header line 1
l_hdr2_len   TYPE p,         " String length of header line 2
l_line1_pos  TYPE p,         " Printing pos of company name
l_line2_pos  TYPE p,         " Printing pos of header line 1
l_line3_pos  TYPE p,         " Printing pos of header line 2
l_right_pos1 TYPE p,         " Position from right margin
l_right_pos2 TYPE p,         " Position from right margin
l_center     TYPE p.         " Center of page

*----------------------------------------------------------------------*


v_count = v_count + 1 .
* Calculate string lengths and printing positions
l_name_len = STRLEN( 'Utility Tool for Upgrade'(058) ).
l_hdr1_len = STRLEN( p_hdr_line1 ).

l_center = ( sy-linsz / 2 ).

l_line1_pos = l_center - ( l_name_len / 2 ).
l_line2_pos = l_center - ( l_hdr1_len / 2 ).
l_line3_pos = l_center - ( l_hdr2_len / 2 ).

l_right_pos1 = sy-linsz - 10.
l_right_pos2 = sy-linsz - 16.

* Write 1st line of report header--------------------------------------*
WRITE: 'Report:'(062).
WRITE 9 sy-repid.

WRITE: AT l_line1_pos  'Utility Tool for Upgrade'(058),
AT l_right_pos2 'Page:'(059).

POSITION l_right_pos1.
* Left justify the page number
l_pagno = sy-pagno.
SHIFT l_pagno LEFT DELETING LEADING space.

l_page_len = STRLEN( l_pagno ).

IF l_page_len > 3.
WRITE (12) l_pagno USING EDIT MASK '_,___'.
ELSE.
WRITE (12) l_pagno.
ENDIF.

* Write 2nd line of report header--------------------------------------*
WRITE:/ 'System:'(270),      AT 9  sy-sysid,
AT 12 '-',
AT 13 sy-mandt.

WRITE: AT l_line2_pos  p_hdr_line1,
AT l_right_pos2 'Date:'(271).

POSITION l_right_pos1.
WRITE (11) sy-datum.

* Write 3rd line of report header--------------------------------------*
WRITE:/ 'UserID:'(060), AT 9 sy-uname.

WRITE: AT l_right_pos2 'Time:'(061).

POSITION l_right_pos1.
WRITE (11) sy-uzeit.

ULINE.


SKIP 2 .
WRITE :/ p_heading .

ENDFORM.                               "SUB_HEADER_ALL
*&---------------------------------------------------------------------*
*&      Form  sub_display_line_det
*&---------------------------------------------------------------------*
*       display line details for the line clicked
*----------------------------------------------------------------------*
FORM sub_display_line_det .
CLEAR v_cat .

READ CURRENT LINE FIELD VALUE wa_summ_det-category INTO v_cat .

IF NOT v_cat IS INITIAL.

IF sy-lsind = 1.
CLEAR wa_summ_det .
READ TABLE i_summ_det INTO wa_summ_det
WITH KEY
category = v_cat .

IF sy-subrc EQ 0.
CLEAR v_count .
WINDOW STARTING AT '0'  '0'
ENDING AT  '100'  '100' .




CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_INIT'
EXPORTING
i_callback_program = sy-cprog.

PERFORM   (wa_summ_det-form) IN PROGRAM
z_ibm_utility_upgrade IF FOUND .

wa_print-reserve_lines = 2.

CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_DISPLAY'
EXPORTING
is_print = wa_print.

ENDIF.
ENDIF.
ELSEIF sy-lisel+9(11) = 'Custom Inbo'.
PERFORM sub_display_info TABLES
i_ale_inbound
i_events14
USING
i_fieldcat14
'I_ALE_INBOUND'
c_formname14.
ELSEIF sy-lisel+9(11) = 'Standard In'.
PERFORM sub_display_info TABLES
i_ale_std_inbound
i_events14
USING
i_fieldcat14
'I_ALE_STD_INBOUND'
c_formname20.
ELSEIF sy-lisel+9(11) = 'Custom Outb'.
PERFORM sub_display_info TABLES
i_ale_outbound
i_events14
USING
i_fieldcat14
'I_ALE_OUTBOUND'
c_formname21.
ELSEIF sy-lisel+9(11) = 'Standard Ou'.
PERFORM sub_display_info TABLES
i_ale_std_outbound
i_events14
USING
i_fieldcat14
'I_ALE_STD_OUTBOUND'
c_formname22.
ELSEIF sy-lisel+9(11) = 'LSMW Object'.
PERFORM sub_display_info TABLES
i_lsmw_objects
i_events14
USING
i_fieldcat14
'I_LSMW_OBJECTS'
c_formname23.
ELSEIF sy-lisel+9(11) = 'SAP Version'.
PERFORM sub_display_info TABLES
i_component
i_events14
USING
i_fieldcat14
'I_COMPONENT'
c_formname24.
ELSEIF sy-lisel+9(11) = 'No. of Inst'.
PERFORM sub_display_info TABLES
i_lang_final
i_events14
USING
i_fieldcat14
'I_LANG_FINAL'
c_formname25.

* Start of change by TDEY ----
ELSEIF sy-lisel+9(11) = 'No. of User'.
PERFORM sub_display_info TABLES
i_client_user
i_events14
USING
i_fieldcat14
'I_CLIENT_USER'
c_formname38.
ELSEIF sy-lisel+9(11) = 'No. of Serv'.
PERFORM sub_display_info TABLES
i_server
i_events14
USING
i_fieldcat14
'I_SERVER'
c_formname39.
* End of change by TDEY ----

ELSEIF sy-lisel+9(11) = 'Landscape D'.
PERFORM sub_display_info TABLES
i_landscape
i_events14
USING
i_fieldcat14
'I_LANDSCAPE'
c_formname26.
ELSEIF sy-lisel+9(11) = 'Hardware Pl'.
*{   REPLACE        TEDK909196                                        1
*\    PERFORM sub_display_info TABLES
*\                               i_hw_info
*\                               i_events14
*\                             USING
*\                               i_fieldcat14
*\                               'I_HW_INFO'
*\                               c_formname27.
*    PERFORM sub_display_info TABLES
*                               i_hw_info
*                               i_events14
*                             USING
*                               i_fieldcat14
*                               'I_HW_INFO'
*                               c_formname27.
*}   REPLACE
ELSEIF sy-lisel+9(11) = 'Program Usa'.
PERFORM sub_display_info TABLES
i_prog_stat1
i_events14
USING
i_fieldcat16
'I_PROG_STAT'
c_formname28.
ELSEIF sy-lisel+9(11) = 'Transaction'.

PERFORM sub_display_info TABLES
i_tran_stat2
i_events14
USING
i_fieldcat16
'I_TRAN_STAT'
c_formname29.
** Begin of change ** RKUMAR7 **
ELSEIF sy-lisel+9(11) = 'RFC Connect'.
PERFORM sub_display_info TABLES
i_rfcattrib
i_events14
USING
i_fieldcat14
'I_RFCATTRIB'
c_formname35.
ELSEIF sy-lisel+9(11) = 'Gateway Con'.
PERFORM sub_display_info TABLES
i_gwconn
i_events14
USING
i_fieldcat14
'I_GWCONN'
c_formname36.

ELSEIF sy-lisel+9(11) = 'Scheduled J'.
PERFORM sub_display_info TABLES
i_backgrnd
i_events14
USING
i_fieldcat14
'I_BACKGRND'
c_formname37.
** End of change ** RKUMAR7 **

ELSE.

MESSAGE e398 WITH 'Click on the item category line only'(063)
.
ENDIF.

ENDFORM.                    " sub_display_line_det
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_PRINT_RELEASE
*&---------------------------------------------------------------------*
* Get and Print Release Info
*----------------------------------------------------------------------*
FORM sub_get_print_release .
data l_v_stat_count type i.
IF v_stat_count > 0.
l_v_stat_count = v_stat_count - 1.
ELSE.
l_v_stat_count = 0.
ENDIF.
IF p_ale = 'X' OR p_lsmw = 'X'.
"OR p_land = 'X' . "OR p_hrdw = 'X'
FORMAT COLOR COL_HEADING INTENSIFIED ON.
WRITE:/ 'Interface and Conversion Related Information'(272).
FORMAT COLOR COL_HEADING INTENSIFIED OFF.



ULINE AT /(82).
WRITE: / sy-vline, 'No.'(273) , 8 sy-vline ,  25 'Category'(053),
64 sy-vline, 66 'Summary Info.'(274) .
WRITE AT 82 sy-vline.
ULINE AT /(82).


FORMAT COLOR COL_NORMAL.
FORMAT HOTSPOT ON.
ENDIF.
CLEAR sy-tabix.
IF p_ale = 'X'.
DESCRIBE TABLE i_ale_inbound.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Custom Inbound ALE Interfaces'(078), 64 sy-vline,
sy-tfill  .
WRITE AT 82 sy-vline.
ULINE AT /(82).
CLEAR sy-tfill.
DESCRIBE TABLE i_ale_std_inbound.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Standard Inbound ALE Interfaces'(099), 64 sy-vline,
sy-tfill  .
WRITE AT 82 sy-vline.
ULINE AT /(82).
CLEAR sy-tfill.
DESCRIBE TABLE i_ale_outbound.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Custom Outbound ALE Interfaces'(100), 64 sy-vline,
sy-tfill  .
WRITE AT 82 sy-vline.
ULINE AT /(82).
CLEAR sy-tfill.
DESCRIBE TABLE i_ale_std_outbound.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Standard Outbound ALE Interfaces'(101), 64 sy-vline,
sy-tfill  .
WRITE AT 82 sy-vline.
ULINE AT /(82).

ENDIF.
IF p_lsmw = 'X'.
DESCRIBE TABLE i_lsmw_objects.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'LSMW Objects'(275), 64 sy-vline,
sy-tfill  .
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

IF p_comp = 'X' OR p_lang = 'X'
OR p_land = 'X' OR p_hrdw = 'X'
* Start of change by TDEY ----
OR p_user = 'X'
OR p_server = 'X'
* End of change by TDEY ----
** Begin of change ** RKUMAR7 ** 07.08.2009
OR p_rfc = 'X'
OR p_gtway = 'X'.
** End of change ** RKUMAR7 ** 07.08.2009
FORMAT COLOR COL_HEADING INTENSIFIED ON.
WRITE:/ 'Basis Related Information'(276).
FORMAT COLOR COL_HEADING INTENSIFIED OFF.



ULINE AT /(82).
WRITE: / sy-vline, 'No.'(277) , 8 sy-vline ,  25 'Category'(053),
64 sy-vline, 66 'Summary Info.'(278) .
WRITE AT 82 sy-vline.
ULINE AT /(82).


FORMAT COLOR COL_NORMAL.
FORMAT HOTSPOT ON.
ENDIF.
CLEAR sy-tabix.
IF p_comp = 'X'.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'SAP Version Information'(108), 64 sy-vline,
cvers_txt-stext(16)  .
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

IF p_lang = 'X'.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED  , 8 sy-vline ,
'No. of Installed Languages'(109), 64 sy-vline,
v_no_of_lang .
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

* Start of change by TDEY ----
IF p_user = 'X'.
DESCRIBE TABLE i_client_user.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED  , 8 sy-vline ,
'No. of Users'(279), 64 sy-vline,
sy-tfill.
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

IF p_server = 'X'.
DESCRIBE TABLE i_server.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED  , 8 sy-vline ,
'No. of Servers'(280), 64 sy-vline,
sy-tfill.
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.
* End of change by TDEY ----

IF p_hrdw = 'X'.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Hardware Platform'(111), 64 sy-vline,
'   ', icon_select_detail AS ICON.
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

IF p_land = 'X'.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Landscape Details'(110), 64 sy-vline,
'   ', icon_select_detail AS ICON.

WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.
** Begin of change ** RKUMAR7 **
IF p_rfc = c_flag.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED  , 8 sy-vline ,
'RFC Connections'(201), 64 sy-vline,
v_rfc_count .
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

IF p_gtway = c_flag.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED  , 8 sy-vline ,
'Gateway Connections'(203), 64 sy-vline,
v_gtw_count .
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

** End of change ** RKUMAR7 **

IF p_pghis = 'X' OR p_dbhis = 'X'
** Begin of change ** RKUMAR7 **
OR p_bkgrnd = 'X'.
** End of change ** RKUMAR7 **
CLEAR sy-tabix.

FORMAT COLOR COL_HEADING INTENSIFIED ON.
WRITE:/ 'Statistical Information'(281).
FORMAT COLOR COL_HEADING INTENSIFIED OFF.



ULINE AT /(82).
WRITE: / sy-vline, 'No.' , 8 sy-vline ,  25 'Category'(053),
64 sy-vline, 66 'Summary Info.'(282) .
WRITE AT 82 sy-vline.
ULINE AT /(82).


FORMAT COLOR COL_NORMAL.
FORMAT HOTSPOT ON.

IF p_pghis = 'X'.
sy-tabix = sy-tabix + 1.
DESCRIBE TABLE i_prog_stat1.
WRITE: / sy-vline, '  ',sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Program Usage Statistics'(112), '(',
l_v_stat_count LEFT-JUSTIFIED,
40'months )'(283),
64 sy-vline,
'   ', sy-tfill.

WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.
IF p_dbhis = 'X'.
sy-tabix = sy-tabix + 1.
DESCRIBE TABLE i_tran_stat2.
WRITE: / sy-vline, '  ',sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Transaction Usage Statistics'(113), '(',
l_v_stat_count LEFT-JUSTIFIED,
44 'months )'(284),
64 sy-vline,
'   ', sy-tfill.

WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

****>>>Begin of change by Anjan
IF p_dbhis = 'X' OR p_pghis = 'X'.
**  Retrieve the data retention month if program or transaction
**  statistics is checked.
** For workload data retention
DATA l_tabix TYPE sy-tabix.
DATA l_retention_month TYPE sy-tabix.
l_tabix = sy-tabix.
PERFORM get_data_retention_month CHANGING l_retention_month.
sy-tabix = l_tabix.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ',sy-tabix LEFT-JUSTIFIED , 8 sy-vline ,
'Statistical Data Retained For Months'(418),
64 sy-vline,
'    ',l_retention_month.

WRITE AT 82 sy-vline.
ULINE AT /(82).

ENDIF.

****>>>End of change by Anjan


** Begin of change ** RKUMAR7 **
IF p_bkgrnd = c_flag.
sy-tabix = sy-tabix + 1.
WRITE: / sy-vline, '  ' ,sy-tabix LEFT-JUSTIFIED  , 8 sy-vline ,
'Scheduled Jobs'(204), 64 sy-vline,
'   ',v_job_count.
WRITE AT 82 sy-vline.
ULINE AT /(82).
ENDIF.

** End of change ** RKUMAR7 **
ENDIF.


ENDFORM.                    " SUB_GET_PRINT_RELEASE
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_BASIS_INFO
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_basis_info .

SELECT SINGLE * FROM cvers_txt WHERE langu = sy-langu.

PERFORM sub_get_software_comp.

ENDFORM.                    " SUB_GET_BASIS_INFO
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_SOFTWARE_COMP
*&---------------------------------------------------------------------*
* Get list of s/w components.
*----------------------------------------------------------------------*
FORM sub_get_software_comp .
** Begin of change ** RKUMAR7 **
TYPES: BEGIN OF x_cvers_ref,
component TYPE dlvunit,
desc_text TYPE comp_desc,
END OF x_cvers_ref.
DATA: l_i_ref TYPE STANDARD TABLE OF x_cvers_ref INITIAL SIZE 0,
l_wa_ref TYPE x_cvers_ref.

* Retrieve information from cvers table
SELECT
cvers~component
cvers~release
cvers~extrelease
cvers~comp_type
dd07t~ddtext
FROM ( ( cvers INNER JOIN dd07l ON
dd07l~domvalue_l = cvers~comp_type )
INNER JOIN dd07t ON dd07l~valpos = dd07t~valpos )
INTO TABLE i_component
WHERE dd07l~domname = 'RELC_TYPE'
AND  dd07t~ddlanguage = sy-langu
AND  dd07t~domname = 'RELC_TYPE'.
IF sy-subrc = 0.
IF NOT i_component[] IS INITIAL.
*     Get the corresponding text
SELECT component
desc_text
FROM cvers_ref
INTO TABLE l_i_ref
FOR ALL ENTRIES IN i_component
WHERE component = i_component-component
AND   langu = sy-langu.
IF sy-subrc = 0.
SORT l_i_ref BY component.
LOOP AT i_component.
READ TABLE l_i_ref INTO l_wa_ref WITH KEY
component = i_component-component BINARY SEARCH.
IF sy-subrc = 0.
i_component-desc_text = l_wa_ref-desc_text.
MODIFY i_component.
ENDIF.
ENDLOOP.
ENDIF.
ENDIF.
ENDIF.
*  SELECT
*    cvers~component
*    cvers~release
*    cvers~extrelease
*    cvers~comp_type
*** Begin of change ** RKUMAR7 ** 16.06.2009 16:28:11
*    dd07t~ddtext
*    cvers_ref~desc_text
**    FROM cvers INNER JOIN cvers_ref
**    ON cvers~component = cvers_ref~component
**    INTO TABLE i_component
**    WHERE cvers_ref~langu = sy-langu.
*   FROM ( ( ( cvers INNER JOIN cvers_ref
*    ON cvers~component = cvers_ref~component )
*    INNER JOIN dd07l ON dd07l~domvalue_l = cvers~comp_type )
*    INNER JOIN dd07t ON dd07l~valpos = dd07t~valpos )
*    INTO TABLE i_component
*   WHERE cvers_ref~langu = sy-langu
*    AND   dd07l~domname = 'RELC_TYPE'
*    AND   dd07t~ddlanguage = sy-langu
*    AND  dd07t~domname = 'RELC_TYPE'.
** End of change ** RKUMAR7 **
ENDFORM.                    " SUB_GET_SOFTWARE_COMP
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_LANG_INFO
*&---------------------------------------------------------------------*
* Get language information
*----------------------------------------------------------------------*
FORM sub_get_lang_info .
DATA: BEGIN OF i_lang OCCURS 0,
spras TYPE spras,
END OF i_lang.

** Begin of change ** RKUMAR7 **
DATA: i_codepage TYPE STANDARD TABLE OF tcp09 INITIAL SIZE 0,
wa_codepage TYPE tcp09,
l_index TYPE sytabix.
** End of change ** RKUMAR7 **
*Begin of Change Anjan
DATA l_codepage TYPE cpcodepage.

*End of change Anjan

SELECT spras FROM tlanimp INTO TABLE i_lang.
SORT i_lang BY spras.
DELETE ADJACENT DUPLICATES FROM i_lang COMPARING spras.
DESCRIBE TABLE i_lang LINES v_no_of_lang.

IF NOT i_lang[] IS INITIAL.
SELECT * FROM t002 INTO TABLE i_lang_detail
FOR ALL ENTRIES IN i_lang WHERE spras = i_lang-spras.
** Begin of change ** RKUMAR7 **
* Get data for the codepages per language installed
*    SELECT * FROM tcp09 INTO TABLE i_codepage
*      FOR ALL ENTRIES IN i_lang WHERE
*     lang = i_lang-spras.
*    IF sy-subrc = 0.
*      SORT i_codepage BY lang.
*    ENDIF.
** End of change ** RKUMAR7 **
ENDIF.

SELECT * FROM t002t INTO TABLE i_lang_desc.

LOOP AT i_lang.
READ TABLE i_lang_detail WITH KEY spras = i_lang-spras.
IF sy-subrc = 0.
MOVE-CORRESPONDING i_lang_detail TO i_lang_final.
READ TABLE i_lang_desc WITH KEY spras = sy-langu
sprsl = i_lang-spras.
IF sy-subrc = 0.
MOVE i_lang_desc-sptxt TO i_lang_final-sptxt.

ENDIF.

*Begin of change Anjan

CALL FUNCTION 'SCP_CODEPAGE_FOR_LANGUAGE'
EXPORTING
language    = i_lang-spras
IMPORTING
codepage    = l_codepage
EXCEPTIONS
no_codepage = 1
OTHERS      = 2.
IF sy-subrc = 0.
i_lang_final-codepage = l_codepage.
ENDIF.

APPEND i_lang_final.
ENDIF.
APPEND i_lang-spras TO i_spras.

*End of Change Anjan

** Begin of change ** RKUMAR7 **
*      READ TABLE i_codepage WITH KEY lang = i_lang-spras
*                    BINARY SEARCH TRANSPORTING NO FIELDS.
*      IF sy-subrc = 0.
*        CLEAR l_index.
*        l_index = sy-tabix.
*        LOOP AT i_codepage INTO wa_codepage FROM l_index.
*          IF wa_codepage-lang NE i_lang-spras.
*            EXIT.
*          ELSE.
*            i_lang_final-codepage = wa_codepage-cpcodepage.
*            APPEND i_lang_final.
*          ENDIF.
*        ENDLOOP.
*      ENDIF.
**      APPEND i_lang_final.
*    ENDIF.
*    APPEND i_lang-spras TO i_spras.
** End of change ** RKUMAR7 **
ENDLOOP.
ENDFORM.                    " SUB_GET_LANG_INFO
*&---------------------------------------------------------------------*
*&      Form  sub_display_info
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_I_FIELDCAT14  text
*      -->P_I_COMPONENT  text
*----------------------------------------------------------------------*
FORM sub_display_info  TABLES
p_data
p_table TYPE slis_t_event
USING
p_fieldcat TYPE slis_t_fieldcat_alv
p_int_tab TYPE slis_tabname
p_formname TYPE slis_formname.

* Start of change by TDEY ----
DATA: l_client_user_disp TYPE char1. " Display client
IF p_int_tab = 'I_CLIENT_USER'.
l_client_user_disp = space.
ELSE.
l_client_user_disp = 'X'.
ENDIF.
* End of change by TDEY ----

WINDOW STARTING AT '0'  '0'
ENDING AT  '100'  '100' .
REFRESH p_fieldcat.
IF p_det = space.
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_INIT'
EXPORTING
i_callback_program = sy-cprog.
ENDIF.
CALL FUNCTION 'REUSE_ALV_FIELDCATALOG_MERGE'
EXPORTING
i_program_name               = sy-cprog
i_internal_tabname           = p_int_tab
*           I_STRUCTURE_NAME             =
* Start of change by TDEY ----
*           I_CLIENT_NEVER_DISPLAY       = 'X'
i_client_never_display       = l_client_user_disp
* End of change by TDEY ----
i_inclname                   = 'Z_IBM_ZZN_DATA_DECL'
*           I_BYPASSING_BUFFER           =
*           I_BUFFER_ACTIVE              =
CHANGING
ct_fieldcat                  = p_fieldcat
EXCEPTIONS
inconsistent_interface       = 1
program_error                = 2
OTHERS                       = 3
.
IF sy-subrc = 0.
IF sy-lisel+9(11) = 'Program Usa' OR
sy-lisel+9(11) = 'Transaction'.
DELETE p_fieldcat WHERE fieldname NE 'ENTRY_ID' AND
fieldname NE 'ACCOUNT'
** Begin of change ** RKUMAR7 **
AND fieldname NE 'COUNT'.
** End of change ** RKUMAR7 **
wa_fieldcat-seltext_l = 'Name'(285).
wa_fieldcat-seltext_m = 'Name'(285).
wa_fieldcat-seltext_s = 'Name'(285).
wa_fieldcat-reptext_ddic = 'Name'(285).
wa_fieldcat-outputlen = 30.
MODIFY  p_fieldcat FROM wa_fieldcat TRANSPORTING seltext_l
seltext_s seltext_m reptext_ddic outputlen
WHERE fieldname = 'ENTRY_ID'.
wa_fieldcat-seltext_l = 'Type'(286).
wa_fieldcat-seltext_m = 'Type'(286).
wa_fieldcat-seltext_s = 'Type'(286).
wa_fieldcat-reptext_ddic = 'Type'(286).
wa_fieldcat-outputlen = 12.
MODIFY  p_fieldcat FROM wa_fieldcat TRANSPORTING seltext_l
seltext_s seltext_m reptext_ddic outputlen
WHERE fieldname = 'ACCOUNT'.
** Begin of change ** RKUMAR7 **
wa_fieldcat-seltext_l = 'Count'(287).
wa_fieldcat-seltext_m = 'Count'(287).
wa_fieldcat-seltext_s = 'Count'(287).
wa_fieldcat-reptext_ddic = 'Count'(287).
wa_fieldcat-outputlen = 8.
MODIFY  p_fieldcat FROM wa_fieldcat TRANSPORTING seltext_l
seltext_s seltext_m reptext_ddic outputlen
WHERE fieldname = 'COUNT'.
** End of change ** RKUMAR7 **
i_events14[] =  i_events16[].

*   Start of change by TDEY ----
ELSEIF  sy-lisel+9(11) = 'No. of Serv'(288).

wa_fieldcat-fieldname = 'TYPE'.
wa_fieldcat-seltext_l = 'Server Type'(289).
APPEND wa_fieldcat TO p_fieldcat.

wa_fieldcat-fieldname = 'NAME'.
wa_fieldcat-seltext_l = 'Server Name'(290).
APPEND wa_fieldcat TO p_fieldcat.

wa_fieldcat-fieldname = 'HOST'.
wa_fieldcat-seltext_l = 'Host'(291).
APPEND wa_fieldcat TO p_fieldcat.

REFRESH p_table.
wa_events-name = slis_ev_top_of_page .
wa_events-form = p_formname.
APPEND wa_events TO p_table.
CLEAR wa_events .

ELSEIF sy-lisel+9(11) = 'No. of User'(292).

wa_fieldcat-col_pos = '5'.
wa_fieldcat-fieldname = 'USTYPTXT'.
wa_fieldcat-tabname = 'I_CLIENT_USER'.
wa_fieldcat-seltext_l = 'User Type Desc'(293).
APPEND wa_fieldcat TO p_fieldcat.

REFRESH p_table.
wa_events-name = slis_ev_top_of_page .
wa_events-form = p_formname.
APPEND wa_events TO p_table.
CLEAR wa_events .
*   End of change by TDEY ----

ELSE.
REFRESH p_table.
wa_events-name = slis_ev_top_of_page .
wa_events-form = p_formname.
APPEND wa_events TO p_table.
CLEAR wa_events .
ENDIF.

ELSE.
MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
ENDIF.

CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = p_fieldcat
i_tabname                  = p_int_tab
it_events                  = i_events14
TABLES
t_outtab                   = p_data
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

wa_print-reserve_lines = 2.
IF p_det = space.
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_DISPLAY'
EXPORTING
is_print = wa_print.
ENDIF.
ENDFORM.                    " sub_display_info
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_TMS_INFO
*&---------------------------------------------------------------------*
* Get TMS info
*----------------------------------------------------------------------*
FORM sub_get_tms_info .

SELECT * FROM tmscsys INTO TABLE i_landscape WHERE
instnr <> space.

ENDFORM.                    " SUB_GET_TMS_INFO
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_HWD_INFO
*&---------------------------------------------------------------------*
* Get Hardware Info
*----------------------------------------------------------------------*
FORM sub_get_hwd_info .

DATA:
l_process TYPE sy-tvar0,
l_memory  TYPE sy-tvar0,
l_disk    TYPE sy-tvar0.

*{   REPLACE        TEDK909196                                        1
*\  CALL FUNCTION 'SCSI_GET_HARDWARE_INFO'
*\    TABLES
*\      info = i_hw_info.
*  CALL FUNCTION 'SCSI_GET_HARDWARE_INFO'
*    TABLES
*      info = i_hw_info.
*}   REPLACE

*{   REPLACE        TEDK909196                                        2
*\  CALL FUNCTION 'SCUI_GET_HARDWARE_DATA'
*\    IMPORTING
*\      ev_proc_nr  = l_process
*\      ev_mem_all  = l_memory
*\      ev_disksize = l_disk.
*\  i_hw_info-descriptor = 'No. Of processor'(294).
*\  i_hw_info-value_1 = l_process.
*\  APPEND i_hw_info.
*\
*\  i_hw_info-descriptor = 'Total memory'(295).
*\  i_hw_info-value_1 = l_memory.
*\  APPEND i_hw_info.
*\
*\  i_hw_info-descriptor = 'Disk Space'(296).
*\  i_hw_info-value_1 = l_disk.
*\  APPEND i_hw_info.
*  CALL FUNCTION 'SCUI_GET_HARDWARE_DATA'
*    IMPORTING
*      ev_proc_nr  = l_process
*      ev_mem_all  = l_memory
*      ev_disksize = l_disk.
*  i_hw_info-descriptor = 'No. Of processor'(294).
*  i_hw_info-value_1 = l_process.
*  APPEND i_hw_info.

*  i_hw_info-descriptor = 'Total memory'(295).
*  i_hw_info-value_1 = l_memory.
*  APPEND i_hw_info.

*  i_hw_info-descriptor = 'Disk Space'(296).
*  i_hw_info-value_1 = l_disk.
*  APPEND i_hw_info.
*}   REPLACE

* Start of change by TDEY ----
PERFORM sub_get_db_space_info.
* End of change by TDEY ----

ENDFORM.                    " SUB_GET_HWD_INFO


*&---------------------------------------------------------------------*
*&      Form  sub_report_heading14
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading14 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Custom Inbound ALE Interfaces'(078).
SKIP.

ENDFORM.                    " sub_report_heading14

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading20
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading20 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Standard Inbound ALE Interfaces'(099).
SKIP.

ENDFORM.                    " sub_report_heading20

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading21
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading21 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Custom Outbound ALE Interfaces'(100).
SKIP.

ENDFORM.                    " sub_report_heading21
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading22
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading22 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Standard Outbound ALE Interfaces'(101).
SKIP.

ENDFORM.                    " sub_report_heading22
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading23
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading23 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'LSMW Objects'(077).
SKIP.

ENDFORM.                    " sub_report_heading23
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading24
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading24 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'SAP Version Information'(108).
SKIP.

ENDFORM.                    " sub_report_heading24
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading25
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading25 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'No. of Installed Languages'(109).
SKIP.

ENDFORM.                    " sub_report_heading25
*&---------------------------------------------------------------------*
*&      Form  sub_report_heading26
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading26 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Landscape Details'(110).
SKIP.

ENDFORM.                    " sub_report_heading26

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading27
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading27 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Hardware Platform'(111).
SKIP.

ENDFORM.                    " sub_report_heading27

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading28
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading28 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Program Usage Statistics'(112).
SKIP.

ENDFORM.                    " sub_report_heading28

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading29
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading29 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Transaction Usage Statistics'(113).
SKIP.

ENDFORM.                    " sub_report_heading29

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading15
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading15 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/ 'Lines in Source Code'(297).


ENDFORM.                    " sub_report_heading15
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_PROG_STAT
*&---------------------------------------------------------------------*
* Get Program Statistics
*----------------------------------------------------------------------*
FORM sub_get_prog_stat .
DATA: r_stat TYPE RANGE OF  sobj_name INITIAL SIZE 0 .
DATA l_date LIKE sy-datum.

** Begin of change ** RKUMAR7 **
DATA: BEGIN OF i_prog_stat_temp OCCURS 0.
INCLUDE STRUCTURE sapwlustcx.
DATA: END OF i_prog_stat_temp.
DATA: l_wa_prog_stat LIKE LINE OF i_prog_stat,
l_prog_prev LIKE LINE OF i_prog_stat,
l_count(8) TYPE c,
l_wa_prog_stat1 LIKE LINE OF i_prog_stat1,
l_wa_tran_stat LIKE LINE OF i_tran_stat2.
DATA: l_loop_count type i.
** End of change ** RKUMAR7 **

r_stat[] = r_object[].
CLEAR wa_object.
wa_object-sign = 'E'.
MODIFY r_stat FROM wa_object TRANSPORTING sign
WHERE sign <> space.

l_date = sy-datum.
CLEAR v_stat_count.
l_loop_count = p_month + 1.
DO l_loop_count TIMES.
REFRESH i_stat.

l_date+6(2) = '01'.
IF sy-index <> 1.
IF l_date+4(2) = '01'.
l_date+0(4) = l_date(4) - 1.
l_date+4(2) = '12'.
ELSE.
l_date+4(2) =  l_date+4(2) - 1.
ENDIF.
ENDIF.


CALL FUNCTION 'SAPWL_WORKLOAD_GET_STATISTIC'
EXPORTING
periodtype                          = 'M'
*      HOSTID                              =
startdate                           = l_date
*      ONLY_APPLICATION_STATISTIC          = ' '
instance                            = 'TOTAL'
*    IMPORTING
*      SPOOL_PRINT_STATISTIC               =
TABLES
application_statistic                = i_stat
EXCEPTIONS
unknown_periodtype                  = 1
no_data_found                       = 2
no_server_given                     = 3
OTHERS                              = 4
.
IF sy-subrc = 0.
IF NOT i_stat[] IS INITIAL.
v_stat_count = v_stat_count + 1.
ENDIF.

APPEND LINES OF i_stat TO i_prog_stat.
DELETE i_prog_stat WHERE entry_id IN r_stat.
DELETE i_prog_stat WHERE entry_id+72(1) NE 'R'.

APPEND LINES OF i_stat TO i_tran_stat.
DELETE i_tran_stat WHERE entry_id IN r_stat.
DELETE i_tran_stat WHERE entry_id+72(1) NE 'T'.


ENDIF.
ENDDO.
IF p_pghis = 'X'.
** Begin of change ** RKUMAR7 **
i_prog_stat_temp[] = i_prog_stat[].
SORT i_prog_stat_temp BY entry_id ASCENDING.
i_prog_stat_temp-account = 'Program'.
MODIFY i_prog_stat_temp TRANSPORTING  account WHERE
account <> 'Program'.
LOOP AT i_prog_stat_temp INTO l_wa_prog_stat.
IF NOT l_prog_prev-entry_id IS INITIAL.
IF l_prog_prev-entry_id+0(30) NE l_wa_prog_stat-entry_id+0(30).
l_wa_prog_stat1-ttype = l_prog_prev-ttype.
l_wa_prog_stat1-account = l_prog_prev-account.
l_wa_prog_stat1-entry_id = l_prog_prev-entry_id+0(30).
l_wa_prog_stat1-count = l_count.
APPEND l_wa_prog_stat1 TO i_prog_stat1.
CLEAR: l_count,l_wa_prog_stat1.
ENDIF.
ENDIF.
l_count = l_wa_prog_stat-count + l_count.
l_prog_prev =  l_wa_prog_stat.
ENDLOOP.

* For the last entry
*{   REPLACE        DEVK901208                                        1
*\    IF l_prog_prev IS NOT INITIAL.
IF NOT l_prog_prev IS INITIAL.
*}   REPLACE
l_wa_prog_stat1-ttype = l_prog_prev-ttype.
l_wa_prog_stat1-account = l_prog_prev-account.
l_wa_prog_stat1-entry_id = l_prog_prev-entry_id+0(30).
l_wa_prog_stat1-count = l_count.
APPEND l_wa_prog_stat1 TO i_prog_stat1.
CLEAR: l_count,l_prog_prev,l_wa_prog_stat1.
ENDIF.
*    APPEND LINES OF  i_prog_stat TO i_prog_stat1.
*    SORT i_prog_stat1 BY entry_id ASCENDING.
*    DELETE ADJACENT DUPLICATES FROM i_prog_stat1 COMPARING entry_id.
*    i_prog_stat1-account = 'Program'.
*    MODIFY i_prog_stat1 TRANSPORTING account WHERE account <>
*'Program'.
** End of change ** RKUMAR7 **
ENDIF.
IF p_dbhis = 'X'.
** Begin of change ** RKUMAR7 **
REFRESH i_prog_stat_temp.

i_prog_stat_temp[] = i_tran_stat[].
SORT i_prog_stat_temp BY entry_id ASCENDING.
i_prog_stat_temp-account = 'Transaction'.
MODIFY i_prog_stat_temp TRANSPORTING  account WHERE
account <> 'Transaction'.
LOOP AT i_prog_stat_temp INTO l_wa_prog_stat.
IF NOT l_prog_prev-entry_id IS INITIAL.
IF l_prog_prev-entry_id+0(20) NE l_wa_prog_stat-entry_id+0(20).
l_wa_tran_stat-ttype = l_prog_prev-ttype.
l_wa_tran_stat-account = l_prog_prev-account.
l_wa_tran_stat-entry_id = l_prog_prev-entry_id+0(20).
l_wa_tran_stat-count = l_count.
APPEND  l_wa_tran_stat TO i_tran_stat2.
CLEAR: l_count, l_wa_tran_stat.
ENDIF.
ENDIF.
l_count = l_wa_prog_stat-count + l_count.
l_prog_prev =  l_wa_prog_stat.
ENDLOOP.

* For the last entry
*{   REPLACE        DEVK901208                                        2
*\    IF l_prog_prev IS NOT INITIAL.
IF NOT l_prog_prev IS INITIAL.
*}   REPLACE
l_wa_tran_stat-ttype = l_prog_prev-ttype.
l_wa_tran_stat-account = l_prog_prev-account.
l_wa_tran_stat-entry_id = l_prog_prev-entry_id+0(20).
l_wa_tran_stat-count = l_count.
APPEND  l_wa_tran_stat TO i_tran_stat2.
CLEAR: l_count,l_prog_prev,  l_wa_tran_stat.
ENDIF.


*    APPEND LINES OF i_tran_stat TO i_tran_stat2.
*    SORT i_tran_stat2 BY entry_id ASCENDING.
*    DELETE ADJACENT DUPLICATES FROM i_tran_stat2 COMPARING entry_id.
*
*    i_tran_stat2-account = 'Transaction'.
*  MODIFY i_tran_stat2 TRANSPORTING account WHERE account <>
*'Transaction'
*  .
** End of change ** RKUMAR7 **
*    IF p_det = 'X'.
*      APPEND LINES OF i_tran_stat2 TO i_prog_stat1.
*    ENDIF.
ENDIF.


ENDFORM.                    " SUB_GET_PROG_STAT


*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading16 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/ 'Program/Transaction usage statistics in last '(298),
v_stat_count LEFT-JUSTIFIED,
49 'months'(299).


ENDFORM.                    " sub_report_heading9

*&---------------------------------------------------------------------*
*&      Form  sub_report_heading
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading17 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/ 'Program/Transaction usage statistics in last '(300),
v_stat_count LEFT-JUSTIFIED,
49 'months'(299).


ENDFORM.                    " sub_report_heading9
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_ALE_INFO
*&---------------------------------------------------------------------*
* Get ALE Interfaces
*----------------------------------------------------------------------*
FORM sub_get_ale_info .

* Out bound for custom
SELECT mestyp idoctyp FROM edp13 INTO TABLE i_ale_outbound.
SORT i_ale_outbound BY mestyp idoctyp.
DELETE ADJACENT DUPLICATES FROM i_ale_outbound COMPARING mestyp
idoctyp.

i_ale_std_outbound[] = i_ale_outbound[].

DELETE i_ale_outbound WHERE NOT idoctyp IN r_object.


* Out bound for standard

DELETE i_ale_std_outbound WHERE idoctyp IN r_object.

* In bound for custom
SELECT mestyp evcode FROM edp21 INTO TABLE i_ale_inbound.
SORT i_ale_inbound BY mestyp evcode.
DELETE ADJACENT DUPLICATES FROM i_ale_inbound COMPARING mestyp evcode.

IF NOT i_ale_inbound[] IS INITIAL.

SELECT evcode funcname FROM tbd52 INTO TABLE i_tbd_inbound
FOR ALL ENTRIES IN i_ale_inbound WHERE evcode = i_ale_inbound-evcode
.
ENDIF.

LOOP AT i_ale_inbound INTO wa_ale_inbound .
READ TABLE i_tbd_inbound INTO wa_tbd_inbound
WITH KEY evcode = wa_ale_inbound-evcode.

IF sy-subrc EQ 0.
wa_ale_inbound-funcname = wa_tbd_inbound-funcname.
MODIFY i_ale_inbound FROM wa_ale_inbound TRANSPORTING funcname.
ENDIF.

ENDLOOP.

i_ale_std_inbound[] = i_ale_inbound[].

DELETE i_ale_inbound WHERE NOT funcname IN r_object.

* In bound for standard

DELETE i_ale_std_inbound WHERE funcname IN r_object.

ENDFORM.                    " SUB_GET_ALE_INFO
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_LSMW_INFO
*&---------------------------------------------------------------------*
* Get LSMW Objects
*----------------------------------------------------------------------*
FORM sub_get_lsmw_info .

DATA: v_tabname   TYPE char30,
v_tabname_con   TYPE char30.


v_tabname_con = '/SAPDMC/LSOATT'.

SELECT SINGLE tabname INTO v_tabname FROM dd02l
WHERE tabname = v_tabname_con.

IF sy-subrc EQ 0.
SELECT * FROM (v_tabname_con) INTO TABLE i_lsmw_objects.
ENDIF.


ENDFORM.                    " SUB_GET_LSMW_INFO
*&---------------------------------------------------------------------*
*&      Form  sub_get_details_estm_report
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_details_estm_report .

PERFORM sub_get_reports.

PERFORM sub_get_enhancements.

PERFORM sub_get_tcodes.

PERFORM sub_get_ale_interfaces.

PERFORM sub_get_function_modules.

*  PERFORM sub_get_sapscripts.

PERFORM sub_get_smartforms.

PERFORM sub_get_modification.

PERFORM sub_get_workflow.

ENDFORM.                    " sub_get_details_estm_report
*&---------------------------------------------------------------------*
*&      Form  sub_get_reports
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_reports .
*  DATA: BEGIN OF i_reports OCCURS 0,
*          name TYPE progname,
*        END OF i_reports.
SELECT name FROM trdir
INTO TABLE i_reports
WHERE name IN r_object
AND subc = '1'.


ENDFORM.                    " sub_get_reports
*&---------------------------------------------------------------------*
*&      Form  sub_get_enhancements
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_enhancements .
PERFORM sub_get_function_exit.
PERFORM sub_get_user_exit_sd.
PERFORM sub_get_vofm.
PERFORM sub_get_fi_validation.
PERFORM sub_get_badi.
PERFORM sub_get_bte.

ENDFORM.                    " sub_get_enhancements
*&---------------------------------------------------------------------*
*&      Form  sub_get_tcodes
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_tcodes .
DATA: i_trans TYPE STANDARD TABLE OF tstc INITIAL SIZE 0.

SELECT * FROM tstc INTO TABLE i_trans WHERE tcode IN r_object
AND cinfo = '00'.

ENDFORM.                    " sub_get_tcodes
*&---------------------------------------------------------------------*
*&      Form  sub_get_ale_interfaces
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_ale_interfaces .
PERFORM sub_get_ale_info.
ENDFORM.                    " sub_get_ale_interfaces
*&---------------------------------------------------------------------*
*&      Form  sub_get_function_modules
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_function_modules .
DATA i_func TYPE STANDARD TABLE OF info_func INITIAL SIZE 0 WITH
HEADER LINE.
SELECT * FROM info_func INTO TABLE i_func WHERE funcname IN r_object
AND area IN r_object
AND devclass IN s_pack.
ENDFORM.                    " sub_get_function_modules
*&---------------------------------------------------------------------*
*&      Form  sub_get_sapscripts
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sform_cnt .
SELECT obj_name
object
FROM tadir
APPENDING TABLE i_list_final
WHERE pgmid EQ 'R3TR'
AND object EQ 'FORM'
AND devclass IN s_pack
AND   obj_name IN r_object .



ENDFORM.                    " sub_get_sapscripts
*&---------------------------------------------------------------------*
*&      Form  sub_get_smartforms
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_smartforms .
SELECT obj_name
object
FROM tadir INNER JOIN stxfadm
ON tadir~obj_name = stxfadm~formname
APPENDING table i_list_final
WHERE pgmid EQ 'R3TR'
AND object EQ 'SSFO'
AND tadir~devclass IN s_pack
AND   obj_name IN r_object
AND  formtype EQ space.
ENDFORM.                    " sub_get_smartforms
*&---------------------------------------------------------------------*
*&      Form  sub_get_modification
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_modification .

PERFORM sub_check_std_code .

ENDFORM.                    " sub_get_modification
*&---------------------------------------------------------------------*
*&      Form  sub_get_workflow
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_workflow .

*Begin of change by Rudra R
DATA :  x_time TYPE swr_timint,
*          l_past_date TYPE sydatum,
lt_workitem_filter TYPE STANDARD TABLE OF swr_witype
INITIAL SIZE 0,
lwa_workitem_filter LIKE LINE OF lt_workitem_filter.
*End of change by Rudra R

CALL FUNCTION 'RH_CHECK_HRS_MACO'
EXPORTING
*   ACT_LANGU            = SY-LANGU
*   ACT_LIMIT            = 0
act_otype            = 'WS'
*   ACT_SEARCH           = '*'
*   ACT_LANGU_MODE       =
TABLES
act_hrs_data         = i_wflow
* EXCEPTIONS
*   NO_DATA_FOUND        = 1
*   OTHERS               = 2
.
IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
ENDIF.

CALL FUNCTION 'RH_CHECK_HRS_MACO'
EXPORTING
*   ACT_LANGU            = SY-LANGU
*   ACT_LIMIT            = 0
act_otype            = 'TS'
*   ACT_SEARCH           = '*'
*   ACT_LANGU_MODE       =
TABLES
act_hrs_data         = i_wflow_ts
* EXCEPTIONS
*   NO_DATA_FOUND        = 1
*   OTHERS               = 2
.
IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
ENDIF.


APPEND LINES OF i_wflow_ts TO i_wflow.

SORT i_wflow BY otype objid.

i_std_wflow[] = i_wflow[].

DELETE i_std_wflow WHERE objid > 89999999.

DELETE i_wflow WHERE objid < 89999999.

*Begin of change by Rudra R

** Get the past date based on selection
*  CALL FUNCTION 'CCM_GO_BACK_MONTHS'
*    EXPORTING
*      currdate   = sy-datum
*      backmonths = p_month
*    IMPORTING
*      newdate    = l_past_date.

* Populate the time filter
* As the selection of Workflows are not based on any timeframe
* we cannot go for a time based selection. We might need to revisit
* this in future as it may cause performance problem
*  x_time-sign = 'I'.
*  x_time-option = 'BT'.
*  x_time-low = '19010101'.
*  x_time-high = sy-datum.

****Now the selection is based on date range input in the selection
***Screen
x_time-sign = 'I'.
x_time-option = 'BT'.
IF p_date-low IS INITIAL.
x_time-low = '19010101'.
ELSE.
x_time-low = p_date-low.
ENDIF.
IF p_date-high IS INITIAL.
x_time-high = sy-datum.
ELSE.
x_time-high = p_date-high.
ENDIF.


* Populate the task type filter
* Could have gone for small subroutine, But we will have
* only 3 records as filters
lwa_workitem_filter-wi_type = 'W'.
APPEND lwa_workitem_filter TO lt_workitem_filter.

lwa_workitem_filter-wi_type = 'B'.
APPEND lwa_workitem_filter TO lt_workitem_filter.

lwa_workitem_filter-wi_type = 'F'.
APPEND lwa_workitem_filter TO lt_workitem_filter.

* Get the workflow count using standard FM
CALL FUNCTION 'SAP_WAPI_WORKITEMS_BY_FREQUENC'
EXPORTING
time                           = x_time
selection_status_variant       = 0000
*   TEXT                           =
*   LANGUAGE                       = SY-LANGU
*   USER                           = SY-UNAME
* IMPORTING
*   RETURN_CODE                    =
TABLES
workitem_type_filter           = lt_workitem_filter
*   TASK_FILTER                    =
*   WORKLIST                       =
worklist_compact               = i_worklist_compact
*   MESSAGE_LINES                  =
*   MESSAGE_STRUCT                 =
.

SORT i_worklist_compact BY wi_rh_task ASCENDING.

*End of change by Rudra R
ENDFORM.                    " sub_get_workflow
*&---------------------------------------------------------------------*
*&      Form  sub_get_function_exit
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_function_exit .

SELECT modsap~name
modsap~member
modact~name
tadir~devclass
FROM modsap INNER JOIN modact
ON modsap~name = modact~member
INNER JOIN tadir
ON modact~name = tadir~obj_name
INTO TABLE i_exit
WHERE ( modsap~typ = 'E' OR
modsap~typ = 'S' )
AND tadir~pgmid = 'R3TR'
AND tadir~object = 'CMOD'.

ENDFORM.                    " sub_get_function_exit
*&---------------------------------------------------------------------*
*&      Form  sub_get_user_exit_sd
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_user_exit_sd .

SELECT obj_name FROM tadir
INTO TABLE i_tadir_sd
WHERE pgmid = 'R3TR'
AND object = 'PROG'
AND devclass = 'VMOD'.

IF NOT i_tadir_sd[] IS INITIAL.

SELECT  obj_name int_name
FROM smodilog
INTO TABLE i_uexit_sd
FOR ALL ENTRIES IN i_tadir_sd
WHERE obj_name = i_tadir_sd-obj_name
AND obj_type = 'PROG'
AND sub_type = 'REPS'
AND int_type ='PU'.

ENDIF.

ENDFORM.                    " sub_get_user_exit_sd
*&---------------------------------------------------------------------*
*&      Form  sub_get_vofm
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_vofm .

SELECT grpze
grpno
kappl
FROM tfrm
INTO TABLE i_tfrm
WHERE aktiv = 'X'
AND grpno >= 900.

IF sy-subrc EQ 0.

SELECT grpze
grpno
bezei
FROM tfrmt
INTO CORRESPONDING FIELDS OF TABLE i_vofm
FOR ALL ENTRIES IN i_tfrm
WHERE grpze = i_tfrm-grpze
AND grpno = i_tfrm-grpno
AND spras = sy-langu.

IF sy-subrc EQ 0.

CALL FUNCTION 'RPY_DOMAIN_READ'
EXPORTING
activation_type_i       = 'M'
doma_name               = 'GRPZE'
language                = sy-langu
with_docu               = ' '
docutype                = 'U'
*   IMPORTING
*     DOMA_INF                =
*     ACTIVATION_TYPE_O       =
TABLES
doma_values             = i_domaread
*     DOCU_TABLE_USER         =
*     DOCU_TABLE_TECH         =
*   EXCEPTIONS
*     CANCELLED               = 1
*     NOT_FOUND               = 2
*     PERMISSION_ERROR        = 3
*     ILLEGAL_TYPE            = 4
*     OTHERS                  = 5
.
IF sy-subrc <> 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
ENDIF.



LOOP AT i_vofm INTO wa_vofm .

*get kappl
READ TABLE i_tfrm INTO wa_tfrm
WITH KEY grpze = wa_vofm-grpze grpno = wa_vofm-grpno.

IF sy-subrc EQ 0.
wa_vofm-kappl = wa_tfrm-kappl.
MODIFY i_vofm FROM wa_vofm TRANSPORTING kappl.
ENDIF.


*get the text for grpze
READ TABLE i_domaread INTO wa_domaread
WITH KEY domvalue_l = wa_vofm-grpze.

IF sy-subrc EQ 0.
wa_vofm-ddtext = wa_domaread-ddtext.
MODIFY i_vofm FROM wa_vofm TRANSPORTING ddtext.
ENDIF.


ENDLOOP.


ENDIF.

ENDIF.

ENDFORM.                    " sub_get_vofm
*&---------------------------------------------------------------------*
*&      Form  sub_get_fi_validation
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_fi_validation .

ENDFORM.                    " sub_get_fi_validation
*&---------------------------------------------------------------------*
*&      Form  sub_get_badi
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_badi .


SELECT imp_name exit_name devclass
INTO TABLE i_badi
FROM sxc_exit INNER JOIN tadir
ON sxc_exit~imp_name = tadir~obj_name
WHERE sxc_exit~imp_name IN r_object
AND  pgmid EQ 'R3TR'
AND  object EQ 'SXCI'
AND  devclass IN s_pack.

IF sy-subrc EQ 0.
SORT i_badi BY imp_name exit_name.
DELETE ADJACENT DUPLICATES
FROM i_badi COMPARING imp_name exit_name.
ENDIF.


ENDFORM.                    " sub_get_badi
*&---------------------------------------------------------------------*
*&      Form  sub_get_bte
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_bte .

PERFORM get_bte_event.
PERFORM get_bte_process.

i_bte[] = gt_ilist[].


DELETE i_bte WHERE NOT stdfb IN r_object.

ENDFORM.                    " sub_get_bte
*&---------------------------------------------------------------------*
*&      Form  SUB_REP_STD_IND
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_rep_std_ind .

REFRESH i_fieldcat6[] .

* prepare field catalog
* build field catalog for 4th block
PERFORM sub_prep_fcatalog_index .


* for index
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat6
i_tabname                  = 'I_STD_INDEX'
it_events                  = i_events6
TABLES
t_outtab                   = i_std_index
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.



ENDFORM.                    " SUB_REP_STD_IND
*&---------------------------------------------------------------------*
*&      Form  SUB_REP_STD_VAR
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_rep_std_var .

REFRESH i_fieldcat8[] .

* prepare field catalog
* build field catalog for 5th block
PERFORM sub_prep_fcatalog_varnt.


* for variants
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat8
i_tabname                  = 'I_STD_VARID'
it_events                  = i_events8
TABLES
t_outtab                   = i_std_varid
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " SUB_REP_STD_VAR
*&---------------------------------------------------------------------*
*&      Form  SUB_ESTIMATE_REPORT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_estimate_report .

DATA : l_count TYPE i .
DATA : otherobj_cnt  TYPE i .
DATA : mpool_cnt TYPE i .
DATA : fmodule_cnt TYPE i .
DATA : sform_cnt TYPE i .
DATA : sscript_cnt TYPE i .
DATA : rprog_cnt TYPE i .
DATA : clas_cnt TYPE i .
DATA : shelp_cnt TYPE i .
DATA : tran_cnt TYPE i .
DATA : include_cnt TYPE i .
DATA : enhmt_cnt TYPE i .
DATA : dtel_cnt TYPE i .
DATA : doma_cnt TYPE i .
DATA : view_cnt TYPE i .
DATA : tabl_cnt TYPE i .
DATA : stru_cnt TYPE i .
DATA : ttyp_cnt TYPE i .
DATA : index_cnt TYPE i .
DATA : query_cnt TYPE i .
DATA : area_cnt TYPE i .
DATA : alein_cnt TYPE i .
DATA : aleout_cnt TYPE i .
** Begin of change ** RKUMAR7 ** 23.10.2009 10:03:24
DATA : vw_tmg_cnt TYPE i,
tbl_tmg_cnt TYPE i,
l_i_view_details TYPE STANDARD TABLE OF
zibm_table_structure  INITIAL SIZE 0,
l_i_tabl_details TYPE STANDARD TABLE OF
zibm_table_structure  INITIAL SIZE 0,
l_wa_index TYPE x_index.
** End of change ** RKUMAR7 ** 23.10.2009 10:03:30
DATA : exit_cnt TYPE i .
DATA : vofm_cnt TYPE i .
DATA : bte_cnt TYPE i .
DATA : badi_cnt TYPE i .
DATA : uexit_sd_cnt TYPE i .


PERFORM sub_populate_events .


i_list_final_est[] = i_list_final[].

LOOP AT i_list_final_est INTO wa_list_final_est .

IF wa_list_final_est-object_type = 'DTEL' .
dtel_cnt = dtel_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'DOMA' .
doma_cnt = doma_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'VIEW' .
view_cnt = view_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'TABL' .
tabl_cnt = tabl_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'MPROG' .
mpool_cnt = mpool_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'FUNC' .
fmodule_cnt = fmodule_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'SSFO' .
sform_cnt = sform_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'RPROG' .
rprog_cnt = rprog_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'SHLP' .
shelp_cnt = shelp_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'CLAS' .
clas_cnt = clas_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'TRAN' .
tran_cnt = tran_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'IPROG' .
include_cnt = include_cnt + 1.
*      ELSEIF wa_list_final_est-object_type = 'CMOD' .
*        enhmt_cnt = enhmt_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'FORM' .
sscript_cnt = sscript_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'STRU' .
stru_cnt = stru_cnt + 1.
ELSEIF wa_list_final_est-object_type = 'TTYP' .
ttyp_cnt = ttyp_cnt + 1.
ENDIF.

CLEAR wa_list_final_est .

ENDLOOP.


*  for reports
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category = 'Reports :'(087).
wa_summ-number = rprog_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .


*  for Other Objects
** Begin of change ** RKUMAR7 ** 23.10.2009 10:02:20
l_i_view_details[] = i_view_details[].
l_i_tabl_details[] = i_tabl_details[].
DELETE l_i_view_details WHERE area EQ space.
DELETE l_i_tabl_details WHERE area EQ space.
*  CLEAR index_cnt.
*  LOOP AT i_std_index INTO l_wa_index.
*    IF l_wa_index-indexname IN r_object.
*      index_cnt = index_cnt + 1.
*    ENDIF.
*  ENDLOOP.

DESCRIBE TABLE l_i_view_details  LINES vw_tmg_cnt .
DESCRIBE TABLE l_i_tabl_details  LINES tbl_tmg_cnt .
** End of change ** RKUMAR7 ** 23.10.2009 10:02:15
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Other Objects*'(086).
** Begin of change ** Anjan ** 23.10.2009 10:02:20
*  DESCRIBE TABLE i_index LINES index_cnt .
DESCRIBE TABLE i_std_index LINES index_cnt .
** End of change ** Anjan ** 23.10.2009 10:02:20

*  DESCRIBE TABLE i_query LINES query_cnt .
DESCRIBE TABLE i_area  LINES area_cnt .
otherobj_cnt = index_cnt + area_cnt + clas_cnt + shelp_cnt
+ vw_tmg_cnt + tbl_tmg_cnt.
wa_summ-number = otherobj_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

*  for ALE Report
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'ALE Interfaces'(076).
DESCRIBE TABLE i_ale_inbound LINES alein_cnt .
DESCRIBE TABLE i_ale_outbound LINES aleout_cnt .
wa_summ-number = alein_cnt + aleout_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .


*    for Custom development (data element,domain,tables,structure,view)


l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Custom Data Dictionary Objects**'(088).
wa_summ-number = dtel_cnt + doma_cnt + view_cnt + tabl_cnt +
stru_cnt + ttyp_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

*    for Module Pool

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Module Pool Program'(089).
wa_summ-number = mpool_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

*    for Function Module

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Function Module'(090).
wa_summ-number = fmodule_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .


*    for Smart Form

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Smart Form'(091).
wa_summ-number = sform_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .


**    for Transactions
*
*    l_count = l_count + 1 .
*    wa_summ-line = l_count .
*    wa_summ-category =  'Transactions'(093).
*    wa_summ-number = tran_cnt.
*    APPEND wa_summ TO i_summ .
*    CLEAR wa_summ .


*    for Include Program

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Include Program'(094).
wa_summ-number = include_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .


*    for Enhancement Project

l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Enhancements ***'(138).
DESCRIBE TABLE i_exit LINES exit_cnt .
DESCRIBE TABLE i_vofm LINES vofm_cnt .
DESCRIBE TABLE i_bte LINES bte_cnt .
DESCRIBE TABLE i_uexit_sd LINES uexit_sd_cnt .
DESCRIBE TABLE i_badi LINES badi_cnt .
enhmt_cnt = exit_cnt + vofm_cnt + bte_cnt + uexit_sd_cnt + badi_cnt.
wa_summ-number = enhmt_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ .



*  for Modification
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'Modification'(096).
DESCRIBE TABLE i_adir LINES wa_summ-number .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

*  for LSMW
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'LSMW Objects'(097).
DESCRIBE TABLE i_lsmw_objects LINES wa_summ-number .
APPEND wa_summ TO i_summ .
CLEAR wa_summ .

*  for SAP Script
l_count = l_count + 1 .
wa_summ-line = l_count .
wa_summ-category =  'SAP Script Form'(092).
wa_summ-number = sscript_cnt.
APPEND wa_summ TO i_summ .
CLEAR wa_summ.


PERFORM sub_write_report .

*  PERFORM sub_get_print_release.

WRITE '*   AreaMenu, Search help, TMG, Class,'(301).
WRITE 'Index on std. tables.'(150).
WRITE '**  Custom DataElement, Domain, Table, View, Structure,'(302).
WRITE 'TableType.'(303).
WRITE
'*** Function Exits, VOFM Routine, BTE, Sales User Exit, BADI.'(304).


ENDFORM.                    " SUB_ESTIMATE_REPORT
*&---------------------------------------------------------------------*
*&      Form  CUS_DEV_MPOOL
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM cus_dev_mpool .

***>>>Begin of change by Rudra R
*****Logic has been changed to incorporate MOD pool
*****Based on Namespace entered in the selection screen
*****Not based on transaction code.
*  SELECT pgmna tcode
*  FROM tstc
*  INTO TABLE i_tstc_mpool
*  WHERE cinfo = '00' AND tcode IN r_object.
*
*  IF sy-subrc EQ 0.
***>>>End of change by Rudra R
SELECT b~obj_name b~devclass
FROM trdir AS a INNER JOIN tadir AS b
ON a~name EQ b~obj_name
INTO TABLE i_mpool
***>>>Begin of change by Rudra R
*    FOR ALL ENTRIES IN i_tstc_mpool
***>>>End of change by Rudra R
WHERE a~subc = 'M'
AND b~pgmid = 'R3TR'
AND b~object = 'PROG'
***>>>Begin of change by Rudra R
*    AND b~obj_name = i_tstc_mpool-pgmna
AND b~obj_name IN r_object
***>>>End of change by Rudra R

AND b~devclass IN s_pack.

IF sy-subrc EQ 0.

LOOP AT i_mpool INTO wa_mpool.

wa_list_final-object_id   = wa_mpool-obj_name.
wa_list_final-object_type = 'MPROG'.
wa_list_final-devclass = wa_mpool-devclass.

APPEND wa_list_final TO i_list_final.
CLEAR wa_list_final.

ENDLOOP.

ENDIF.

***>>>Begin of change by Rudra R
*  ENDIF.
***>>>End of change by Rudra R
ENDFORM.                    " CUS_DEV_MPOOL

*&---------------------------------------------------------------------*
*&      Form  sub_display_fexit
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_display_fexit.

REFRESH i_fieldcat19[] .

* prepare field catalog
PERFORM sub_prep_fcatalog_fexit.

* for f_exit
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat19
i_tabname                  = 'I_EXIT'
it_events                  = i_events19
TABLES
t_outtab                   = i_exit
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " sub_display_fexit
*&---------------------------------------------------------------------*
*&      Form  SUB_DISPLAY_VOFM
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_display_vofm .
REFRESH i_fieldcat20[] .

* prepare field catalog
PERFORM sub_prep_fcatalog_vofm.

* for f_exit
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat20
i_tabname                  = 'I_VOFM'
it_events                  = i_events20
TABLES
t_outtab                   = i_vofm
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " SUB_DISPLAY_VOFM

*&---------------------------------------------------------------------*
*&      Form  SUB_DISPLAY_BADI
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_display_badi .
REFRESH i_fieldcat23[] .

* prepare field catalog
PERFORM sub_prep_fcatalog_badi.

* for f_exit
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat23
i_tabname                  = 'I_BADI'
it_events                  = i_events23
TABLES
t_outtab                   = i_badi
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " SUB_DISPLAY_BADI
*&---------------------------------------------------------------------*
*&      Form  SUB_DISPLAY_BTE
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_display_bte .
REFRESH i_fieldcat21[] .

* prepare field catalog
PERFORM sub_prep_fcatalog_bte.

* for f_exit
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat21
i_tabname                  = 'I_BTE'
it_events                  = i_events21
TABLES
t_outtab                   = i_bte
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " SUB_DISPLAY_BTE


*&---------------------------------------------------------------------*
*&      Form  sub_display_wflow
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_display_wflow.


*Begin of change by Rudra R
DATA : l_wa_wflow TYPE x_wflow,
l_task TYPE sww_task,
lwa_worklist TYPE swr_freq.

LOOP AT i_wflow INTO l_wa_wflow.

i_cust_wflow-otype = l_wa_wflow-otype .
i_cust_wflow-objid = l_wa_wflow-objid .
i_cust_wflow-stext = l_wa_wflow-stext  .

CONCATENATE i_cust_wflow-otype i_cust_wflow-objid
INTO l_task.
READ TABLE i_worklist_compact INTO lwa_worklist
WITH KEY wi_rh_task = l_task
BINARY SEARCH.
IF sy-subrc = 0.
i_cust_wflow-count = lwa_worklist-wi_count.
SHIFT i_cust_wflow-count LEFT DELETING LEADING space.
ELSE.
i_cust_wflow-count = '0'.
ENDIF.
APPEND i_cust_wflow.
CLEAR i_cust_wflow.
ENDLOOP.

FREE : i_worklist_compact,i_wflow.
*End of change by Rudra R

REFRESH i_fieldcat24[] .

* prepare field catalog
PERFORM sub_prep_fcatalog_wflow.

*Begin of change by Rudra R

** for f_exit
*  CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
*    EXPORTING
*      is_layout                  = wa_fieldlayout
*      it_fieldcat                = i_fieldcat24
*      i_tabname                  = 'I_WFLOW'
*      it_events                  = i_events24
*    TABLES
*      t_outtab                   = i_wflow
*    EXCEPTIONS
*      program_error              = 1
*      maximum_of_appends_reached = 2
*      OTHERS                     = 3.
* for f_exit
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat24
i_tabname                  = 'I_CUST_WFLOW'
it_events                  = i_events24
TABLES
t_outtab                   = i_cust_wflow
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
*End of change by Rudra R

IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " sub_display_wflow


*&---------------------------------------------------------------------*
*&      Form  sub_display_std_wflow
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM sub_display_std_wflow.

*Begin of change by Rudra R

DATA : l_wa_wflow TYPE x_wflow,
l_task TYPE sww_task,
lwa_worklist TYPE swr_freq.

LOOP AT i_std_wflow INTO l_wa_wflow.

i_l_std_wflow-otype = l_wa_wflow-otype  .
i_l_std_wflow-objid = l_wa_wflow-objid  .
i_l_std_wflow-stext = l_wa_wflow-stext  .

CONCATENATE i_l_std_wflow-otype i_l_std_wflow-objid
INTO l_task.
*   Go for Binary serach as the table is already sorted
READ TABLE i_worklist_compact INTO lwa_worklist
WITH KEY wi_rh_task = l_task
BINARY SEARCH.
IF sy-subrc = 0.
i_l_std_wflow-count = lwa_worklist-wi_count.
SHIFT i_l_std_wflow-count LEFT DELETING LEADING space.
ELSE.
i_l_std_wflow-count = '0'.
ENDIF.
APPEND i_l_std_wflow.
CLEAR i_l_std_wflow.

ENDLOOP.

*End of change by Rudra R

REFRESH i_fieldcat24[] .

* prepare field catalog
*Begin of change by Rudra R
*  PERFORM sub_prep_fcatalog_wflow.
PERFORM sub_prep_fcatalog_wflow_std.

* for f_exit
*  CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
*    EXPORTING
*      is_layout                  = wa_fieldlayout
*      it_fieldcat                = i_fieldcat24
*      i_tabname                  = 'I_WFLOW'
*      it_events                  = i_events24
*    TABLES
*      t_outtab                   = i_std_wflow
*    EXCEPTIONS
*      program_error              = 1
*      maximum_of_appends_reached = 2
*      OTHERS                     = 3.
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat24
i_tabname                  = 'I_L_STD_WFLOW'
it_events                  = i_events24
TABLES
t_outtab                   = i_l_std_wflow
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
*End of change by Rudra R

IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " sub_display_std_wflow
*&---------------------------------------------------------------------*
*&      Form  GET_BTE_EVENT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM get_bte_event .

DATA: counter     TYPE i,
i           TYPE i,
fieldname   LIKE dynpread-fieldname,
fieldvalue  LIKE dynpread-fieldvalue,
found(1)    TYPE c,
funct       LIKE tfdir-funcname,
keyrange(24),
line        TYPE i,
object      LIKE dokhl-object,
progname    LIKE rs38m-programm,
rcode       LIKE sy-subrc,
sel_appl    LIKE df14l-ps_posid,
sel_val     LIKE help_info-fldvalue,
string(132) TYPE c,
tabix       LIKE sy-tabix,
ucomm_old   LIKE sy-ucomm,
version     LIKE doktl-dokversion,
xfeld.

SELECT  * FROM  tbe01 INTO TABLE itbe01.

SELECT  * FROM  tbe01t INTO TABLE itbe01t
WHERE  spras = sy-langu.


SELECT  * FROM  tbe02 INTO TABLE itbe02
WHERE  attr_type = 'A'.


LOOP AT itbe02.
*    MOVE-CORRESPONDING TBE02 TO ILIST.
READ TABLE itbe01t WITH KEY event = itbe02-event.
*                                SPRAS = SY-LANGU.
IF sy-subrc = 0.
ilist-event = itbe02-event.
ilist-text1 = itbe01t-text1.
ilist-text2 = itbe01t-text2.
ENDIF.
READ TABLE itbe01 WITH KEY event = itbe02-event.
IF sy-subrc = 0.
ilist-xlbse = itbe01-xlbse.
ELSE.
CLEAR ilist-xlbse.
ENDIF.
APPEND ilist.
ENDLOOP.



SORT ilist BY event.
DELETE ADJACENT DUPLICATES FROM ilist COMPARING event.

LOOP AT ilist.
IF ilist-xlbse IS INITIAL.
CALL FUNCTION 'BF_FUNCTIONS_FIND'
EXPORTING
i_event       = ilist-event
TABLES
t_fmrfc       = fmtab[]
EXCEPTIONS
nothing_found = 4
OTHERS        = 8.

IF NOT fmtab[] IS INITIAL.
LOOP AT fmtab.
gt_ilist-event = ilist-event.
gt_ilist-text1 = ilist-text1.
gt_ilist-text2 = ilist-text2.
gt_ilist-stdfb = fmtab-funct.
APPEND gt_ilist.
ENDLOOP.
REFRESH fmtab.
ENDIF.

ELSE.

CALL FUNCTION 'BF_FUNCTIONS_READ'
EXPORTING
i_event    = ilist-event
i_no_xlbse = 'X'
IMPORTING
e_empty    = xfeld
TABLES
t_fmsap    = fmsap[]
t_fmprt    = fmprt[]
t_fmcus    = fmcus[]
EXCEPTIONS
OTHERS     = 1.

IF NOT fmsap[] IS INITIAL.
LOOP AT fmsap WHERE event = ilist-event.
gt_ilist-event = ilist-event.
gt_ilist-text1 = ilist-text1.
gt_ilist-text2 = ilist-text2.
gt_ilist-stdfb = fmsap-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

IF NOT fmprt[] IS INITIAL.
LOOP AT fmprt WHERE event = ilist-event.
gt_ilist-event = ilist-event.
gt_ilist-text1 = ilist-text1.
gt_ilist-text2 = ilist-text2.
gt_ilist-stdfb = fmprt-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

IF NOT fmcus[] IS INITIAL.
LOOP AT fmcus WHERE event = ilist-event.
gt_ilist-event = ilist-event.
gt_ilist-text1 = ilist-text1.
gt_ilist-text2 = ilist-text2.
gt_ilist-stdfb = fmcus-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

ENDIF.
*   MOVE-CORRESPONDING ILIST TO Gt_ILIST.
*   Append gt_ilist.
CLEAR ilist.
CLEAR gt_ilist.
REFRESH fmtab.
REFRESH fmsap.
REFRESH fmprt.
REFRESH fmcus.
ENDLOOP.




ENDFORM.                    " GET_BTE_EVENT
*&---------------------------------------------------------------------*
*&      Form  GET_BTE_PROCESS
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM get_bte_process .


DATA: counter     TYPE i,
i           TYPE i,
fieldname   LIKE dynpread-fieldname,
fieldvalue  LIKE dynpread-fieldvalue,
found(1)    TYPE c,
funct       LIKE tfdir-funcname,
keyrange(24),
line        TYPE i,
object      LIKE dokhl-object,
progname    LIKE rs38m-programm,
rcode       LIKE sy-subrc,
sel_appl    LIKE df14l-ps_posid,
sel_val     LIKE help_info-fldvalue,
string(132) TYPE c,
tabix       LIKE sy-tabix,
ucomm_old   LIKE sy-ucomm,
version     LIKE doktl-dokversion,
xfeld.

SELECT        * FROM  tps01 INTO TABLE itps01.

SELECT        * FROM  tps01t INTO TABLE itps01t
WHERE  spras       = sy-langu.

SELECT        * FROM  tps02 INTO TABLE itps02
WHERE  attr_type   = 'A'.



LOOP AT itps02.

READ TABLE itps01t WITH KEY procs = itps02-procs.
*                              SPRAS = SY-LANGU.
IF sy-subrc = 0.
ilist_p-procs = itps02-procs.
ilist_p-text1 = itps01t-text1.
ilist_p-text2 = itps01t-text2.
ENDIF.

READ TABLE itps01 WITH KEY procs = itps02-procs.
IF sy-subrc = 0.
ilist_p-xlbse = itps01-xlbse.
ilist_p-stdfb = itps01-stdfb.
ilist_p-xosap = itps01-xosap.

ENDIF.
APPEND ilist_p.
ENDLOOP.

SORT ilist_p BY procs.
DELETE ADJACENT DUPLICATES FROM ilist_p COMPARING procs.



LOOP AT ilist_p.

IF ilist_p-xlbse IS INITIAL.
CALL FUNCTION 'PC_FUNCTIONS_READ'
EXPORTING
i_procs = ilist_p-procs
IMPORTING
e_empty = xfeld
TABLES
t_fmsap = apsap
t_fmprt = apprt
t_fmcus = apcus
EXCEPTIONS
OTHERS  = 1.

IF NOT apsap[] IS INITIAL.
LOOP AT apsap WHERE procs = ilist_p-procs.
gt_ilist-event = ilist_p-procs.
gt_ilist-text1 = ilist_p-text1.
gt_ilist-text2 = ilist_p-text2.
gt_ilist-stdfb = apsap-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

IF NOT apprt[] IS INITIAL.
LOOP AT apprt WHERE procs = ilist_p-procs.
gt_ilist-event = ilist_p-procs.
gt_ilist-text1 = ilist_p-text1.
gt_ilist-text2 = ilist_p-text2.
gt_ilist-stdfb = apprt-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

IF NOT apcus[] IS INITIAL.
LOOP AT apcus WHERE procs = ilist_p-procs.
gt_ilist-event = ilist_p-procs.
gt_ilist-text1 = ilist_p-text1.
gt_ilist-text2 = ilist_p-text2.
gt_ilist-stdfb = apcus-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

ELSE.
CALL FUNCTION 'PC_FUNCTIONS_READ'
EXPORTING
i_procs    = ilist_p-procs
i_no_xlbse = 'X'
IMPORTING
e_empty    = xfeld
TABLES
t_fmsap    = apsap
t_fmprt    = apprt
t_fmcus    = apcus
EXCEPTIONS
OTHERS     = 1.

IF NOT apsap[] IS INITIAL.
LOOP AT apsap WHERE procs = ilist_p-procs.
gt_ilist-event = ilist_p-procs.
gt_ilist-text1 = ilist_p-text1.
gt_ilist-text2 = ilist_p-text2.
gt_ilist-stdfb = apsap-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

IF NOT apprt[] IS INITIAL.
LOOP AT apprt WHERE procs = ilist_p-procs.
gt_ilist-event = ilist_p-procs.
gt_ilist-text1 = ilist_p-text1.
gt_ilist-text2 = ilist_p-text2.
gt_ilist-stdfb = apprt-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

IF NOT apcus[] IS INITIAL.
LOOP AT apcus WHERE procs = ilist_p-procs.
gt_ilist-event = ilist_p-procs.
gt_ilist-text1 = ilist_p-text1.
gt_ilist-text2 = ilist_p-text2.
gt_ilist-stdfb = apcus-funct.
APPEND gt_ilist.
ENDLOOP.
ENDIF.

ENDIF.


ENDLOOP.


ENDFORM.                    " GET_BTE_PROCESS
*&---------------------------------------------------------------------*
*&      Form  SUB_DISPLAY_UEXIT_SD
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_display_uexit_sd .

REFRESH i_fieldcat22[] .

* prepare field catalog
PERFORM sub_prep_fcatalog_uexit_sd.

* for f_exit
CALL FUNCTION 'REUSE_ALV_BLOCK_LIST_APPEND'
EXPORTING
is_layout                  = wa_fieldlayout
it_fieldcat                = i_fieldcat22
i_tabname                  = 'I_UEXIT_SD'
it_events                  = i_events22
TABLES
t_outtab                   = i_uexit_sd
EXCEPTIONS
program_error              = 1
maximum_of_appends_reached = 2
OTHERS                     = 3.
IF sy-subrc <> 0.
ENDIF.

ENDFORM.                    " SUB_DISPLAY_UEXIT_SD

*&---------------------------------------------------------------------*
*&      Form  DOWNLOAD_TO_EXCEL
*&---------------------------------------------------------------------*
*       Download report to Excel Spreadsheet
*----------------------------------------------------------------------*
FORM download_to_excel .

DATA: numrows    TYPE i,
maxrows    TYPE i.

* Create Excel Spreadsheet
PERFORM initialize_spreadsheet.

** Begin of change ** RKUMAR7 **

IF p_rfc = c_flag.
PERFORM rfc_connect_xls_dwnd.
ENDIF.

IF p_gtway = c_flag.
PERFORM gtway_connect_xls_dwnld.
ENDIF.

IF p_bkgrnd = c_flag.
PERFORM scheduled_job_xls_dwnld.
ENDIF.
** End of change ** RKUMAR7 **

IF p_dbhis = c_flag.

PERFORM trans_stats_xls_dwnd.

ENDIF.

IF p_pghis = 'X' .

PERFORM prg_stats_xls_dwnd.

ENDIF.

* Start of change by TDEY ----
IF p_user = c_flag.
PERFORM user_xls_dwnd.
ENDIF.
IF p_server = c_flag.
PERFORM server_xls_dwnd.
ENDIF.
* End of change by TDEY ----

IF p_hrdw = c_flag.

PERFORM hwd_pltf_xls_dwnd.

ENDIF.

IF p_land = c_flag.

PERFORM lndscp_det_xls_dwnd.

ENDIF.

IF p_lang = c_flag.

PERFORM lang_inst_xls_dwnd.

ENDIF.

IF p_comp = c_flag.

PERFORM sap_version_xls_dwnd.

ENDIF.
IF p_lsmw = c_flag.

PERFORM lsmw_objects_xls_dwnd.

ENDIF.
IF p_ale = c_flag.

PERFORM cust_inbound_xls_dwnd.

PERFORM std_inbound_xls_dwnd.

PERFORM cust_outbound_xls_dwnd.

PERFORM std_outbound_xls_dwnd.

ENDIF.
IF workflow = c_flag .

PERFORM cust_wkflw_xls_dwnd .

PERFORM std_wkflw_xls_dwnd .

ENDIF.

IF enhan = c_flag.

PERFORM badi_xls_dwnd .

PERFORM sls_usr_exit_xls_dwnd .

PERFORM bte_xls_dwnd .

PERFORM vofm_xls_dwnd .

PERFORM fexit_xls_dwnd .

ENDIF.

****Begin of change by Rudra R
*  IF dev_appl = c_flag .
*
*    PERFORM prg_app_xls_dwnd .
*
*  ENDIF.
****End of change by Rudra R

IF cus_mes = c_flag .

PERFORM cust_msg_xls_dwnd .

ENDIF.

IF cus_area = c_flag .

PERFORM area_menu_xls_dwnd .

ENDIF.

IF cus_var = c_flag .

PERFORM std_var_xls_dwnd .

PERFORM cus_var_xls_dwnd .

ENDIF.

IF cus_que = c_flag .

PERFORM que_xls_dwnd .

ENDIF.

IF cus_ind = c_flag .

PERFORM cidx_xls_dwnd .

PERFORM sidx_xls_dwnd .

ENDIF.

IF cus_det = c_flag .

PERFORM str_xls_dwnd .

PERFORM view_xls_dwnd .

PERFORM tabl_xls_dwnd .

ENDIF.

IF cus_dev = c_flag .

PERFORM custdev_xls_dwnd .

ENDIF.

IF std_modf = c_flag .

PERFORM std_mod_xls_dwnd .

ENDIF.

PERFORM estimation_xls_dwnd.

PERFORM summary_xls_dwnd USING p_comp
p_lang
*                                Start of change by TDEY ----
p_user
p_server
*                                End of change by TDEY ----
p_pghis
p_dbhis
p_lsmw
p_ale
** Begin of change ** RKUMAR7 **
p_rfc
p_gtway
p_bkgrnd.

PERFORM run_info_xls_dwnld.
** End of change ** RKUMAR7 **

* Promt for saving the excel sheet
PERFORM save_excel_sheet.

ENDFORM.                    " DOWNLOAD_TO_EXCEL

*&---------------------------------------------------------------------*
*&      Form  CALL_LOCAL_FILE_POPUP
*&---------------------------------------------------------------------*
*       Provide Pop-Up for file name
*----------------------------------------------------------------------*
*FORM call_local_file_popup .
*
*  DATA l_title TYPE string.
*  DATA l_filename TYPE string.
*  DATA l_filepath TYPE string.
*  DATA l_fullpath TYPE string.
*
*  l_title = 'Select Local File '.
*  CALL METHOD cl_gui_frontend_services=>file_save_dialog
*    EXPORTING
*      window_title         = l_title
*      file_filter          = ',*.*,*.*.'
*      initial_directory    = 'C:'
**      prompt_on_overwrite  = ' '
*    CHANGING
*      filename             = l_filename
*      path                 = l_filepath
*      fullpath             = l_fullpath
*    EXCEPTIONS
*      cntl_error           = 1
*      error_no_gui         = 2
*      not_supported_by_gui = 3
*      OTHERS               = 4.
*
*  IF sy-subrc <> 0.
*    MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
*               WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
*  ELSE.
*    v_filepath = l_fullpath.
*  ENDIF.
*
*ENDFORM.                    " CALL_LOCAL_FILE_POPUP
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_RFC_CONNECTIONS
*&---------------------------------------------------------------------*
*       Retrieves all the RFC connections present
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_rfc_connections .
* types
TYPES: BEGIN OF x_rfcdest,
rfcdest TYPE rfcdest,
END OF x_rfcdest.

DATA: l_i_rfcdest TYPE STANDARD TABLE OF x_rfcdest INITIAL SIZE 0,
l_wa_rfcdest TYPE x_rfcdest,
l_wa_attrib   LIKE LINE OF i_rfcattrib,
l_i_rfcattrib LIKE TABLE OF i_rfcattrib.

SELECT rfcdest FROM
rfcdes INTO TABLE l_i_rfcdest.

SORT l_i_rfcdest BY rfcdest.
IF NOT l_i_rfcdest IS INITIAL.
SELECT  rfcdest  "Logical Destination
cuname   "Created by
cudate   "Created on
muname   "Last changed by
mudate   "Changed on
FROM rfcattrib
INTO TABLE l_i_rfcattrib
FOR ALL ENTRIES IN l_i_rfcdest
WHERE rfcdest = l_i_rfcdest-rfcdest.
IF sy-subrc = 0.
SORT l_i_rfcattrib BY rfcdest.
ENDIF.

LOOP AT l_i_rfcdest INTO l_wa_rfcdest.
READ TABLE l_i_rfcattrib INTO l_wa_attrib WITH KEY
rfcdest = l_wa_rfcdest-rfcdest BINARY SEARCH.
IF sy-subrc NE 0.
l_wa_attrib-rfcdest = l_wa_rfcdest.
l_wa_attrib-cudate = '        '.
l_wa_attrib-mudate = '        '.
ENDIF.
APPEND l_wa_attrib TO i_rfcattrib.
CLEAR l_wa_attrib.
ENDLOOP.

ENDIF.
*  Get the count
*{   REPLACE        DEVK901208                                        1
*\  v_rfc_count = LINES( i_rfcattrib ).
*  v_rfc_count = LINES( i_rfcattrib ).
DESCRIBE TABLE i_rfcattrib LINES v_rfc_count.
*}   REPLACE
ENDFORM.                    " SUB_GET_RFC_CONNECTIONS
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_GATEWAY_CONNECTIONS
*&---------------------------------------------------------------------*
*       It returns the active gateway connections
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_gateway_connections .
DATA: l_locgwhost        LIKE gwy_struct-gwhost,
l_locgwserv        LIKE gwy_struct-gwserv.

PERFORM sub_get_loc_host_and_service CHANGING l_locgwhost
l_locgwserv.

PERFORM sub_gw_conn_list USING l_locgwhost
l_locgwserv.

ENDFORM.                    " SUB_GET_GATEWAY_CONNECTIONS
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_LOC_HOST_AND_SERVICE
*&---------------------------------------------------------------------*
*       Perform system call to get host and sapsystem used for
*       retrieving gateway connection
*----------------------------------------------------------------------*
*      <--P_L_LOCGWHOST  text
*      <--P_L_LOCGWSERV  text
*----------------------------------------------------------------------*
FORM sub_get_loc_host_and_service  CHANGING p_locgwhost TYPE gwy_lhost
p_locgwserv TYPE gwy_serv.
DATA: sapsys(2).

CALL 'C_SAPGPARAM' ID 'NAME'  FIELD 'SAPLOCALHOST'
ID 'VALUE' FIELD p_locgwhost.

CALL 'C_SAPGPARAM' ID 'NAME'  FIELD 'SAPSYSTEM'
ID 'VALUE' FIELD sapsys.

p_locgwserv = 'sapgw'.
p_locgwserv+5 = sapsys.

ENDFORM.                    " SUB_GET_LOC_HOST_AND_SERVICE
*&---------------------------------------------------------------------*
*&      Form  SUB_GW_CONN_LIST
*&---------------------------------------------------------------------*
*       Here function moudle is called to get gateway connections
*----------------------------------------------------------------------*
*      -->P_L_LOCGWHOST  text
*      -->P_L_LOCGWSERV  text
*----------------------------------------------------------------------*
FORM sub_gw_conn_list  USING    p_locgwhost TYPE gwy_lhost
p_locgwserv TYPE gwy_serv.

CALL FUNCTION 'GWY_READ_CONNECTIONS'
EXPORTING
gwhost                          = p_locgwhost
gwserv                          = p_locgwserv
*   DISCONNECT                      =
TABLES
connections                     =  i_gwconn
EXCEPTIONS
gwy_unknown_opcode              = 1
gwy_communication_failure       = 2
gwy_get_tab_failed              = 3
gwy_newline_failed              = 4
gwy_tablen_too_short            = 5
gwy_get_opcode_failed           = 6
gwy_get_gwhost_failed           = 7
gwy_get_gwserv_failed           = 8
gwy_monitor_disabled            = 9
OTHERS                          = 10.
IF sy-subrc = 0.
*{   DELETE         DEVK901208                                        1
*\    v_gtw_count = LINES( i_gwconn ).
*}   DELETE
*{   INSERT         DEVK901208                                        2
DESCRIBE TABLE i_gwconn LINES v_gtw_count.
*}   INSERT
ENDIF.
ENDFORM.                    " SUB_GW_CONN_LIST
*&---------------------------------------------------------------------*
*&      Form  SUB_GET_BACKGRND_JOBS
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM sub_get_backgrnd_jobs .
DATA: l_past_date TYPE sydatum,
l_nodate TYPE sydatum VALUE '        '.
****Begin of change by Rudra
*  TYPES : BEGIN OF lty_op,
*           jobname TYPE btcjob,
*           jobcount TYPE btcjobcnt,
*           progname TYPE btcprog,
*          END OF lty_op.
*  DATA : lt_op TYPE STANDARD TABLE OF v_op INITIAL SIZE 0.
****End of change by Rudra

*  Get the Past date
CALL FUNCTION 'CCM_GO_BACK_MONTHS'
EXPORTING
currdate   = sy-datum
backmonths = p_month
IMPORTING
newdate    = l_past_date.


SELECT a~jobname
b~progname
b~variant
FROM tbtco AS a INNER JOIN tbtcp AS b
ON a~jobname = b~jobname
AND a~jobcount = b~jobcount
INTO TABLE i_backgrnd
WHERE
* Anjan Added to retrive batch jobs associated with custom prog.
b~progname IN r_object AND
(


(
(
( a~sdlstrtdt = l_past_date
AND  a~sdlstrttm >= '000000' )
OR  a~sdlstrtdt >  l_past_date
)
AND
(
( a~sdlstrtdt = sy-datum
AND a~sdlstrttm <= '240000' )
OR  a~sdlstrtdt < sy-datum
)
OR
(
a~sdlstrtdt EQ  l_nodate AND
a~eventid   EQ space
)
)
).

IF sy-subrc = 0.
SORT i_backgrnd BY jobname progname.
DELETE ADJACENT DUPLICATES FROM i_backgrnd COMPARING jobname
progname.
*{   DELETE         DEVK901208                                        1
*\    v_job_count = LINES( i_backgrnd  ).
*}   DELETE
*{   INSERT         DEVK901208                                        2
DESCRIBE TABLE i_backgrnd LINES v_job_count.
*}   INSERT
ENDIF.
ENDFORM.                    " SUB_GET_BACKGRND_JOBS

* Start of change by TDEY ----
*&---------------------------------------------------------------------*
*&      Form  sub_get_client_user_info
*&---------------------------------------------------------------------*
*       Get the Client and User info
*----------------------------------------------------------------------*
FORM sub_get_client_user_info .

DATA: BEGIN OF l_i_clients OCCURS 0,  "Clients
mandt LIKE t000-mandt,      "Client
mtext LIKE t000-mtext,      "Client name
END OF l_i_clients,

BEGIN OF l_i_users OCCURS 0,  "User Details
mandt LIKE usr02-mandt,   "Client
bname LIKE usr02-bname,   "User Name in User Master Record
ustyp LIKE usr02-ustyp,   "User Type
END OF l_i_users,

l_i_dd07v TYPE STANDARD TABLE OF dd07v WITH HEADER LINE.


SELECT mandt "Client
mtext "Client name
FROM t000 INTO TABLE l_i_clients.
* sy-subrc check is not required as we do not need to handle it.

SELECT  mandt   "Client
bname   "User Name in User Master Record
ustyp   "User Type
FROM usr02
CLIENT SPECIFIED
INTO TABLE l_i_users
WHERE mandt LIKE '%'
ORDER BY PRIMARY KEY.
* sy-subrc check is not required as we do not need to handle it.

* Get the user type text
CALL FUNCTION 'GET_DOMAIN_VALUES'
EXPORTING
domname         = 'XUUSTYP'
TABLES
values_tab      = l_i_dd07v
EXCEPTIONS
no_values_found = 1
OTHERS          = 2.



LOOP AT l_i_clients.

CLEAR i_client_user.

i_client_user-mandt = l_i_clients-mandt.
i_client_user-mtext = l_i_clients-mtext.

*   Loop for each user in the client
LOOP AT l_i_users WHERE mandt = l_i_clients-mandt.
i_client_user-bname = l_i_users-bname.
i_client_user-ustyp = l_i_users-ustyp.

READ TABLE l_i_dd07v WITH KEY domvalue_l = l_i_users-ustyp.
IF sy-subrc = 0.
i_client_user-ustyptxt = l_i_dd07v-ddtext.
ENDIF.

APPEND i_client_user.
ENDLOOP.

*   If no user is found within the client
IF sy-subrc NE 0.
APPEND i_client_user.
ENDIF.

ENDLOOP.

ENDFORM.                    " sub_get_client_user_info

*&---------------------------------------------------------------------*
*&      Form  SUB_REPORT_HEADING38
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading38 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Clients & Users:'(305).
SKIP 1 .

ENDFORM.                    " SUB_REPORT_HEADING38


*&---------------------------------------------------------------------*
*&      Form  sub_get_server_info
*&---------------------------------------------------------------------*
*       Get the Application Server & Database Server Information
*----------------------------------------------------------------------*
FORM sub_get_server_info .

DATA:
l_i_app_server TYPE STANDARD TABLE OF msxxlist INITIAL SIZE 0,
l_wa_db_server TYPE dbrelinfo,
l_info TYPE zibm_dbrelinfo.

FIELD-SYMBOLS:
<lfs_wa_app_server> TYPE msxxlist.

* Retrieve the Application Server info
CALL FUNCTION 'TH_SERVER_LIST'
TABLES
list           = l_i_app_server
EXCEPTIONS
no_server_list = 1
OTHERS         = 2.
IF sy-subrc = 0.
LOOP AT l_i_app_server ASSIGNING <lfs_wa_app_server>.
i_server-type = 'Application'(306).
i_server-name = <lfs_wa_app_server>-name.
i_server-host = <lfs_wa_app_server>-host.
APPEND i_server.
ENDLOOP.
ENDIF.

* Retrieve the Database Server info
CALL FUNCTION 'DB_DBRELINFO'
IMPORTING
dbinfo = l_wa_db_server.

i_server-type = 'Database'(307).
MOVE-CORRESPONDING l_wa_db_server TO l_info.

IF NOT l_info-dbname IS INITIAL.
i_server-name = l_info-dbname.
ELSE.
i_server-name = l_info-dbsys.
ENDIF.

IF NOT l_info-dbhost IS INITIAL.
i_server-host = l_info-dbhost.
ELSE.
i_server-host = sy-host.
ENDIF.

APPEND i_server.

ENDFORM.                    " sub_sub_get_server_info

*&---------------------------------------------------------------------*
*&      Form  SUB_REPORT_HEADING39
*&---------------------------------------------------------------------*
*      for writing Report header
*----------------------------------------------------------------------*
FORM sub_report_heading39 .

PERFORM sub_header USING  'IBM Proprietary'(065)
space .

SKIP 2 .
WRITE :/  'Server Information:'(308).
SKIP 1 .

ENDFORM.                    " SUB_REPORT_HEADING39

*&---------------------------------------------------------------------*
*&      Form  SUB_GET_DB_SPACE_INFO
*&---------------------------------------------------------------------*
*       Get the database space info
*----------------------------------------------------------------------*
*       No Parameter
*----------------------------------------------------------------------*
FORM sub_get_db_space_info .

*{   REPLACE        TEDK909196                                        1
*\  DATA: l_wa_hw_info TYPE smsyhwinfo,
*\        l_i_db6 TYPE STANDARD TABLE OF db6pmdb02 INITIAL SIZE 0,
*\        l_wa_db6 TYPE db6pmdb02,
*\        l_wa_oracle TYPE td110_stru.
*  DATA: l_wa_hw_info TYPE smsyhwinfo,
*        l_i_db6 TYPE STANDARD TABLE OF db6pmdb02 INITIAL SIZE 0,
*        l_wa_db6 TYPE db6pmdb02,
*        l_wa_oracle TYPE td110_stru.
*}   REPLACE

*{   REPLACE        TEDK909196                                        2
*\  CASE sy-dbsys.
*\    WHEN 'DB6'.
*\      CALL FUNCTION 'DB6_HIS_OVERVIEW'
*\        TABLES
*\          it_db6pmdb02          = l_i_db6
*\        EXCEPTIONS
*\          no_history_found      = 1
*\          invalid_parameter_set = 2
*\          adbc_error            = 3
*\          system_error          = 4
*\          OTHERS                = 5.
*\      IF sy-subrc = 0.
*  CASE sy-dbsys.
*    WHEN 'DB6'.
*      CALL FUNCTION 'DB6_HIS_OVERVIEW'
*        TABLES
*          it_db6pmdb02          = l_i_db6
*        EXCEPTIONS
*          no_history_found      = 1
*          invalid_parameter_set = 2
*          adbc_error            = 3
**          system_error          = 4
*          OTHERS                = 5.
*      IF sy-subrc = 0.
*}   REPLACE

*{   REPLACE        TEDK909196                                        3
*\        READ TABLE l_i_db6 INTO l_wa_db6 INDEX 1.
*\
*\        IF sy-subrc = 0.
*\          CLEAR l_wa_hw_info.
*\          l_wa_hw_info-descriptor = 'DB Allocated Space'(309).
*\        WRITE l_wa_db6-totalkb TO l_wa_hw_info-value_1 LEFT-JUSTIFIED.
*\          CONCATENATE l_wa_hw_info-value_1 'KB'
*\                 INTO l_wa_hw_info-value_1
*\                 SEPARATED BY space.
*\          APPEND l_wa_hw_info TO i_hw_info.
*\
*\          CLEAR l_wa_hw_info.
*\          l_wa_hw_info-descriptor = 'DB Free Space'(310).
*\          WRITE l_wa_db6-freekb TO l_wa_hw_info-value_1
*\                LEFT-JUSTIFIED.
*\          CONCATENATE l_wa_hw_info-value_1 'KB'
*\                 INTO l_wa_hw_info-value_1
*\                 SEPARATED BY space.
*\          APPEND l_wa_hw_info TO i_hw_info.
*\
*\        ENDIF.
*        READ TABLE l_i_db6 INTO l_wa_db6 INDEX 1.
*
*        IF sy-subrc = 0.
*          CLEAR l_wa_hw_info.
*          l_wa_hw_info-descriptor = 'DB Allocated Space'(309).
*          WRITE l_wa_db6-totalkb TO l_wa_hw_info-value_1 LEFT-JUSTIFIED
.
*          CONCATENATE l_wa_hw_info-value_1 'KB'
*                 INTO l_wa_hw_info-value_1
*                 SEPARATED BY space.
*          APPEND l_wa_hw_info TO i_hw_info.

*          CLEAR l_wa_hw_info.
*          l_wa_hw_info-descriptor = 'DB Free Space'(310).
*          WRITE l_wa_db6-freekb TO l_wa_hw_info-value_1
*                LEFT-JUSTIFIED.
*          CONCATENATE l_wa_hw_info-value_1 'KB'
*                 INTO l_wa_hw_info-value_1
*                 SEPARATED BY space.
*          APPEND l_wa_hw_info TO i_hw_info.

*        ENDIF.
*}   REPLACE
*{   REPLACE        TEDK909196                                        4
*\      ENDIF.
*\
*\    WHEN 'ORACLE'.
*\      CALL FUNCTION 'DB02_ORA_FILL_TD110'
*\        IMPORTING
*\          td110 = l_wa_oracle.
*      ENDIF.

*    WHEN 'ORACLE'.
*      CALL FUNCTION 'DB02_ORA_FILL_TD110'
*        IMPORTING
*          td110 = l_wa_oracle.
*}   REPLACE
*{   REPLACE        DEVK901208                                        1
*\      IF l_wa_oracle IS NOT INITIAL.
*{   REPLACE        TEDK909196                                        5
*\      IF NOT l_wa_oracle IS INITIAL.
*      IF NOT l_wa_oracle IS INITIAL.
*}   REPLACE
*}   REPLACE
*{   REPLACE        TEDK909196                                        6
*\        CLEAR l_wa_hw_info.
*\        l_wa_hw_info-descriptor = 'DB Allocated Space'(311).
*\      WRITE l_wa_oracle-tssi TO l_wa_hw_info-value_1 LEFT-JUSTIFIED.
*\        CONDENSE l_wa_hw_info-value_1.
*\        CONCATENATE l_wa_hw_info-value_1 'KB'
*\               INTO l_wa_hw_info-value_1
*\               SEPARATED BY space.
*\        APPEND l_wa_hw_info TO i_hw_info.
*\
*\        CLEAR l_wa_hw_info.
*\        l_wa_hw_info-descriptor = 'DB Free Space'(312).
*\        WRITE l_wa_oracle-tsfr TO l_wa_hw_info-value_1
*\              LEFT-JUSTIFIED.
*\        CONDENSE l_wa_hw_info-value_1.
*\        CONCATENATE l_wa_hw_info-value_1 'KB'
*\               INTO l_wa_hw_info-value_1
*\               SEPARATED BY space.
*\        APPEND l_wa_hw_info TO i_hw_info.
*\      ENDIF.
*        CLEAR l_wa_hw_info.
*        l_wa_hw_info-descriptor = 'DB Allocated Space'(311).
*        WRITE l_wa_oracle-tssi TO l_wa_hw_info-value_1 LEFT-JUSTIFIED.
*        CONDENSE l_wa_hw_info-value_1.
*        CONCATENATE l_wa_hw_info-value_1 'KB'
*               INTO l_wa_hw_info-value_1
*               SEPARATED BY space.
*        APPEND l_wa_hw_info TO i_hw_info.
*
*        CLEAR l_wa_hw_info.
*        l_wa_hw_info-descriptor = 'DB Free Space'(312).
*        WRITE l_wa_oracle-tsfr TO l_wa_hw_info-value_1
*              LEFT-JUSTIFIED.
*        CONDENSE l_wa_hw_info-value_1.
*        CONCATENATE l_wa_hw_info-value_1 'KB'
*               INTO l_wa_hw_info-value_1
*               SEPARATED BY space.
*        APPEND l_wa_hw_info TO i_hw_info.
*      ENDIF.
*}   REPLACE

*{   REPLACE        TEDK909196                                        7
*\    WHEN OTHERS.
*\
*\  ENDCASE.
*    WHEN OTHERS.

*  ENDCASE.
*}   REPLACE

ENDFORM.                    " SUB_GET_DB_SPACE_INFO

*&---------------------------------------------------------------------*
*&      Form  SUB_POPULATE_SAP_VERSION
*&---------------------------------------------------------------------*
*       Populate the sap versions in the selection screen
*----------------------------------------------------------------------*
*       No Parameter
*----------------------------------------------------------------------*
FORM sub_populate_sap_version .

DATA:
l_name     TYPE vrm_id,
l_i_list   TYPE vrm_values,
l_wa_value LIKE LINE OF l_i_list,
l_i_version TYPE STANDARD TABLE OF zibmsuet_saprl INITIAL SIZE 0,
l_wa_version TYPE zibmsuet_saprl.

l_name = 'P_CVER'.

* Get the Current versions
SELECT DISTINCT source_version
INTO TABLE l_i_version
FROM zibm_uimpact_hdr
WHERE source_version NE 'OLD'.

IF sy-subrc = 0.

SORT l_i_version.

LOOP AT l_i_version INTO l_wa_version.
l_wa_value-key = l_wa_version.
l_wa_value-text = l_wa_version.
APPEND l_wa_value TO l_i_list.
ENDLOOP.

CALL FUNCTION 'VRM_SET_VALUES'
EXPORTING
id     = l_name
values = l_i_list.

ENDIF.


l_name = 'P_VER'.
REFRESH l_i_list.
* Get the destination versions
SELECT DISTINCT target_version
INTO TABLE l_i_version
FROM zibm_uimpact_hdr.

IF sy-subrc = 0.

SORT l_i_version.

LOOP AT l_i_version INTO l_wa_version.
l_wa_value-key = l_wa_version.
l_wa_value-text = l_wa_version.
APPEND l_wa_value TO l_i_list.
ENDLOOP.

CALL FUNCTION 'VRM_SET_VALUES'
EXPORTING
id     = l_name
values = l_i_list.

ENDIF.



ENDFORM.                    " SUB_POPULATE_SAP_VERSION

* End of change by TDEY ----
*&---------------------------------------------------------------------*
*&      Form  SUB_PREP_FCATALOG_WFLOW_STD
*&---------------------------------------------------------------------*
*       Prepare field catalogue for Standard Workflow output
*----------------------------------------------------------------------*
FORM sub_prep_fcatalog_wflow_std .

m_fieldcat 'I_L_STD_WFLOW' 'OTYPE' 'Obj Type'(142)  ' '
i_fieldcat24  '8'.

m_fieldcat 'I_L_STD_WFLOW' 'OBJID' 'Object ID'(143)  ' '
i_fieldcat24  '20' .

m_fieldcat 'I_L_STD_WFLOW' 'STEXT' 'Short Text'(144)  ' '
i_fieldcat24  '60'.

m_fieldcat 'I_L_STD_WFLOW' 'COUNT' 'Usage Count'(233)  ' '
i_fieldcat24  '60'.

ENDFORM.                    " SUB_PREP_FCATALOG_WFLOW_STD
*&---------------------------------------------------------------------*
*&      Form  DEFAULT_DATE_RANGE_WFLOW
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM default_date_range_wflow .

CHECK p_date[] IS INITIAL.
** Begin of change ** RKUMAR7 ** 27.10.2009 20:30:49
p_date-sign = 'I'.
p_date-option = 'BT'.
** End of change ** RKUMAR7 ** 27.10.2009 20:30:52
* Get the past date based on selection
CALL FUNCTION 'CCM_GO_BACK_MONTHS'
EXPORTING
currdate   = sy-datum
backmonths = '006'
IMPORTING
newdate    = p_date-low.

p_date-high = sy-datum.
APPEND p_date.

ENDFORM.                    " DEFAULT_DATE_RANGE_WFLOW
*&------------------------------------------------------------------*
*&      Form  GET_DATA_RETENTION_MONTH
*&------------------------------------------------------------------*
*       text
*-------------------------------------------------------------------*
*      <--P_RETENTION_MONTH  text
*-------------------------------------------------------------------*
FORM get_data_retention_month
CHANGING p_retention_month TYPE sy-tabix.

DATA:
l_key TYPE moni-srtfd,
l_dwa TYPE REF TO data.
DATA l_count TYPE sy-tabix.

CONSTANTS :
l_c_tab TYPE dd02l-tabname VALUE 'SAPWLCOLPA',
l_c_tab_index TYPE dd02l-tabname VALUE 'SWNCMONIINDEX'.
FIELD-SYMBOLS : <l_wa> TYPE ANY,
<l_value> TYPE ANY.

CATCH SYSTEM-EXCEPTIONS create_data_unknown_type = 1
assign_casting_illegal_cast = 2
assign_casting_unknown_type = 3
create_data_not_allowed_type = 4
move_cast_error = 5
others = 6.

CASE sy-saprl+0(3).

WHEN '46C'.  "46C version
l_key+00(02) = '--'.
l_key+02(20) = 'TOTAL   REORG PARAM.'.
IMPORT stapar FROM MEMORY ID 'REORG-PARAMETERS'.
IF sy-subrc NE 0.
IMPORT stapar FROM DATABASE moni(pa) ID l_key.
ENDIF.

READ TABLE stapar WITH KEY active = 'X'.
IF sy-subrc = 0.
p_retention_month = stapar-res_months.
ENDIF.

WHEN '700'.  "700 version
SELECT COUNT(*) FROM (l_c_tab_index) INTO l_count.
IF sy-subrc <> 0.
p_retention_month = 0.
ELSE.
CREATE DATA l_dwa  TYPE (l_c_tab).
ASSIGN l_dwa->* TO <l_wa>.
IF sy-subrc = 0.
SELECT SINGLE * FROM (l_c_tab) INTO  <l_wa>
WHERE systemid = sy-sysid
AND   paramname = 'STATISTIC_DATA_KEEP_MONTH'.

ENDIF.

IF sy-subrc = 0.
ASSIGN COMPONENT 'PAR_INTVAL' OF STRUCTURE <l_wa>
TO <l_value>.
p_retention_month = <l_value>.
ENDIF.
ENDIF.

WHEN OTHERS.
CREATE DATA l_dwa  TYPE (l_c_tab).
ASSIGN l_dwa->* TO <l_wa>.
IF sy-subrc = 0.
SELECT SINGLE * FROM (l_c_tab) INTO  <l_wa>
WHERE systemid = sy-sysid
AND   paramname = 'STATISTIC_DATA_KEEP_MONTH'.

ENDIF.

IF sy-subrc = 0.
ASSIGN COMPONENT 'PAR_INTVAL' OF STRUCTURE <l_wa>
TO <l_value>.
p_retention_month = <l_value>.
ENDIF.
ENDCASE.
ENDCATCH.

if sy-subrc <> 0.
p_retention_month = 0.
endif.

ENDFORM.                    " GET_DATA_RETENTION_MONTH
*Text symbol textE
*001:Selection Criteria - Development
*002:Standard Object Modification
*003:Display All Custom Developments
*004:Processing cancelled by user
*005:Not Calculated
*006:Select All
*007:Deselect All
*008:Select atleast one checkbox
*009:Index Name
*010:Custom Query Details :
*011:Query Name
*012:Infoset Name
*013:Index on Custom Tables:
*014:Report Name
*015:Standard Objects Modified :
*016:Object
*017:Object Description
*018:Object Name
*019:Variant Name
*020:Area Menu Name
*021:Variant of Custom Programs:
*022:Details of Custom Table/View/Structure
*023:Custom Message Details
*024:Custom Area Menu Details :
*025:All Custom Developments :
*026:Table Name
*027:Field Name
*028:Key ?
*029:Data Element
*030:Check Table
*031:Domain
*032:Data Type
*033:Length
*034:Decimal Places
*035:Description
*036:Custom Table Field Details :
*037:View Name
*038:Structure Name
*039:Custom Structure Field Details :
*040:Custom View Field Details :
*041:Custom Index Details
*042:Custom Area Menu Details
*043:Custom Query Details
*044:Custom Variant Details
*045:Message Class
*046:Formname
*047:Language
*048:Custom Sapscripts Maintained in Different Languages :
*049:Custom Samrtforms Maintained in Different Languages :
*050:Programs in Different Applications :
*051:Application
*052:Program Name
*053:Category
*054:Total Count
*055:Custom Message Details :
*056:Message
*057:Message Number
*058:Utility Tool for Upgrade
*059:Page:
*060:UserID:
*061:Time:
*062:Report:
*063:Click on the item category line only
*064:User Group
*065:IBM Proprietary
*066:Selection Criteria - Basis
*067:Selection Criteria - Statistics
*068:Release and Support Pack
*069:Type of Report
*070:Languages Installed
*071:Transport Path
*072:Hardware Platforms
*073:Program Related Statistics
*074:Transaction Related Statistics
*075:Conversion and Interface Related
*076:ALE Interfaces
*077:LSMW Objects
*078:Custom Inbound ALE Interfaces
*079:Filter Criteria for Custom Objects
*080:Selecting other attributes
*081:Obsolete FM Count(Warning)
*082:Sub Type
*083:Sub Type Description
*084:Index on Standard Tables:
*085:Variant of Standard Programs:
*086:Other Objects*
*087:Report Name
*088:Custom Data Dictionary Objects**
*089:Module Pool Program
*090:Function Module
*091:Smart Form
*092:SAP Script Form
*093:Function Group
*094:Include Program
*095:Enhancement
*096:Modification
*097:LSMW Objects
*098:Package
*099:Standard Inbound ALE Interfaces
*100:Custom Outbound ALE Interfaces
*101:Standard Outbound ALE Interfaces
*102:Index on Custom/Standard Tables:
*103:Variant of Custom/Standard Programs:
*104:Enh. Component
*105:CMOD Project
*106:Function Exits :
*107:Function Exits
*108:SAP Version Information
*109:No. of Installed Languages
*110:Landscape Details
*111:Hardware Platform
*112:Program Usage Statistics
*113:Transaction Usage Statistics
*114:VOFM Routine
*115:VOFM Routine:
*116:Group Indicator
*117:Group Indicator Text
*118:No of the routine
*119:Application
*120:Description
*121:Enhancements (Fn Exits/VOFM/BTE/Sales User Exits/BADI)
*122:Business Transaction Events
*123:Event/Process
*124:Description
*125:Function Module
*126:Business Transaction Events:
*127:Sales User Exit
*128:Sales User Exit:
*129:Object Name
*130:User Exit Name
*131:Client
*132:All checkboxes must be enabled for Estimation Report
*133:Business Add-Ins - implementations
*134:Business Add-Ins - implementations:
*135:BADI Implementation
*136:BADI Definition
*137:Package
*138:Enhancements ***
*139:WorkFlow
*140:Work Flow :
*141:Custom WorkFlow
*142:Obj Type
*143:Object ID
*144:Short Text
*145:Standard WorkFlow
*146:TS = Single Step Workflow.
*147:WS = Multi Step WorkFlow
*148:Error in downloading data to excel spreadsheet
*149:TYPE
*150:Index on std. tables.
*151:Name
*152:Descriptor
*153:Value
*154:Indicator
*155:Last Changed By
*156:Time
*157:Current Date
*158:Installation Number
*159:SAP Release
*160:TMS Release
*161:RFC Destination
*162:Directory name
*163:System Name
*164:Transport Group
*165:tp Status
*166:TMS Status
*167:Distrib. Status
*168:CI Status
*169:Transport Domain
*170:Lang. (ISO 639)
*171:Degree of Translation of Lang
*172:Language specifications
*173:Language Key
*174:You are not authorized to run this transaction
*175:Component Type
*176:SAP SupportPackLevel
*177:Software Component
*178:Project
*179:Subproject
*180:Object Type
*181:Method
*182:Business Object
*183:Business Object Method
*184:Message Type
*185:Basic type
*186:Extension
*187:Once-Only
*188:Periodic
*189:Last changed by
*190:Date of Last Change
*191:System-Dependent File Name
*192:Function module
*193:Inbound process code
*194:Obj
*195:Sub Ty
*196:Idx
*197:Clt
*198:Enh.cmnt
*199:Evnt/Proc
*200:Comp Type Text
*201:RFC Connections
*202:Codepage
*203:Gateway Connections
*204:Scheduled Jobs With Cust Prog
*205:Iteration count
*206:Used
*207:Target SAP Version
*208:Clients and Users
*209:Servers
*210:No of months to check for data
*211:Logical Destination
*212:Created by
*213:Created on
*214:Changed On
*215:Connection Number
*216:Logical Unit
*217:Transaction program
*218:Gateway user
*219:Connection status
*220:Symbolic destination
*221:Conversation ID
*222:Client log
*223:Fast/slow connection
*224:Work process num
*225:General Counter
*226:CPIC Return Value
*227:CPIC return value
*228:Last Req Time
*229:Gateway fill byte
*230:Scheduled job name
*231:Program name
*232:Variant
*233:Usage Count
*234:Source SAP Version
*235:Target System is Unicode
*236:Upgrade Impact Analysis
*237:Method Program for BOR
*238:Obsolete Count(Warning)
*239:Please refer to the spreadsheet for the detail report
*240:Please save the report for further analysis
*241:Sub-Object Name
*242:ObjTy
*243:Object Type Desc
*244:Object Name
*245:Object Description
*246:Package
*247:Package Description
*248:Application
*249:Application Desc
*250:Source System
*251:Obj Ver
*252:Created on
*253:Last Changed by
*254:Last Changed on
*255:Last Transport
*256:Last Transport Date
*257:Lines of Code
*258:Release Impact(Warning)
*259:Unicode Impact(Error)
*260:Calculate Upgrade Impact (This option may be time cosuming)
*261:Used
*262:Structure
*263:Include Program
*264:Report Program
*265:Module Pool Program
*266:Description
*267:Development Related Information
*268:System:
*269:Date:
*270:System:
*271:Date:
*272:Interface and Conversion Related Information
*273:No.
*274:Summary Info.
*275:LSMW Objects
*276:Basis Related Information
*277:No.
*278:Summary Info.
*279:No. of Users
*280:No. of Servers
*281:Statistical Information
*282:Summary Info.
*283:months )
*284:months )
*285:Name
*286:Type
*287:Count
*288:No. of Serv
*289:Server Type
*290:Server Name
*291:Host
*292:No. of User
*293:User Type Desc
*294:No. Of processor
*295:Total memory
*296:Disk Space
*297:Lines in Source Code
*298:Program/Transaction usage statistics in last
*299:months
*300:Program/Transaction usage statistics in last
*301:*   AreaMenu, Search help, TMG, Class.
*302:**  Custom DataElement, Domain, Table, View, Structure,
*303:TableType.
*304:*** Function Exits, VOFM Routine, BTE, Sales User Exit, BADI.
*305:Clients & Users:
*306:Application
*307:Database
*308:Server Information:
*309:DB Allocated Space
*310:DB Free Space
*311:DB Allocated Space
*312:DB Free Space
*313:Std_Modified
*314:Cust_Developments
*315:Cust_Struct_Details
*316:Descriptions
*317:Table Name
*318:Std_table_index
*319:Cust_table_index
*320:User Group
*321:Query name
*322:InfoSet
*323:Cust_Query_Details
*324:Report
*325:Variant Name
*326:Cust_Prog Variants
*327:Report
*328:Variant Name
*329:Std_Prog Variants
*330:Cust Area Menus
*331:Package
*332:Message Class
*333:Msg No
*334:Message
*335:Cust Messages
*336:Program Name
*337:Application
*338:Progs In Applications
*339:Func_Exit
*340:BTE_List
*341:Sales User Exits
*342:BADI Implementation
*343:Std_Work Flow
*344:Cust_Work Flow
*345:Message Type
*346:Basic type
*347:Std ALE Outbound
*348:Cust ALE Outbound
*349:Message Type
*350:Inbound process code
*351:Function module
*352:Std ALE Inbound
*353:Cust ALE Inbound
*354:LSMW Objects
*355:SAP Version Info
*356:Languages Installed
*357:Landscape Details
*358:Hardware Platform
*359:Count
*360:Program Statistics
*361:Count
*362:Transaction Statistics
*363:No.
*364:Category
*365:Count
*366:Custom Inbound ALE Interfaces
*367:Standard Inbound ALE Interfaces
*368:Custom Outbound ALE Interfaces
*369:Standard Outbound ALE Interfaces
*370:LSMW Objects
*371:SAP Version Information
*372:RFC Connection
*373:Gateway Connection (Active)
*374:Scheduled Jobs
*375:No. of Installed Languages
*376:Total no of Users in all Clients
*377:Total no of Servers
*378:Program Usage Statistics
*379:Transaction Usage Statistics
*380:Summary Report
*381:Structure Name
*382:View Name
*383:Description
*384:Owner
*385:EDIDC40 Target Strc
*386:Short Description of Software Component
*387:Method
*388:No.
*389:Category
*390:Count
*391:*  AreaMenu, Index, Query, Class.
*392:** Custom DataElement, Domain, Table, View,
*393:Structure, TableType.
*394:*** Function Exits, VOFM Routine, BTE,
*395: Sales User Exit, BADI.
*396:Estimation Report
*397:RFC Connections
*398:User Info
*399:Client
*400:Client Name
*401:User Name
*402:User Type
*403:User Type Desc
*404:Server Type
*405:Server Name
*406:Host
*407:Server Info
*408:Report
*409:System
*410:Current SAP Version
*411:UserID
*412:Date/Time
*413:Run Info
*414:Parameters
*415:Low Value
*416:Date Range:Workflow usage
*417:High Value
*418:Statistical Data Retained For Months
*Selection textE
*CUS_AREA:        Custom Area Menu Details
*CUS_DET:        Details of Custom Table/View/S
*CUS_DEV:        Display All Custom Development
*CUS_IND:        Custom Index Details
*CUS_MES:        Custom Message Details
*CUS_QUE:        Custom Query Details
*CUS_VAR:        Custom Variant Details
*ENHAN:        Enhancements (Exits/BTE's/Rout
*P_ALE:        ALE Interfaces
*P_BKGRND:        Scheduled Jobs
*P_COMP:        Release and Support Pack
*P_COUNT:        Iteration count
*P_CVER:        Source SAP Version
*P_DATE:        Date Range:Workflow usage
*P_DBHIS:        Transaction Related Statistics
*P_DET:        Detail
*P_ESTM:        Estimation
*P_GTWAY:        Gateway Connections
*P_HRDW:        Hardware Platforms
*P_LAND:        Landscape Details
*P_LANG:        Languages Installed
*P_LSMW:        LSMW Objects
*P_MONTH:        No of months to check for data
*P_PGHIS:        Program Related Statistics
*P_RFC:        RFC Connections
*P_SERVER:        Server
*P_SUMM:        Summary
*P_UCODE:        Target System Unicode
*P_UPGRD:        Calculate Upgrade Impact
*P_USER:        Clients and Users
*P_VER:        Target SAP Version
*STD_MODF:        Standard Object Modification
*S_NAME:        Namespace
*S_PACK:        Development Class
*WORKFLOW:        Workflow
