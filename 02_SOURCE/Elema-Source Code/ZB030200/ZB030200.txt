***********************************************************************
* [プログラム名]
*   ZB030200 :システムメッセージ削除プログラム
*
* [処理概要]
*   R/3のシステムメッセージを削除する
*
* [改定履歴]
*　YYYY/MM/DD   Programar         Description
*  2002/05/31   PSD K.ARAI        新規開発　
*
***********************************************************************
REPORT ZB030200 .
*---------------------------------------------------------------------*
* データ宣言(グローバル)
*---------------------------------------------------------------------*
*--- 構造／テーブル型　宣言
* 構造：TYP_TEMSG
TYPES  BEGIN OF TYP_TEMSG.
INCLUDE STRUCTURE TEMSG.
TYPES  END OF TYP_TEMSG.
* 内部テーブル：
* メッセージテーブル格納
DATA : GF_TEMSG TYPE TYP_TEMSG,
GT_TEMSG TYPE TABLE OF TYP_TEMSG.

*---------------------------------------------------------------------
* START-OF-SELECTION
*---------------------------------------------------------------------
START-OF-SELECTION.

* データ抽出
PERFORM SELECT_DATA.

* メッセージテーブル削除
PERFORM DELETE_DATA.

*&---------------------------------------------------------------------*
*&      Form  SELECT_DATA
*&---------------------------------------------------------------------*
*       TEMSG データ抽出処理
*----------------------------------------------------------------------*
FORM SELECT_DATA.
* メッセージテーブル内の全てのデータを抽出
SELECT * INTO TABLE  GT_TEMSG FROM TEMSG.

CASE SY-SUBRC.
WHEN 0.
WHEN 4.
MESSAGE S400(Z1) WITH TEXT-001.
" システムメッセージは存在しません(問題なし)
STOP.
WHEN OTHERS.
MESSAGE S400(Z1) WITH TEXT-002.
" システムメッセージの削除に失敗しました
STOP.
ENDCASE.
ENDFORM.                    " SELECT_DATA
*&---------------------------------------------------------------------*
*&      Form  DELETE_DATA
*&---------------------------------------------------------------------*
*       メイン処理（メッセージの削除）
*----------------------------------------------------------------------*
FORM DELETE_DATA.
* メッセージテーブルのデータを全て削除
DELETE TEMSG FROM TABLE GT_TEMSG .

CASE SY-SUBRC.
WHEN 0.
* 終了メッセージ
MESSAGE S400(Z1) WITH TEXT-003.
" システムメッセージを削除しました
WHEN 4.
MESSAGE S400(Z1) WITH TEXT-002.
" システムメッセージの削除に失敗しました
WHEN OTHERS.
MESSAGE S400(Z1) WITH TEXT-002.
" システムメッセージの削除に失敗しました
ENDCASE.

ENDFORM.                    " DELETE_DATA
