REPORT ZTEST_ARAI4 .

DATA : ZNEN002T LIKE TABLE OF ZNEN002.
DATA : ZNEN002W LIKE ZNEN002.
DATA : MBEWT LIKE TABLE OF MBEW.
DATA : MBEWW LIKE MBEW.

SELECT * FROM ZNEN002
INTO TABLE ZNEN002T
WHERE ZANDT = '20090430'.

LOOP AT ZNEN002T INTO ZNEN002W.

SELECT SINGLE * FROM MBEW
INTO MBEWW
WHERE MATNR = ZNEN002W-MATNR
AND BWKEY = ZNEN002W-WERKS.


IF ZNEN002W-ITANKA <> MBEWW-VERPR OR
ZNEN002W-PEINH <> MBEWW-PEINH.
WRITE : / ZNEN002W-MATNR,
ZNEN002W-WERKS,
ZNEN002W-ITANKA,
MBEWW-VERPR.
ENDIF.
ENDLOOP.

WRITE : / 'Znen002起点全件処理終了'.

SELECT * FROM MBEW
INTO TABLE MBEWT
WHERE LBKUM >= 1.

LOOP AT MBEWT INTO MBEWW.

SELECT * FROM ZNEN002
INTO TABLE ZNEN002T
WHERE MATNR = MBEWW-MATNR
AND WERKS = MBEWW-BWKEY
and zandt = '20090430'.

LOOP AT ZNEN002T INTO ZNEN002W.

IF ZNEN002W-ITANKA <> MBEWW-VERPR OR
ZNEN002W-PEINH <> MBEWW-PEINH.
WRITE : / ZNEN002W-MATNR,
ZNEN002W-WERKS,
ZNEN002W-ITANKA,
MBEWW-VERPR.
ENDIF.
ENDLOOP.
ENDLOOP.

WRITE : / 'MBEW起点全件処理終了'.
