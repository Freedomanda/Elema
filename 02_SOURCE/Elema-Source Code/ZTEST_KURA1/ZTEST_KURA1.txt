REPORT ZTEST_KURA1 .

TYPES:BEGIN OF T_LFM1,
LIFNR TYPE LFM1-LIFNR,
WAERS TYPE LFM1-WAERS,
END OF T_LFM1.
TYPES:BEGIN OF T_MSEG,
MBLNR TYPE MSEG-MBLNR,
MJAHR TYPE MSEG-MJAHR,
ZEILE TYPE MSEG-ZEILE,
END OF T_MSEG.

DATA:IT_LFM1 TYPE TABLE OF T_LFM1,
WA_LFM1 TYPE T_LFM1,
IT_MSEG TYPE TABLE OF T_MSEG,
WA_MSEG TYPE T_MSEG,
V_AEDAT TYPE MKPF-AEDAT.

SELECT LIFNR WAERS
INTO TABLE IT_LFM1
FROM LFM1
WHERE WAERS <> 'JPY'.

CHECK SY-SUBRC = 0.

SELECT MBLNR MJAHR ZEILE
INTO TABLE IT_MSEG
FROM MSEG
FOR ALL ENTRIES IN IT_LFM1
WHERE LIFNR = IT_LFM1-LIFNR.

LOOP AT IT_MSEG INTO WA_MSEG.
CLEAR V_AEDAT.
SELECT SINGLE AEDAT
INTO V_AEDAT
FROM MKPF
WHERE MBLNR = WA_MSEG-MBLNR
AND MJAHR = WA_MSEG-MJAHR.
IF NOT V_AEDAT IS INITIAL.
WRITE : / WA_MSEG-MBLNR,WA_MSEG-MJAHR.
ENDIF.
ENDLOOP.
