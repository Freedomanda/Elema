*&---------------------------------------------------------------------*
*& Report  YTESTWW_ZDSTATUS
*&
*&---------------------------------------------------------------------*
*&
*&
*&---------------------------------------------------------------------*

REPORT  YTESTWW_ZDSTATUS.
*TABLES:
*  ZTEGSDT203.
*data:
*  w_ZDSTATU1 type ZTEGSDT203-STATUS,
*  w_ZDSTATU2 type ZECCSTATUS.
*
*SELECT-OPTIONS s_STATUS FOR ZTEGSDT203-STATUS.
*SELECT-OPTIONS s_STATU1 FOR w_ZDSTATU1.
*SELECT-OPTIONS s_STATU2 FOR w_ZDSTATU2.
DATA:LW_VKBUR TYPE VBAK-VKBUR.
SELECT-OPTIONS R_VKBUR FOR LW_VKBUR.
TYPES: BEGIN OF TYP_INFO,
VBELN TYPE VBAK-VBELN,    " 販売伝票
AUDAT TYPE VBAK-AUDAT,    " 伝票日付
AUART TYPE VBAK-AUART,    " 販売伝票タイプ
VKGRP TYPE VBAK-VKGRP,    " 営業グループ
VKBUR TYPE VBAK-VKBUR,    " 営業所
VDATU TYPE VBAK-VDATU,    " 指定納入期日
*---APPEND START PSD T.SAITOH 2002/07/15 ---------------------------*
*        BSTNK TYPE VBAK-BSTNK,    " 得意先発注番号
BSTNK TYPE VBKD-BSTKD,    " 得意先発注番号
*---APPEND END   PSD T.SAITOH 2002/07/15 ---------------------------*
KUNNR TYPE VBAK-KUNNR,    " 受注先
VBTYP TYPE VBAK-VBTYP,    " 販売管理伝票カテゴリ
ERNAM TYPE VBAK-ERNAM,    " ユーザＩＤ
POSNR TYPE VBUP-POSNR,    " 明細（ＳＤ）
BEZEIA TYPE TVKBT-BEZEI,  " 営業署名
BEZEIB TYPE TVGRT-BEZEI,  " 営業グループ名
TKNR   TYPE VBKD-BSTDK_E, " 得意先発注日付
* 2002/01/30 PSD H.Tanaka ADD ↓
STCUR  TYPE VBKD-KURSK,   " 換算レート
*2013/11/11 Add Start
ZTERM  TYPE VBKD-ZTERM,    " 支払条件キー
CHANG  TYPE CHAR1,         " 変更伝票区分
UPNAM  TYPE CDHDR-USERNAME," 変更ユーザID
UDATE  TYPE CDHDR-UDATE,   " 変更伝票の登録日付
UTIME  TYPE CDHDR-UTIME,   " 変更時刻
EBELU  TYPE EKKO-EBELN,    " 購買伝票番号
*2013/11/11 Add End
END   OF TYP_INFO.
data:GT_INFO type STANDARD TABLE OF TYP_INFO.
CONSTANTS:CNS_C(1)       TYPE C VALUE 'C',
CNS_H(1)       TYPE C VALUE 'H',
CNS_I(1)       TYPE C VALUE 'I',
CNS_KA(2)      TYPE C VALUE 'KA',
CNS_KR(2)      TYPE C VALUE 'KR'.

SELECT A~VBELN A~AUDAT A~AUART A~VKGRP A~VKBUR
A~VDATU A~BSTNK A~KUNNR A~VBTYP A~ERNAM
C~POSNR
D~BEZEI E~BEZEI F~BSTDK_E F~KURSK
INTO TABLE GT_INFO
FROM ( ( ( ( VBAK AS A INNER JOIN VBUK AS B
ON         A~VBELN  = B~VBELN ) INNER JOIN VBUP  AS C
ON         A~VBELN  = C~VBELN ) INNER JOIN TVKBT AS D
ON         A~VKBUR  = D~VKBUR ) INNER JOIN TVGRT AS E
ON         A~VKGRP  = E~VKGRP ) INNER JOIN VBKD  AS F
ON         C~VBELN  = F~VBELN
WHERE
*          A~VKBUR IN R_VKBUR  "2003.05.27 ADD
A~VKBUR <> '0600'  "2003.05.27 ADD
AND      A~VKBUR <> '0300'
AND     A~VKORG = '1000'
AND     A~VTWEG = '10'
AND     A~SPART = '10'
AND      ( ( A~VBTYP =  CNS_I )
OR   ( A~VBTYP =  CNS_C AND A~AUART <> CNS_KA )
OR   ( A~AUART =  CNS_KR AND A~VBTYP =  CNS_H ) )
AND        B~LFSTK <> CNS_C
AND     B~ABSTK <> CNS_C
AND     C~LFGSA <> CNS_C
AND     C~ABSTA <> CNS_C
AND     C~GBSTA <> CNS_C
AND     D~SPRAS =  SY-LANGU
AND     E~SPRAS =  SY-LANGU
**** END UPD 2014/09/02 ISID19 ****
AND     F~POSNR =  '000000'.
BREAK-POINT.
