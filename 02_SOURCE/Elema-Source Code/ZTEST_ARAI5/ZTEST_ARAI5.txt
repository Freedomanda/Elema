REPORT ZTEST_ARAI5 .

DATA : ZNEN002T LIKE TABLE OF ZNEN002.
DATA : ZNEN002W LIKE ZNEN002.

DATA : EKKOW LIKE EKKO.
DATA : TVBVKW LIKE TVBVK.

SELECT * FROM ZNEN002
INTO TABLE ZNEN002T
WHERE ZANDT = '20090331'
AND ZZNO NE SPACE.

LOOP AT ZNEN002T INTO ZNEN002W.

SELECT SINGLE * FROM EKKO
INTO EKKOW
WHERE EBELN = ZNEN002W-ZZNO.

IF SY-SUBRC NE 0.
CONTINUE.
ENDIF.

SELECT SINGLE * FROM TVBVK
INTO TVBVKW
WHERE VKGRP = EKKOW-EKGRP.

IF ZNEN002W-VKBUR NE TVBVKW-VKBUR OR
ZNEN002W-VKGRP NE TVBVKW-VKGRP.

WRITE : / ZNEN002W-MATNR,
ZNEN002W-WERKS,
ZNEN002W-ZZNO.
ENDIF.
ENDLOOP.
