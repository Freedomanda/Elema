REPORT ZTEST_ARAI8 .

DATA : ZNEN002T LIKE TABLE OF ZNEN002.
DATA : ZNEN002W LIKE ZNEN002.
DATA : MONEY(16) TYPE P DECIMALS 2.
DATA : MBEWT LIKE TABLE OF MBEW.
DATA : MBEWW LIKE MBEW.


SELECT * FROM ZNEN002
INTO TABLE ZNEN002T
WHERE ZANDT = '20090430'.
*
* loop at znen002t into znen002w.
*  money = money + ( znen002w-menge *
*                   znen002w-itanka *
*                   100 /
*                   znen002w-peinh ).
* endloop.
*
* write money.

* clear : money.

SELECT * FROM MBEW
INTO TABLE MBEWT
WHERE LBKUM > 0.

SORT ZNEN002T BY MATNR WERKS.

LOOP AT MBEWT INTO MBEWW.
*  money = money + ( mbeww-SALK3 *
*                   100 /
*                   mbeww-peinh ).

LOOP AT ZNEN002T INTO ZNEN002W
WHERE WERKS = MBEWW-BWKEY
AND MATNR = MBEWW-MATNR.
MBEWW-LBKUM =    MBEWW-LBKUM - ZNEN002W-MENGE.
ENDLOOP.

IF MBEWW-LBKUM NE 0.
WRITE : / MBEWW-MATNR,MBEWW-BWKEY.
ENDIF.

*  READ TABLE ZNEN002T INTO ZNEN002W
*       WITH KEY MATNR = MBEWW-MATNR
*                WERKS = MBEWW-BWKEY
*                BINARY SEARCH.

*  SELECT SINGLE * FROM ZNEN002
*    INTO ZNEN002W
*   WHERE MATNR = MBEWW-MATNR
*     AND WERKS = MBEWW-BWTAR.





ENDLOOP.

WRITE / MONEY.
