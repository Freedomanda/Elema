REPORT ZZMIKAMI_022 .


DATA: GT_YK230 TYPE TABLE OF YK230.
DATA: GW_YK230 TYPE YK230.
DATA: GW_YK230B TYPE YK230.
DATA: GW_YK410 TYPE YK410.
DATA: GF_A(2) TYPE C.
DATA: GF_B(2) TYPE C.

SELECT * FROM YK230 INTO TABLE GT_YK230
WHERE KEKKBN = 4.

SORT GT_YK230 BY LIFNR ZFBDT2.

LOOP AT GT_YK230 INTO GW_YK230.
CLEAR: GF_A, GF_B.
IF GW_YK230B-LIFNR <> GW_YK230-LIFNR
OR GW_YK230B-ZFBDT2 <> GW_YK230-ZFBDT2.
SELECT SINGLE * FROM YK410 INTO GW_YK410
WHERE LIFNR = GW_YK230-LIFNR
AND ZFBDT = GW_YK230-ZFBDT2.
IF SY-SUBRC = 0.
GF_A = 'Åõ'.
ELSE.
GF_A = 'Å~'.
ENDIF.

SELECT SINGLE * FROM YK410 INTO GW_YK410
WHERE LIFNR = GW_YK230-LIFNR
AND ZFBDT > GW_YK230-ZFBDT2.
IF SY-SUBRC = 0.
GF_B = 'Åõ'.
ELSE.
GF_B = 'Å~'.
ENDIF.

IF GF_A = 'Å~' OR GF_B = 'Å~'.
WRITE: /  GW_YK230-LIFNR,
13 GW_YK230-ZFBDT2,
25 GF_A,
29 GF_B.
ENDIF.
ENDIF.
GW_YK230B = GW_YK230.
ENDLOOP.
