REPORT ZTEST_ARAI6 .

DATA : ZNEN002T LIKE TABLE OF ZNEN002.
DATA : ZNEN002W LIKE ZNEN002.
DATA : EKKOW LIKE EKKO.
DATA : EKBET LIKE TABLE OF EKBE.
DATA : EKBEW LIKE EKBE.

SELECT * FROM ZNEN002
INTO TABLE ZNEN002T
WHERE ZZNO NE SPACE.

LOOP AT ZNEN002T INTO ZNEN002W.

SELECT SINGLE * FROM EKKO
INTO EKKOW
WHERE EBELN = ZNEN002W-ZZNO.

IF SY-SUBRC NE 0.
CONTINUE.
ENDIF.

REFRESH EKBET.

SELECT * FROM EKBE
INTO TABLE EKBET
WHERE EBELN = ZNEN002W-ZZNO
AND EBELP = ZNEN002W-ZZPOS
AND BEWTP = 'E'.

READ TABLE EKBET INTO EKBEW
WITH KEY EBELN = ZNEN002W-ZZNO
BUDAT = ZNEN002W-NYUKO_DAT.

IF SY-SUBRC NE 0.
WRITE : / ZNEN002W-ZZNO,
ZNEN002W-ZZPOS,
ZNEN002W-MATNR.
ENDIF.

ENDLOOP.

write : / '全件チェック完了'.
