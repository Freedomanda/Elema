*&---------------------------------------------------------------------*
*&  REPORT ZN031400                                                    *
*&         【移行】営業グループ設定                                    *
*&---------------------------------------------------------------------*
*&  機能     : YN120に得意先マスタの営業グループを設定する
*&
*&  作成日   : 2012/06/27
*&  作成者   : K.FURUYA(SOLFIS)
*&---------------------------------------------------------------------*

REPORT ZN031400
NO STANDARD PAGE HEADING
LINE-SIZE   170
LINE-COUNT  58
MESSAGE-ID  YN01.

*----------------------------------------------------------------------*
*   内部テーブル定義
*----------------------------------------------------------------------*
DATA:T_YN120 TYPE TABLE OF YN120,
W_YN120 TYPE YN120.

*----------------------------------------------------------------------*
*   変数定義
*----------------------------------------------------------------------*
DATA:G_VKGRP  TYPE KNVV-VKGRP.
DATA:G_CNT    TYPE I.

*&---------------------------------------------------------------------*
*&   画面項目定義
*&---------------------------------------------------------------------*
SELECT-OPTIONS:S_KUNNR FOR W_YN120-LIST1.

*----------------------------------------------------------------------*
*  START-OF-SELECTION
*----------------------------------------------------------------------*
START-OF-SELECTION.

REFRESH:T_YN120.
CLEAR:W_YN120.

SELECT *
FROM YN120
INTO TABLE T_YN120
WHERE LIST1 IN S_KUNNR
AND LIST4 = ''.

LOOP AT T_YN120 INTO W_YN120.

CLEAR:G_VKGRP.
SELECT SINGLE VKGRP
FROM KNVV
INTO G_VKGRP
WHERE KUNNR = W_YN120-LIST1
AND VKORG = '1000'
AND VTWEG = '10'
AND SPART = '10'.

IF SY-SUBRC = 0.
W_YN120-LIST4 = G_VKGRP.
MODIFY YN120 FROM W_YN120.
G_CNT = G_CNT + 1.
ENDIF.

ENDLOOP.

WRITE: /001 '<営業グループ設定>',
/003 '自社データ(売上)(YN120)件数：',
030 G_CNT,
040 '件'.
