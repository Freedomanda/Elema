*&---------------------------------------------------------------------*
*&  Include           ZEGFIR0040_T01
*&---------------------------------------------------------------------*

*----------------------------------------------------------------------*
* CONSTANTS
*----------------------------------------------------------------------*
CONSTANTS:
C_SHKZG_H TYPE BSEG-SHKZG VALUE 'H',  "貸方
C_SHKZG_S TYPE BSEG-SHKZG VALUE 'S',  "借方
C_EXTNAME   TYPE CHAR10     VALUE '.csv',  "CSVファイル
C_REPORTFORMAT  TYPE CHAR2 VALUE '20', "20：全項目出力フォーマット
C_SAPI14 TYPE PARTY VALUE 'SAPI14',  "パラメータタイプ
C_OUTPUTMODE_P TYPE ZEOUTPUTMODE VALUE 'P',  "出力モード = Print/Reprint
C_OUTPUTMODE_D TYPE ZEOUTPUTMODE VALUE 'D',  "出力モード = Download
C_LOCK_MODE(1)   TYPE C     VALUE 'E'.    " Lock mode

*----------------------------------------------------------------------*
* TYPES
*----------------------------------------------------------------------*
TYPES:
*  得意先
BEGIN OF TY_KUNNR,
KUNNR TYPE KUNNR,
END OF TY_KUNNR,
TY_T_KUNNR TYPE STANDARD TABLE OF TY_KUNNR,

BEGIN OF TY_BUKRS,
BUKRS TYPE BUKRS,
END OF TY_BUKRS,
TY_T_BUKRS TYPE STANDARD TABLE OF TY_BUKRS,

*  ADRC + 会社コード
BEGIN OF TY_T001_ADRC,
BUTXT TYPE T001-BUTXT,
POST_CODE1 TYPE ADRC-POST_CODE1,
STREET TYPE ADRC-STREET,
STR_SUPPL1 TYPE ADRC-STR_SUPPL1,
TEL_NUMBER TYPE ADRC-TEL_NUMBER,
FAX_NUMBER TYPE ADRC-FAX_NUMBER,
COUNTRY TYPE ADRC-COUNTRY,
PAVAL TYPE T001Z-PAVAL,  "Company TIN
END OF TY_T001_ADRC,

*  国コード - 小数点とデータ形式(SET COUNTRY)
BEGIN OF TY_T005X,
LAND TYPE T005X-LAND,
XDEZP TYPE T005X-XDEZP,
DATFM TYPE T005X-DATFM,
END OF TY_T005X,

*  会計伝票ヘッダ
BEGIN OF TY_BKPF,
BUKRS TYPE BKPF-BUKRS,
BELNR TYPE BKPF-BELNR,
GJAHR TYPE BKPF-GJAHR,
BUDAT TYPE BKPF-BUDAT,
USNAM TYPE BKPF-USNAM,
WAERS TYPE BKPF-WAERS,
END OF TY_BKPF,
TY_T_BKPF TYPE STANDARD TABLE OF TY_BKPF,

*  会計伝票明細
BEGIN OF TY_BSEG,
BUKRS TYPE BSEG-BUKRS,
BELNR TYPE BSEG-BELNR,
GJAHR TYPE BSEG-GJAHR,
BUZEI TYPE BSEG-BUZEI,
KUNNR TYPE BSEG-KUNNR,
WRBTR TYPE BSEG-WRBTR,
END OF TY_BSEG,
TY_T_BSEG TYPE STANDARD TABLE OF TY_BSEG,

*  会計伝票ヘッダ、会計伝票明細結合用
BEGIN OF TY_HKONT_BSEG,
BUKRS TYPE BSEG-BUKRS,
BELNR TYPE BSEG-BELNR,
GJAHR TYPE BSEG-GJAHR,
BUZEI TYPE BSEG-BUZEI,
HKONT TYPE BSEG-HKONT,
WRBTR TYPE BSEG-WRBTR,
END OF TY_HKONT_BSEG,
TY_T_HKONT_BSEG TYPE STANDARD TABLE OF TY_HKONT_BSEG,

*  ADRC + 得意先コード
BEGIN OF TY_KNA1_ADRC,
KUNNR TYPE KNA1-KUNNR,
STCD1 TYPE KNA1-STCD1,
NAME2 TYPE ADRC-NAME2,
NAME3 TYPE ADRC-NAME3,
NAME4 TYPE ADRC-NAME4,
POST_CODE1 TYPE ADRC-POST_CODE1,
CITY1 TYPE ADRC-CITY1,
STREET TYPE ADRC-STREET,
STR_SUPPL1 TYPE ADRC-STR_SUPPL1,
STR_SUPPL2 TYPE ADRC-STR_SUPPL2,
TEL_NUMBER TYPE ADRC-TEL_NUMBER,
FAX_NUMBER TYPE ADRC-FAX_NUMBER,
COUNTRY TYPE ADRC-COUNTRY,
END OF TY_KNA1_ADRC,
TY_T_KNA1_ADRC TYPE STANDARD TABLE OF TY_KNA1_ADRC,

*  Range Table
BEGIN OF TY_RANGE,
SIGN TYPE STRING,
OPTION TYPE STRING,
LOW TYPE STRING,
HIGH TYPE STRING,
END OF TY_RANGE,
TY_T_RANGE TYPE STANDARD TABLE OF TY_RANGE,

*  Message
BEGIN OF TYP_TH_MSG,
TYPE(15)        TYPE C,             " Message type
TEXT(128)       TYPE C,             " Message text
END OF TYP_TH_MSG,

*  Outputファイル
TY_T_FILE_OUT TYPE STANDARD TABLE OF ZSEGFI0003,
TY_T_ZTEGFIT004 TYPE STANDARD TABLE OF ZTEGFIT004,
TY_T_ZTEGFIT003 TYPE STANDARD TABLE OF ZTEGFIT003,
TY_T_ZTEGZZT001 TYPE STANDARD TABLE OF ZTEGZZT001.

*----------------------------------------------------------------------*
* DATA定義
*----------------------------------------------------------------------*
DATA:
W_DOCNO TYPE BSIS-BELNR,
W_HKONT TYPE BSIS-HKONT,
W_DOCTY TYPE BSIS-BLART,
W_POSTD TYPE BSIS-BUDAT,
W_ENTRYD TYPE BKPF-CPUDT,  "会計伝票登録日付
ST_MSG TYPE TYP_TH_MSG,  "Message Structure
TB_MSG TYPE STANDARD TABLE OF TYP_TH_MSG,  "Message Table
W_COUNT TYPE I,    "総件数
W_NORMAL TYPE I,  "正常件数
W_ERR TYPE I,        "エラー件数
W_OUTPUT_FN TYPE STRING.
