*&---------------------------------------------------------------------*
*& Include ZLP105MP002TOP                                    モジュール*
*&                                                                     *
*&---------------------------------------------------------------------*

PROGRAM   ZLP105MP002                                            .

TABLES /A1F/YLNS0011 .

*条件タイプ
CONSTANTS :
A1F_CNS_KSCHL LIKE T685A-KSCHL VALUE 'ZPR0' , "販売単価
** 2007/09/27 INSERT START
** 価格決定の切り上げ、切り捨ての条件タイプへの対応
A1F_CNS_KSCHL1 LIKE T685A-KSCHL VALUE 'ZPR1' , "販売単価
A1F_CNS_KSCHL2 LIKE T685A-KSCHL VALUE 'ZPR2' , "販売単価
** 2007/09/27 INSERT END
A1F_CNS_KSCHL_P LIKE T685A-KSCHL VALUE 'P000' , "購買単価
A1F_CNS_KSCHL_P2 LIKE T685A-KSCHL VALUE 'ZPB1' . "購買単価
*テキストID
CONSTANTS :
A1F_CNS_TDID_S01 LIKE RSTXT-TDID VALUE '9001' , "出荷指示備考
A1F_CNS_TDID_S02 LIKE RSTXT-TDID VALUE '0002' , "納品書備考
A1F_CNS_TDID_S03 LIKE RSTXT-TDID VALUE '0001' , "社内備考
A1F_CNS_TDID_S04 LIKE RSTXT-TDID VALUE '0001' , "発注番号挿入用
A1F_CNS_TDID_P01 LIKE RSTXT-TDID VALUE 'F05' , "EDI用備考
A1F_CNS_TDID_P02 LIKE RSTXT-TDID VALUE 'F01' , "EDI用その他
A1F_CNS_TDID_P03 LIKE RSTXT-TDID VALUE 'F02' , "注文書用備考
A1F_CNS_TDID_P04 LIKE RSTXT-TDID VALUE 'F03' , "住電EDI備考
A1F_CNS_TDID_P05 LIKE RSTXT-TDID VALUE 'F04' , "発注残一覧備考
A1F_CNS_TDID_P06 LIKE RSTXT-TDID VALUE 'F06' . "仕入先品目コード
*購買発注伝票タイプ
CONSTANTS :
A1F_CNS_DOC_TYPE LIKE BAPIMEPOHEADER-DOC_TYPE VALUE 'NB' .
*明細カテゴリの分別用
RANGES : A1F_RG_PSTYV_TAN FOR VBAP-PSTYV ,
A1F_RG_PSTYV_TAB FOR VBAP-PSTYV .
*明細番号初期値
CONSTANTS :
A1F_CNS_NUMBER_S LIKE BAPISDITM-ITM_NUMBER VALUE '000010' , "販売
A1F_CNS_NUMBER_P LIKE BAPIMEPOITEM-PO_ITEM VALUE '00010' . "購買
*換算レートタイプ
CONSTANTS :
A1F_CNS_RATE_TYPE LIKE BAPI1093_1-RATE_TYPE VALUE 'M' .


DATA : A1F_WG_KNMT LIKE KNMT ,
A1F_WG_MBEW LIKE MBEW ,
A1F_WG_T001 LIKE T001 ,
A1F_WG_MARA LIKE MARA ,
A1F_WG_MVKE LIKE MVKE ,
A1F_WG_MARC LIKE MARC ,
A1F_WG_KNA1 LIKE KNA1 ,
A1F_WG_KNVV LIKE KNVV ,
A1F_WG_LFA1 LIKE LFA1 ,
A1F_WG_LFM1 LIKE LFM1 ,
A1F_WG_ORDER_HEADER_IN_SIM LIKE BAPISDHEAD ,
A1F_WG_SOLD_TO_PARTY_SIM   LIKE BAPISOLDTO ,
A1F_WG_SHIP_TO_PARTY_SIM   LIKE BAPISHIPTO ,
A1F_WG_BILLING_PARTY_SIM   LIKE BAPIPAYER  ,
A1F_WG_RETURN_SIM          LIKE BAPIRETURN .

DATA : A1F_TG_KNVP LIKE TABLE OF KNVP WITH HEADER LINE ,
A1F_TG_ORDER_ITEMS_IN_SIM      LIKE TABLE OF BAPIITEMIN WITH
HEADER LINE ,
A1F_TG_ORDER_PARTNERS_SIM      LIKE TABLE OF BAPIPARTNR WITH
HEADER LINE ,
A1F_TG_ORDER_SCHEDULE_IN_SIM   LIKE TABLE OF BAPISCHDL WITH
HEADER LINE ,
A1F_TG_ORDER_ITEMS_OUT_SIM     LIKE TABLE OF BAPIITEMEX WITH
HEADER LINE ,
A1F_TG_ORDER_SCHEDULE_EX_SIM   LIKE TABLE OF BAPISDHEDU WITH
HEADER LINE ,
A1F_TG_ORDER_CONDITION_EX_SIM  LIKE TABLE OF BAPICOND WITH HEADER
LINE ,
A1F_TG_ORDER_INCOMPLETE_SIM    LIKE TABLE OF BAPIINCOMP WITH
HEADER LINE ,
A1F_TG_MESSAGETABLE_SIM        LIKE TABLE OF BAPIRET2 WITH HEADER
LINE ,
A1F_TG_PARTNERADDRESSES_SIM    LIKE TABLE OF BAPIADDR1 WITH
HEADER LINE .

DATA : A1F_TG_INFORECORD_GENERAL      LIKE TABLE OF BAPIEINA WITH HEADER
LINE ,
A1F_TG_INFORECORD_PURCHORG     LIKE TABLE OF BAPIEINE WITH HEADER
LINE ,
A1F_TG_RETURN_PURC_INFO        LIKE TABLE OF BAPIRETURN WITH
HEADER LINE .

DATA : A1F_WG_POHEADER          LIKE BAPIMEPOHEADER  ,
A1F_WG_POHEADERX         LIKE BAPIMEPOHEADERX  ,
A1F_WG_POADDRVENDOR      LIKE BAPIMEPOADDRVENDOR  ,
A1F_WG_TESTRUN           LIKE BAPIFLAG-BAPIFLAG  ,
A1F_WG_MEMORY_UNCOMPLETE LIKE BAPIFLAG-BAPIFLAG  ,
A1F_WG_MEMORY_COMPLETE   LIKE BAPIFLAG-BAPIFLAG  ,
A1F_WG_NO_MESSAGING      LIKE BAPIFLAG-BAPIFLAG  ,
A1F_WG_NO_MESSAGE_REQ    LIKE BAPIFLAG-BAPIFLAG  ,
A1F_WG_NO_AUTHORITY      LIKE BAPIFLAG-BAPIFLAG  ,
A1F_WG_NO_PRICE_FROM_PO  LIKE BAPIFLAG-BAPIFLAG  ,
A1F_WG_EXPPURCHASEORDER  LIKE BAPIMEPOHEADER-PO_NUMBER ,
A1F_WG_EXPHEADER         LIKE BAPIMEPOHEADER.

DATA : A1F_TG_RETURN_PURC      LIKE TABLE OF BAPIRET2 WITH HEADER LINE ,
A1F_TG_POITEM     LIKE TABLE OF BAPIMEPOITEM WITH HEADER LINE ,
A1F_TG_POITEMX LIKE TABLE OF BAPIMEPOITEMX WITH HEADER LINE ,
A1F_TG_POADDRDELIVERY LIKE TABLE OF BAPIMEPOADDRDELIVERY WITH
HEADER LINE ,
A1F_TG_POSCHEDULE LIKE TABLE OF BAPIMEPOSCHEDULE WITH HEADER LINE
,
A1F_TG_POSCHEDULEX LIKE TABLE OF BAPIMEPOSCHEDULX WITH HEADER
LINE ,
A1F_TG_POACCOUNT LIKE TABLE OF BAPIMEPOACCOUNT WITH HEADER LINE ,
A1F_TG_POACCOUNTPROFITSEGMENT LIKE TABLE OF
BAPIMEPOACCOUNTPROFITSEGMENT WITH HEADER LINE ,
A1F_TG_POACCOUNTX LIKE TABLE OF BAPIMEPOACCOUNTX WITH HEADER LINE
,
*{   DELETE         TEDK906558                                        1
*\     A1F_TG_POCONDHEADER LIKE TABLE OF BAPIMEPOCONDHEADER WITH HEADER
*\       LINE ,
*\       A1F_TG_POCONDHEADERX LIKE TABLE OF BAPIMEPOCONDHEADERX WITH
*\       HEADER LINE ,
*}   DELETE
A1F_TG_POCOND LIKE TABLE OF BAPIMEPOCOND WITH HEADER LINE ,
A1F_TG_POCONDX LIKE TABLE OF BAPIMEPOCONDX WITH HEADER LINE ,
A1F_TG_POLIMITS LIKE TABLE OF BAPIESUHC WITH HEADER LINE ,
A1F_TG_POCONTRACTLIMITS LIKE TABLE OF BAPIESUCC WITH HEADER LINE
,
A1F_TG_POSERVICES LIKE TABLE OF BAPIESLLC WITH HEADER LINE ,
A1F_TG_POSRVACCESSVALUES LIKE TABLE OF BAPIESKLC WITH HEADER LINE
,
A1F_TG_POSERVICESTEXT LIKE TABLE OF BAPIESLLTX WITH HEADER LINE ,
A1F_TG_EXTENSIONIN LIKE TABLE OF BAPIPAREX WITH HEADER LINE ,
A1F_TG_EXTENSIONOUT LIKE TABLE OF BAPIPAREX WITH HEADER LINE ,
*     A1F_TG_POTEXTHEADER LIKE TABLE OF BAPIMEPOTEXTHEADER WITH HEADER
*       LINE ,
*     A1F_TG_POTEXTITEM LIKE TABLE OF BAPIMEPOTEXT WITH HEADER LINE ,
A1F_TG_POPARTNER LIKE TABLE OF BAPIEKKOP WITH HEADER LINE .

DATA : A1F_WG_WARNING_CNT(3) .
DATA : A1F_WG_MASTER_TANKA_SALE LIKE /A1F/YLNS0011-YL_JTYUTNK .
DATA : A1F_WG_MASTER_TANKA_PURC LIKE /A1F/YLNS0011-YL_HTYUTNK .

DATA : A1F_TG_LINES_YL_EDIBKU  LIKE TABLE OF TLINE WITH HEADER LINE ,
A1F_TG_LINES_YL_TUMNSYBKU LIKE TABLE OF TLINE WITH HEADER LINE .
** 2007/07/20 INSERT START
** 出荷先住所変更対応
TYPES: BEGIN OF SZADR_ADDR1_LINE,
NATION LIKE ADRC-NATION,
DATA LIKE ADDR1_DATA,
END OF SZADR_ADDR1_LINE,
BEGIN OF SZADR_ADTEL_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADTEL LIKE ADTEL,
END OF SZADR_ADTEL_LINE,
BEGIN OF SZADR_ADFAX_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADFAX LIKE ADFAX,
END OF SZADR_ADFAX_LINE,
BEGIN OF SZADR_ADTTX_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADTTX LIKE ADTTX,
END OF SZADR_ADTTX_LINE,
BEGIN OF SZADR_ADTLX_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADTLX LIKE ADTLX,
END OF SZADR_ADTLX_LINE,
BEGIN OF SZADR_ADSMTP_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADSMTP LIKE ADSMTP,
END OF SZADR_ADSMTP_LINE,
BEGIN OF SZADR_ADRML_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADRML LIKE ADRML,
END OF SZADR_ADRML_LINE,
BEGIN OF SZADR_ADX400_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADX400 LIKE ADX400,
END OF SZADR_ADX400_LINE,
BEGIN OF SZADR_ADRFC_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADRFC LIKE ADRFC,
END OF SZADR_ADRFC_LINE,
BEGIN OF SZADR_ADPRT_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADPRT LIKE ADPRT,
END OF SZADR_ADPRT_LINE,
BEGIN OF SZADR_ADSSF_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADSSF LIKE ADSSF,
END OF SZADR_ADSSF_LINE,
BEGIN OF SZADR_ADURI_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADURI LIKE ADURI,
END OF SZADR_ADURI_LINE,
BEGIN OF SZADR_ADPAG_LINE,
DATE_FROM LIKE ADRC-DATE_FROM,
ADPAG LIKE ADPAG,
END OF SZADR_ADPAG_LINE,
BEGIN OF SZADR_ADRCT_LINE,
ADDR_REM LIKE ADDR_REM,
END OF SZADR_ADRCT_LINE,
BEGIN OF SZADR_ADRT_LINE,
ADCOMREM LIKE ADCOMREM,
END OF SZADR_ADRT_LINE.


TYPES: BEGIN OF SZADR_ADDR1_COMPLETE,
ADDRNUMBER LIKE ADDR1_SEL-ADDRNUMBER,
ADDRHANDLE LIKE ADDR1_SEL-ADDRHANDLE,
ADDR1_TAB TYPE SZADR_ADDR1_LINE OCCURS 0,
ADTEL_TAB TYPE SZADR_ADTEL_LINE OCCURS 0,
ADFAX_TAB TYPE SZADR_ADFAX_LINE OCCURS 0,
ADTTX_TAB TYPE SZADR_ADTTX_LINE OCCURS 0,
ADTLX_TAB TYPE SZADR_ADTLX_LINE OCCURS 0,
ADSMTP_TAB TYPE SZADR_ADSMTP_LINE OCCURS 0,
ADRML_TAB TYPE SZADR_ADRML_LINE OCCURS 0,
ADX400_TAB TYPE SZADR_ADX400_LINE OCCURS 0,
ADRFC_TAB TYPE SZADR_ADRFC_LINE OCCURS 0,
ADPRT_TAB TYPE SZADR_ADPRT_LINE OCCURS 0,          "*178i
ADSSF_TAB TYPE SZADR_ADSSF_LINE OCCURS 0,          "*178i
ADURI_TAB TYPE SZADR_ADURI_LINE OCCURS 0,          "*178i
ADPAG_TAB TYPE SZADR_ADPAG_LINE OCCURS 0,          "*178i
ADRCT_TAB TYPE SZADR_ADRCT_LINE OCCURS 0,
ADRT_TAB TYPE SZADR_ADRT_LINE OCCURS 0,
END OF SZADR_ADDR1_COMPLETE.

TYPES: BEGIN OF LV09A_ATTRIBUTES_WA,
ABLAD LIKE VBPA-ABLAD,
STCEG LIKE KNA1-STCEG,
STCD1 LIKE VBPAVB-STCD1,
STCD2 LIKE VBPAVB-STCD2,
STCD3 LIKE VBPAVB-STCD3,
STCD4 LIKE VBPAVB-STCD4,
STKZN LIKE VBPAVB-STKZN,
STCDT LIKE VBPAVB-STCDT,
J_1KFREPRE LIKE VBPAVB-J_1KFREPRE,
J_1KFTBUS LIKE VBPAVB-J_1KFTBUS,
J_1KFTIND LIKE VBPAVB-J_1KFTIND         .
TYPES: END OF LV09A_ATTRIBUTES_WA.
DATA A1F_WG_FEF_ATTRIBUTES TYPE LV09A_ATTRIBUTES_WA .
DATA A1F_WG_FES_ADDR1_COMPLETE TYPE SZADR_ADDR1_COMPLETE .
DATA A1F_WG_FES_VBADR TYPE VBADR .

DATA A1F_WG_ADDR1_OUT LIKE ADDR1_DATA .
** 2007/07/20 INSERT END
** 2007/07/21 INSERT START
** 発注のみ実施する機能の追加
** 発注のみを実施する機能を追加し、発注のみの場合は販売関連
** の情報の入力を不要とする。
DATA  A1F_WG_ONLYPO_FLG.
** 2007/07/21 INSERT END
** 2007/07/21 INSERT START
** 出荷指示備考の取得
** 得意先品目情報マスタの得意先品目情報テキストから取得し表示する
DATA : A1F_TG_LINES_YL_SYKSJBKU  LIKE TABLE OF TLINE WITH HEADER LINE .
** 2007/07/21 INSERT END
