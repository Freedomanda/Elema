REPORT ZTEST_MKPF_MSEG_1 .

TABLES:MKPF,MSEG.
SELECT-OPTIONS:
S_BUDAT FOR MKPF-BUDAT OBLIGATORY,
S_MBLNR FOR MKPF-MBLNR,
S_MJAHR FOR MKPF-MJAHR,
S_BLDAT FOR MKPF-BLDAT,
S_CPUDT FOR MKPF-CPUDT,
S_CPUTM FOR MKPF-CPUTM,
S_AEDAT FOR MKPF-AEDAT,
S_USNAM FOR MKPF-USNAM,
S_MATNR FOR MSEG-MATNR,
S_WERKS FOR MSEG-WERKS,
S_BWART FOR MSEG-BWART,
S_LIFNR FOR MSEG-LIFNR,
S_KUNNR FOR MSEG-KUNNR.

TYPES:BEGIN OF T_MKPF,
MBLNR  TYPE MKPF-MBLNR,
MJAHR  TYPE MKPF-MJAHR,
BLDAT  TYPE MKPF-BLDAT,
BUDAT  TYPE MKPF-BUDAT,
CPUDT  TYPE MKPF-CPUDT,
CPUTM  TYPE MKPF-CPUTM,
AEDAT  TYPE MKPF-AEDAT,
USNAM  TYPE MKPF-USNAM,
BWART  TYPE MSEG-BWART,
MATNR  TYPE MSEG-MATNR,
WERKS  TYPE MSEG-WERKS,
LIFNR  TYPE MSEG-LIFNR,
KUNNR  TYPE MSEG-KUNNR,
KDAUF  TYPE MSEG-KDAUF,
DMBTR  TYPE MSEG-DMBTR,
ERFMG  TYPE MSEG-ERFMG,
EBELN  TYPE MSEG-EBELN,
END OF T_MKPF.

DATA:IT_MKPF TYPE TABLE OF T_MKPF,
WA_MKPF TYPE T_MKPF,
CNT     TYPE I.


SELECT MKPF~MBLNR
MKPF~MJAHR
MKPF~BLDAT
MKPF~BUDAT
MKPF~CPUDT
MKPF~CPUTM
MKPF~AEDAT
MKPF~USNAM
MSEG~BWART
MSEG~MATNR
MSEG~WERKS
MSEG~LIFNR
MSEG~KUNNR
MSEG~KDAUF
MSEG~DMBTR
MSEG~ERFMG
MSEG~EBELN
INTO TABLE IT_MKPF
FROM MKPF
INNER JOIN MSEG
ON MKPF~MBLNR = MSEG~MBLNR
AND MKPF~MJAHR = MSEG~MJAHR
WHERE MKPF~BUDAT IN S_BUDAT
AND MKPF~MBLNR IN S_MBLNR
AND MKPF~MJAHR IN S_MJAHR
AND MKPF~BLDAT IN S_BLDAT
AND MKPF~CPUDT IN S_CPUDT
AND MKPF~CPUTM IN S_CPUTM
AND MKPF~AEDAT IN S_AEDAT
AND MKPF~USNAM IN S_USNAM
AND MSEG~MATNR IN S_MATNR
AND MSEG~WERKS IN S_WERKS
AND MSEG~BWART IN S_BWART
AND MSEG~LIFNR IN S_LIFNR
AND MSEG~KUNNR IN S_KUNNR.

IF SY-SUBRC = 0.
DESCRIBE TABLE IT_MKPF LINES CNT.
WRITE CNT.
ENDIF.
