REPORT ZTEST_ARAI11 .

DATA : ZNEN002_TB LIKE TABLE OF ZNEN002.
DATA : ZNEN002_WK LIKE ZNEN002.
DATA : EKGRP_WK LIKE MARC-EKGRP.

SELECT * FROM ZNEN002
INTO TABLE ZNEN002_TB
WHERE ZANDT = '20100131'.

WRITE : / 'チェック開始'.

LOOP AT ZNEN002_TB INTO ZNEN002_WK.

*プラント下3桁と営業所頭3桁のチェック
IF ZNEN002_WK-WERKS+1(3) NE ZNEN002_WK-VKBUR+0(3).
WRITE : / '営業所相違1' , ZNEN002_WK-MATNR , ZNEN002_WK-WERKS.
ENDIF.

*営業所下一桁の0チェック
IF ZNEN002_WK-VKBUR+3(1) NE '0'.
WRITE : / '営業所相違2' , ZNEN002_WK-MATNR , ZNEN002_WK-WERKS.
ENDIF.

*営業グループチェック
SELECT SINGLE EKGRP INTO EKGRP_WK
FROM MARC
WHERE MATNR = ZNEN002_WK-MATNR
AND WERKS = ZNEN002_WK-WERKS.

IF EKGRP_WK NE ZNEN002_WK-VKGRP.
WRITE : / '営業所グループ2' , ZNEN002_WK-MATNR , ZNEN002_WK-WERKS.
ENDIF.


ENDLOOP.

WRITE : / 'チェック終了'.
