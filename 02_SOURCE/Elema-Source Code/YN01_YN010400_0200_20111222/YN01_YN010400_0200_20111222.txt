*&---------------------------------------------------------------------*
*&  INCLUDE           YN01_YN010400_0200
*&---------------------------------------------------------------------*

* ALV属性(入力画面の列ID)
CONSTANTS: C_ALV_COL2_GJAHR       TYPE I VALUE 0,  " 会計年度
C_ALV_COL2_VRFCTON     TYPE I VALUE 1,  " 取引先コード
C_ALV_COL2_VRFCTONNAME TYPE I VALUE 2,  " 取引先名称
C_ALV_COL2_BUKRS       TYPE I VALUE 3,  " 会社コード
C_ALV_COL2_ZFBDT       TYPE I VALUE 4,  " 日付
C_ALV_COL2_PRCTR       TYPE I VALUE 5,  " 利益センタ
C_ALV_COL2_PRCTRNAME   TYPE I VALUE 6,  " 利益センタ名称
C_ALV_COL2_PERNR       TYPE I VALUE 7,  " 担当者
* elematec 対応 2011/12/07 ADD >>>
C_ALV_COL2_PERNRNAME   TYPE I VALUE 8,  " 担当者名称
C_ALV_COL2_DVSON       TYPE I VALUE 9,  " プラント
C_ALV_COL2_DVSONNAME   TYPE I VALUE 10, " プラント名称
C_ALV_COL2_SGTXT       TYPE I VALUE 11, " コメント
C_ALV_COL2_KNQUAN      TYPE I VALUE 12, " 数量
C_ALV_COL2_KNUNIT      TYPE I VALUE 13, " 単位
C_ALV_COL2_KNUNTPRC    TYPE I VALUE 14, " 単価
C_ALV_COL2_KNTAXAMT    TYPE I VALUE 15, " 消費税額
C_ALV_COL2_KNITXAMT    TYPE I VALUE 16, " 税抜金額
C_ALV_COL2_KNETXAMT    TYPE I VALUE 17, " 税込金額
C_ALV_COL2_WAERS       TYPE I VALUE 18, " 通貨コード
C_ALV_COL2_CKEY1       TYPE I VALUE 19, " 照合キー1：発注番号
C_ALV_COL2_CKEY2       TYPE I VALUE 20, " 照合キー2：ｲﾝﾎﾞｲｽ
C_ALV_COL2_CKEY3       TYPE I VALUE 21, " 照合キー3
C_ALV_COL2_CKEY4       TYPE I VALUE 22, " 照合キー4
C_ALV_COL2_CKEY5       TYPE I VALUE 23, " 照合キー5
C_ALV_COL2_CKEY6       TYPE I VALUE 24, " 照合キー6
C_ALV_COL2_CKEY7       TYPE I VALUE 25, " 照合キー7
C_ALV_COL2_CKEY8       TYPE I VALUE 26, " 照合キー8
C_ALV_COL2_LIST1       TYPE I VALUE 27, " 発注仕入先
C_ALV_COL2_LIST2       TYPE I VALUE 28, " 発注番号
C_ALV_COL2_LIST3       TYPE I VALUE 29, " 発注明細番号
C_ALV_COL2_LIST4       TYPE I VALUE 30, " 購買グループ
C_ALV_COL2_LIST5       TYPE I VALUE 31, " 品目コード
C_ALV_COL2_LIST6       TYPE I VALUE 32, " 品目テキスト
C_ALV_COL2_LIST7       TYPE I VALUE 33, " 仕入先品目
C_ALV_COL2_LIST8       TYPE I VALUE 34, " インボイスNo
C_ALV_COL2_LIST9       TYPE I VALUE 35, " 一覧表示項目9
C_ALV_COL2_LIST10      TYPE I VALUE 36, " 一覧表示項目10
C_ALV_COL2_LDATE1      TYPE I VALUE 37, " 請求日
**           C_ALV_COL2_DVSON       TYPE I VALUE 8,  " 部門
**           C_ALV_COL2_SGTXT       TYPE I VALUE 9,  " コメント
**           C_ALV_COL2_KNQUAN      TYPE I VALUE 10, " 数量
**           C_ALV_COL2_KNUNIT      TYPE I VALUE 11, " 単位
**           C_ALV_COL2_KNUNTPRC    TYPE I VALUE 12, " 単価
**           C_ALV_COL2_KNTAXAMT    TYPE I VALUE 13, " 消費税額
**           C_ALV_COL2_KNITXAMT    TYPE I VALUE 14, " 税抜金額
**           C_ALV_COL2_KNETXAMT    TYPE I VALUE 15, " 税込金額
**           C_ALV_COL2_WAERS       TYPE I VALUE 16, " 通貨コード
**           C_ALV_COL2_CKEY1       TYPE I VALUE 17, " 得意先発注番号
**           C_ALV_COL2_CKEY2       TYPE I VALUE 18, " 取引先品目コード
**           C_ALV_COL2_CKEY3       TYPE I VALUE 19, " 照合キー3
**           C_ALV_COL2_CKEY4       TYPE I VALUE 20, " 照合キー4
**           C_ALV_COL2_CKEY5       TYPE I VALUE 21, " 照合キー5
**           C_ALV_COL2_CKEY6       TYPE I VALUE 22, " 照合キー6
**           C_ALV_COL2_CKEY7       TYPE I VALUE 23, " 照合キー7
**           C_ALV_COL2_CKEY8       TYPE I VALUE 24, " 照合キー8
**           C_ALV_COL2_LIST1       TYPE I VALUE 25, " 自社品目コード
**           C_ALV_COL2_LIST2       TYPE I VALUE 26, " 品名
**           C_ALV_COL2_LIST3       TYPE I VALUE 27, " 受注先コード
**           C_ALV_COL2_LIST4       TYPE I VALUE 28, " 得意発注明細番号
**           C_ALV_COL2_LIST5       TYPE I VALUE 29, " 一覧表示項目5
**           C_ALV_COL2_LIST6       TYPE I VALUE 30, " 一覧表示項目6
**           C_ALV_COL2_LIST7       TYPE I VALUE 31, " 一覧表示項目7
**           C_ALV_COL2_LIST8       TYPE I VALUE 32, " 一覧表示項目8
**           C_ALV_COL2_LIST9       TYPE I VALUE 33, " 一覧表示項目9
**           C_ALV_COL2_LIST10      TYPE I VALUE 34, " 一覧表示項目10
* elematec 対応 2011/12/07 ADD <<<
C_ALV_COL2_OLDGJAHR    TYPE I VALUE 9999, " 元会計年度
C_ALV_COL2_OLDSLPDOC   TYPE I VALUE 9999, " 元外部番号
C_ALV_COL2_OLDDTLDOC   TYPE I VALUE 9999, " 元外部明細番号
C_ALV_COL2_COLORS      TYPE I VALUE 9999. "

*&---------------------------------------------------------------------*
*&   クラス定義　
*&---------------------------------------------------------------------*
CLASS CLS_EVENT_RECIEVER_0200 DEFINITION.
PUBLIC SECTION.
METHODS HANDLE_TOOLBAR
FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID
IMPORTING E_OBJECT E_INTERACTIVE.
METHODS HANDLE_DATA_CHANGED
FOR EVENT DATA_CHANGED OF CL_GUI_ALV_GRID
IMPORTING ER_DATA_CHANGED.
METHODS HANDLE_DATA_CHANGED_FINISHED
FOR EVENT DATA_CHANGED_FINISHED OF CL_GUI_ALV_GRID
IMPORTING E_MODIFIED.
METHODS HANDLE_F4
FOR EVENT ONF4 OF CL_GUI_ALV_GRID
IMPORTING E_FIELDNAME
ES_ROW_NO
ER_EVENT_DATA.
METHODS HANDLE_BEFORE_USER_COMMAND
FOR EVENT BEFORE_USER_COMMAND OF CL_GUI_ALV_GRID
IMPORTING E_UCOMM.
METHODS HANDLE_AFTER_USER_COMMAND
FOR EVENT AFTER_USER_COMMAND OF CL_GUI_ALV_GRID
IMPORTING E_UCOMM.
*&Ver2 対応 2007/02/28 >>> 外部データ入力の明細コピーボタンの追加
METHODS HANDLE_USER_COMMAND
FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID
IMPORTING E_UCOMM.
*&Ver2 対応 2007/02/28 <<<
ENDCLASS.

CLASS CLS_EVENT_RECIEVER_0200 IMPLEMENTATION.
METHOD HANDLE_TOOLBAR.
PERFORM CUSTOMIZE_TOOLBAR_0200 USING E_OBJECT.
ENDMETHOD.
METHOD HANDLE_DATA_CHANGED.
PERFORM CHANGE_T_ALV_CHECKER_0200 USING ER_DATA_CHANGED.
PERFORM CHECK_INPUT_DATA_0200.
ENDMETHOD.
METHOD HANDLE_DATA_CHANGED_FINISHED.
* elematec 対応 2011/12/07 ADD >>>
IF P_PRCHS = C_ON.
PERFORM SET_T_GRID_DATA_0200_DEFAULT_M.
ENDIF.
* elematec 対応 2011/12/07 ADD <<<
PERFORM SET_T_ALV_CHECKER_0200.
PERFORM SET_T_GRID_DATA_0200_TEXT.
PERFORM PROCESS_EVENT_ENTER.
ENDMETHOD.
METHOD HANDLE_F4.
PERFORM F4_INPUT_0200 USING E_FIELDNAME
ES_ROW_NO
ER_EVENT_DATA.
ENDMETHOD.
METHOD HANDLE_BEFORE_USER_COMMAND.
IF E_UCOMM = CL_GUI_ALV_GRID=>MC_FC_MAINTAIN_VARIANT.
PERFORM SET_VISIBLE_0200 USING ' '.
ENDIF.
IF E_UCOMM = CL_GUI_ALV_GRID=>MC_FC_PRINT_BACK AND
SY-SAPRL = '46C'.
PERFORM SET_VISIBLE_0200 USING ' '.
ENDIF.
ENDMETHOD.
METHOD HANDLE_AFTER_USER_COMMAND.
IF E_UCOMM = CL_GUI_ALV_GRID=>MC_FC_MAINTAIN_VARIANT.
PERFORM SET_VISIBLE_0200 USING 'X'.
ENDIF.
IF E_UCOMM = CL_GUI_ALV_GRID=>MC_FC_PRINT_BACK AND
SY-SAPRL = '46C'.
PERFORM SET_VISIBLE_0200 USING 'X'.
ENDIF.
ENDMETHOD.
*&Ver2 対応 2007/02/28 >>> 外部データ入力の明細コピーボタンの追加
METHOD HANDLE_USER_COMMAND.
PERFORM EXECUTE_USER_COMMAND_0200 USING E_UCOMM.
ENDMETHOD.
*&Ver2 対応 2007/02/28 <<<
ENDCLASS.

CLASS CLS_EVENT_RECIEVER_LOG DEFINITION.
PUBLIC SECTION.
METHODS HANDLE_DOUBLE_CLICK
FOR EVENT DOUBLE_CLICK OF CL_GUI_ALV_GRID
IMPORTING E_ROW.
ENDCLASS.

CLASS CLS_EVENT_RECIEVER_LOG IMPLEMENTATION.
METHOD HANDLE_DOUBLE_CLICK.
PERFORM SET_SELECTED_CELL_0200 USING E_ROW.
ENDMETHOD.
ENDCLASS.

*&---------------------------------------------------------------------*
*&   オブジェクト定義　
*&---------------------------------------------------------------------*
DATA: OBJ_GRID_0200             TYPE REF TO CL_GUI_ALV_GRID,
OBJ_SPLITTER_CONTAINER TYPE REF TO CL_GUI_EASY_SPLITTER_CONTAINER,
OBJ_APPLOG_CONTAINER TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
OBJ_GRID_LOG              TYPE REF TO CL_GUI_ALV_GRID,
OBJ_EVENT_RECIEVER_0200   TYPE REF TO CLS_EVENT_RECIEVER_0200,
OBJ_EVENT_RECIEVER_LOG    TYPE REF TO CLS_EVENT_RECIEVER_LOG.

* ALV一覧表示用レイアウト（入力画面）
DATA: S_VARIANT_0200 TYPE DISVARIANT.
* ALV一覧表示用レイアウト（入力画面）
DATA: S_LAYOUT_0200 TYPE LVC_S_LAYO.
* ALV一覧表示用レイアウト（入力画面）
DATA: S_LAYOUT_LOG TYPE LVC_S_LAYO.
* ALV一覧表示用項目内部テーブル（入力画面）
DATA: T_FCAT_0200 TYPE LVC_T_FCAT.
* ALV一覧表示用項目内部テーブル（入力画面）
DATA: T_FCAT_LOG TYPE LVC_T_FCAT.
* ALV一覧項目F4対応内部テーブル（入力画面）
DATA: T_F4_0200 TYPE STANDARD TABLE OF LVC_S_F4.
* ALV一覧項目COLOR対応内部テーブル（入力画面）
DATA: T_COLOR_0200 TYPE LVC_T_SCOL.
* ALV一覧表示用除外ツール内部テーブル（入力画面）
DATA: T_TOOLBAR_0200 TYPE UI_FUNCTIONS.

TYPES: BEGIN OF TYP_GRID_DATA_0200,
YNBUKRS           LIKE YN110-BUKRS,    " 会社コード
YNGJAHR           LIKE YN110-GJAHR,    " 会計年度
YNVRFCTON         LIKE YN110-VRFCTON,  " 取引先コード
YNVRFCTONNAME(35) TYPE C,              " 取引先名称
YNZFBDT           LIKE YN110-ZFBDT,    " 日付
YNPRCTR           LIKE YN110-PRCTR,    " 利益センタ
YNPRCTRNAME       TYPE YNPRCTRNAME,    " 利益センタ名称
YNPERNR           LIKE YN110-PERNR,    " 担当者
* elematec 対応 2011/12/07 ADD >>>
YNPERNRNAME(80)   TYPE C,              " 担当者名
* elematec 対応 2011/12/07 ADD <<<
YNDVSON           LIKE YN110-DVSON,    " 部門
* elematec 対応 2011/12/07 ADD >>>
YNDVSONNAME(30)   TYPE C,              " プラント名
* elematec 対応 2011/12/07 ADD <<<
YNSGTXT           LIKE YN110-COMMT,    " コメント
YNKNQUAN          LIKE YN110-KNQUAN,   " 数量
YNKNUNIT          LIKE YN110-KNUNIT,   " 単位
YNKNUNTPRC        LIKE YN110-KNUNTPRC, " 単価
YNKNTAXAMT        LIKE YN110-KNTAXAMT, " 消費税額
YNKNITXAMT        LIKE YN110-KNITXAMT, " 税抜金額
YNKNETXAMT        LIKE YN110-KNETXAMT, " 税込金額
YNWAERS           LIKE YN110-WAERS,    " 通貨コード
YNOLDGJAHR        LIKE YN110-OLDGJAHR, " 元会計年度
YNOLDSLPDOC       LIKE YN110-OLDSLPDOC," 元外部番号
YNOLDDTLDOC       LIKE YN110-OLDDTLDOC," 元外部明細番号
YNCKEY1           LIKE YN110-CKEY1,    " 得意先発注番号
YNCKEY2           LIKE YN110-CKEY2,    " 取引先品目コード
YNCKEY3           LIKE YN110-CKEY3,    " 照合キー3
YNCKEY4           LIKE YN110-CKEY4,    " 照合キー4
YNCKEY5           LIKE YN110-CKEY5,    " 照合キー5
YNCKEY6           LIKE YN110-CKEY6,    " 照合キー6
YNCKEY7           LIKE YN110-CKEY7,    " 照合キー7
YNCKEY8           LIKE YN110-CKEY8,    " 照合キー8
YNLIST1           LIKE YN110-LIST1,    " 自社品目コード
YNLIST2           LIKE YN110-LIST2,    " 品名
YNLIST3           LIKE YN110-LIST3,    " 受注先コード
YNLIST4           LIKE YN110-LIST4,    " 得意発注明細番号
YNLIST5           LIKE YN110-LIST5,    " 一覧表示項目5
YNLIST6           LIKE YN110-LIST6,    " 一覧表示項目6
YNLIST7           LIKE YN110-LIST7,    " 一覧表示項目7
YNLIST8           LIKE YN110-LIST8,    " 一覧表示項目8
YNLIST9           LIKE YN110-LIST9,    " 一覧表示項目9
YNLIST10          LIKE YN110-LIST10,   " 一覧表示項目10
* elematec 対応 2011/12/07 ADD >>>
YNLDATE1          LIKE YN110-LDATE1,   " 請求日
* elematec 対応 2011/12/07 ADD <<<
YNCOLORS          TYPE LVC_T_SCOL,
END OF TYP_GRID_DATA_0200.

* ALV一覧表示用内部テーブル（入力画面）
DATA: T_GRID_DATA_0200 TYPE STANDARD TABLE OF TYP_GRID_DATA_0200.

TYPES: BEGIN OF TYP_ALV_CHECKER_0200,
LINNO             TYPE I,
ROW_ID            TYPE I,
YNBUKRS           LIKE YN110-BUKRS,    " 会社コード
YNGJAHR(4)        TYPE C,              " 会計年度
YNVRFCTON         LIKE YN110-VRFCTON,  " 取引先コード
YNZFBDT(10)       TYPE C,              " 日付
YNPRCTR           LIKE YN110-PRCTR,    " 利益センタ
YNKNQUAN(15)      TYPE C,              " 数量
YNKNUNTPRC(21)    TYPE C,              " 単価
YNKNTAXAMT(21)    TYPE C,              " 消費税額
YNKNITXAMT(21)    TYPE C,              " 税抜金額
YNKNETXAMT(21)    TYPE C,              " 税込金額
YNWAERS           LIKE YN110-WAERS,    " 通貨コード
* elematec 対応 2011/12/07 ADD >>>
YNDVSON           LIKE YN110-DVSON,    " プラント(ロック用)
YNLIST2           LIKE YN110-LIST2,    " 発注番号
YNLDATE1          LIKE YN110-LDATE1,   " 照合締日
YNLIST1           LIKE YN110-LIST1,    " 発注先
YNLIST8           LIKE YN110-LIST8,    " ｲﾝﾎﾞｲｽNO
* elematec 対応 2011/12/07 ADD <<<
END OF TYP_ALV_CHECKER_0200.

* ALV一覧チェック用内部テーブル（入力画面）
DATA: T_ALV_CHECKER_0200 TYPE STANDARD TABLE OF TYP_ALV_CHECKER_0200.

TYPES: BEGIN OF TYP_LOG_DATA,
ROW_ID            TYPE I,
COL_ID            TYPE I,
FIELDNAME(30)     TYPE C,
COLTEXT           TYPE LVC_TXTCOL,
MSGTYP            TYPE BALIMSGTY,
MESSAGE           TYPE BALTMSG,
END OF TYP_LOG_DATA.

* ALV一覧チェック結果表示用内部テーブル（入力画面）
DATA: T_LOG_DATA TYPE STANDARD TABLE OF TYP_LOG_DATA.

*&---------------------------------------------------------------------*
*&      Module  INITIALIZE_0200  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE INITIALIZE_0200 OUTPUT.

CALL METHOD OBJ_GRID_0100->SET_VISIBLE
EXPORTING VISIBLE       = C_OFF.

REFRESH T_LOG_DATA.
* elematec 対応 2011/12/07 ADD >>>
CLEAR:T_LFM1,T_WYT3,T_MWSKZ.
* elematec 対応 2011/12/07 ADD <<<
IF OBJ_GRID_0200 IS INITIAL.
*   出力項目定義取得
PERFORM COSTOMIZE_ALV_0200.
PERFORM SET_T_FCAT_0200.
PERFORM SET_S_LAYOUT_0200.
PERFORM SET_S_VARIANT_0200.
PERFORM SET_T_TOOLBAR_0200.
PERFORM SET_T_FCAT_LOG.
PERFORM SET_S_LAYOUT_LOG.
PERFORM SET_T_GRID_DATA_0200_COLOR.
PERFORM DISPLAY_ALV_GRID_0200.
REFRESH_FLAG = C_OFF.
ENDIF.

ENDMODULE.                 " INITIALIZE_0100  OUTPUT
*&---------------------------------------------------------------------*
*&      Module  REFRESH_ALV_GRID_0200  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE REFRESH_ALV_GRID_0200 OUTPUT.

IF REFRESH_FLAG = C_ON.
PERFORM COSTOMIZE_ALV_0200.
PERFORM SET_T_FCAT_0200.
PERFORM SET_T_GRID_DATA_0200_COLOR.
PERFORM REFRESH_ALV_GRID_LOG.
PERFORM REFRESH_ALV_GRID_0200.
REFRESH_FLAG = C_OFF.
ENDIF.

ENDMODULE.                 " REFRESH_ALV_GRID_0200  OUTPUT
*&---------------------------------------------------------------------*
*&      Module  STATUS_0200  OUTPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE STATUS_0200 OUTPUT.
SET PF-STATUS '0200'.
SET TITLEBAR '0200'.
ENDMODULE.                 " STATUS_0300  OUTPUT
*&---------------------------------------------------------------------*
*&      Module  EXIT_0200  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE EXIT_0200 INPUT.
*-- 20090113 UPD STA 引数にデフォルトボタン追加
PERFORM POPUP_TO_CONFIRM USING C_MSGNO_CONFIRM_EXIT
C_DEFAULT_ONE.
*-- 20090113 UPD END
IF RC_CODE = 0.
RETURN_MODE = C_RETURN_MODE_EXIT.
LEAVE TO SCREEN 0.
ENDIF.
ENDMODULE.                 " EXIT_0300  INPUT
*&---------------------------------------------------------------------*
*&      Module  REFRESH_GRID_DATA_0200  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE REFRESH_GRID_DATA_0200 INPUT.

PERFORM REFRESH_GRID_DATA USING OBJ_GRID_0200.

ENDMODULE.                 " REFRESH_GRID_DATA_0200  INPUT
*&---------------------------------------------------------------------*
*&      Module  USER_COMMAND_0200  INPUT
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
MODULE USER_COMMAND_0200 INPUT.

CASE OK_CODE.
WHEN 'SAVE'.
PERFORM CHECK_INPUT_DATA_0200.
DESCRIBE TABLE T_LOG_DATA LINES COUNTER.
CHECK COUNTER = 0.
PERFORM CHANGE_T_GRID_DATA.
IF RC_CODE = 0.
PERFORM POPUP_TO_INFORM USING C_MSGNO_INFORM_MODIFY.
REFRESH_FLAG = C_ON.
RETURN_MODE = C_RETURN_MODE_SAVE.
LEAVE TO SCREEN 0.
ENDIF.
ENDCASE.

ENDMODULE.                 " USER_COMMAND_0200  INPUT
*&---------------------------------------------------------------------*
*&      Form  DISPLAY_ALV_GRID_0200
*&---------------------------------------------------------------------*
*       ALV一覧表示
*----------------------------------------------------------------------*
FORM DISPLAY_ALV_GRID_0200 .

DATA: LT_F4 TYPE LVC_T_F4.
LT_F4[] = T_F4_0200[].

CREATE OBJECT OBJ_SPLITTER_CONTAINER
EXPORTING
PARENT    = CL_GUI_CONTAINER=>DEFAULT_SCREEN
SASH_POSITION      = 100
WITH_BORDER  = 0.
CREATE OBJECT OBJ_APPLOG_CONTAINER
EXPORTING
CONTAINER_NAME  = 'UNVISIBLE_CONTAINER'.
CALL METHOD OBJ_APPLOG_CONTAINER->SET_VISIBLE
EXPORTING VISIBLE       = C_OFF.
CREATE OBJECT OBJ_GRID_0200
EXPORTING
I_PARENT       = OBJ_SPLITTER_CONTAINER->TOP_LEFT_CONTAINER
I_APPLOGPARENT = OBJ_APPLOG_CONTAINER.
CREATE OBJECT OBJ_EVENT_RECIEVER_0200.
SET HANDLER
OBJ_EVENT_RECIEVER_0200->HANDLE_TOOLBAR FOR OBJ_GRID_0200.
SET HANDLER OBJ_EVENT_RECIEVER_0200->HANDLE_DATA_CHANGED
FOR OBJ_GRID_0200.
SET HANDLER OBJ_EVENT_RECIEVER_0200->HANDLE_DATA_CHANGED_FINISHED
FOR OBJ_GRID_0200.
SET HANDLER OBJ_EVENT_RECIEVER_0200->HANDLE_F4
FOR OBJ_GRID_0200.
SET HANDLER
OBJ_EVENT_RECIEVER_0200->HANDLE_BEFORE_USER_COMMAND
FOR OBJ_GRID_0200.
SET HANDLER
OBJ_EVENT_RECIEVER_0200->HANDLE_AFTER_USER_COMMAND
FOR OBJ_GRID_0200.
*&Ver2 対応 2007/02/28 >>> 外部データ入力の明細コピーボタンの追加
SET HANDLER
OBJ_EVENT_RECIEVER_0200->HANDLE_USER_COMMAND
FOR OBJ_GRID_0200.
*&Ver2 対応 2007/02/28 <<<
CALL METHOD OBJ_GRID_0200->REGISTER_F4_FOR_FIELDS
EXPORTING IT_F4 = LT_F4.
CALL METHOD OBJ_GRID_0200->REGISTER_EDIT_EVENT
EXPORTING I_EVENT_ID = CL_GUI_ALV_GRID=>MC_EVT_ENTER.
CALL METHOD OBJ_GRID_0200->SET_TABLE_FOR_FIRST_DISPLAY
EXPORTING IS_VARIANT            = S_VARIANT_0200
IS_LAYOUT             = S_LAYOUT_0200
IT_TOOLBAR_EXCLUDING  = T_TOOLBAR_0200
I_SAVE                = 'A'
CHANGING  IT_OUTTAB             = T_GRID_DATA_0200
IT_FIELDCATALOG       = T_FCAT_0200
.
CASE INPUT_MODE.
WHEN C_INPUT_MODE_NEW.
PERFORM SET_CELL_FOCUS  USING    OBJ_GRID_0200
1
'YNGJAHR'.
WHEN C_INPUT_MODE_EDIT.
PERFORM SET_CELL_FOCUS  USING    OBJ_GRID_0200
1
'YNZFBDT'.
ENDCASE.

CREATE OBJECT OBJ_GRID_LOG
EXPORTING
I_PARENT       = OBJ_SPLITTER_CONTAINER->BOTTOM_RIGHT_CONTAINER.
CREATE OBJECT OBJ_EVENT_RECIEVER_LOG.
SET HANDLER OBJ_EVENT_RECIEVER_LOG->HANDLE_DOUBLE_CLICK
FOR OBJ_GRID_LOG.
CALL METHOD OBJ_GRID_LOG->SET_TABLE_FOR_FIRST_DISPLAY
EXPORTING IS_LAYOUT       = S_LAYOUT_LOG
CHANGING  IT_OUTTAB       = T_LOG_DATA
IT_FIELDCATALOG = T_FCAT_LOG
.

ENDFORM.                    " DISPLAY_ALV_GRID_0200
*&---------------------------------------------------------------------*
*&      Form  COSTOMIZE_ALV_0200
*&---------------------------------------------------------------------*
*       ALV属性設定（入力画面）
*----------------------------------------------------------------------*
FORM COSTOMIZE_ALV_0200 .

DATA: L_H_ALV_CUSTOMIZER LIKE LINE OF T_ALV_CUSTOMIZER_0200.

REFRESH T_ALV_CUSTOMIZER_0200.

* F4参照属性設定
CLEAR L_H_ALV_CUSTOMIZER.
L_H_ALV_CUSTOMIZER-NAME = 'F4_REF'.
CASE INPUT_MODE.
WHEN C_INPUT_MODE_NEW.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_VRFCTON(1) = 'A'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_BUKRS(1) = 'A'.
WHEN C_INPUT_MODE_EDIT.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_VRFCTON(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_BUKRS(1) = 'X'.
ENDCASE.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_ZFBDT(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_PRCTR(1) = 'A'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_SGTXT(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNUNIT(1) = 'A'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_WAERS(1) = 'A'.
* elematec 対応 2011/12/07 ADD >>>
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST1(1) = 'A'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LDATE1(1) = 'A'.
* elematec 対応 2011/12/07 ADD <<<
APPEND L_H_ALV_CUSTOMIZER TO T_ALV_CUSTOMIZER_0200.

* 編集属性設定
CLEAR L_H_ALV_CUSTOMIZER.
L_H_ALV_CUSTOMIZER-NAME = 'EDIT'.
CASE INPUT_MODE.
WHEN C_INPUT_MODE_NEW.
* elematec 対応 2011/12/07 DEL >>>
*      L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_GJAHR(1) = 'X'.
* elematec 対応 2011/12/07 DEL <<<
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_VRFCTON(1) = 'X'.
* elematec 対応 2011/12/07 DEL >>>
*      L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_BUKRS(1) = 'X'.
* elematec 対応 2011/12/07 DEL <<<
WHEN C_INPUT_MODE_EDIT.
ENDCASE.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_ZFBDT(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_PRCTR(1) = 'X'.
* elematec 対応 2011/12/07 DEL >>>
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_PERNR(1) = 'X'.
* elematec 対応 2011/12/07 DEL <<<
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_DVSON(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_SGTXT(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNQUAN(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNUNIT(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNUNTPRC(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNTAXAMT(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNITXAMT(1) = 'X'.
* elematec 対応 2011/12/07 DEL >>>
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNETXAMT(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_WAERS(1) = 'X'.
* elematec 対応 2011/12/07 DEL <<<
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY1(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY2(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY3(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY4(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY5(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY6(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY7(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY8(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST1(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST2(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST3(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST4(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST5(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST6(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST7(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST8(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST9(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST10(1) = 'X'.
* elematec 対応 2011/12/07 ADD >>>
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LDATE1(1) = 'X'.
* elematec 対応 2011/12/07 ADD <<<
APPEND L_H_ALV_CUSTOMIZER TO T_ALV_CUSTOMIZER_0200.

*&バグ対応 2007/05/22 >>> 大文字/小文字を区別
CLEAR L_H_ALV_CUSTOMIZER.
L_H_ALV_CUSTOMIZER-NAME = 'LOWERCASE'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_PERNR(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_DVSON(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_SGTXT(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY1(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY2(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY3(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY4(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY5(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY6(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY7(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY8(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST1(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST2(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST3(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST4(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST5(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST6(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST7(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST8(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST9(1) = 'X'.
L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST10(1) = 'X'.
APPEND L_H_ALV_CUSTOMIZER TO T_ALV_CUSTOMIZER_0200.
*&バグ対応 2007/05/22 <<< 大文字/小文字を区別

* 列幅自動調整属性設定
*  CLEAR L_H_ALV_CUSTOMIZER.
*  L_H_ALV_CUSTOMIZER-NAME = 'COL_OPT'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_GJAHR(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_VRFCTON(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_BUKRS(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_PRCTR(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_PERNR(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_DVSON(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_SGTXT(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNQUAN(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNUNIT(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNUNTPRC(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNTAXAMT(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNITXAMT(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_KNETXAMT(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_WAERS(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY1(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY2(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY3(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY4(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY5(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY6(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY7(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_CKEY8(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST1(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST2(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST3(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST4(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST5(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST6(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST7(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST8(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST9(1) = 'X'.
*  L_H_ALV_CUSTOMIZER-PROPS+C_ALV_COL2_LIST10(1) = 'X'.
*  APPEND L_H_ALV_CUSTOMIZER TO T_ALV_CUSTOMIZER_0200.

ENDFORM.                    " COSTOMIZE_ALV_0200
*&---------------------------------------------------------------------*
*&      Form  SET_T_FCAT_0200
*&---------------------------------------------------------------------*
*       ALV項目設定
*----------------------------------------------------------------------*
FORM SET_T_FCAT_0200.

PERFORM SET_FIELD_NAME TABLES T_FCAT_0200.
PERFORM SET_FIELD_PROPS_1 TABLES T_FCAT_0200
T_GRID_DATA_0200
T_ALV_CUSTOMIZER_0200.
PERFORM SET_FIELD_PROPS_2 TABLES T_FCAT_0200
T_ALV_CUSTOMIZER_0200.
PERFORM SET_FIELD_PROPS_3 TABLES T_FCAT_0200
T_GRID_DATA_0200
T_ALV_CUSTOMIZER_0200
T_F4_0200.
PERFORM SET_T_COLORS TABLES T_FCAT_0200
T_COLOR_0200
T_ALV_CUSTOMIZER_0200.

ENDFORM.                    " SET_T_FCAT_0200
*&---------------------------------------------------------------------*
*&      Form  SET_T_FCAT_LOG
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM SET_T_FCAT_LOG .

DATA: LS_FCAT_LOG LIKE LINE OF T_FCAT_LOG,
LS_LOG_DATA LIKE LINE OF T_LOG_DATA.
DATA: L_HELP_ID(20) TYPE C,
L_LENGTH TYPE I.
DATA: L_S_DD04V TYPE DD04V.

REFRESH T_FCAT_LOG.

CLEAR LS_FCAT_LOG.
LS_FCAT_LOG-FIELDNAME = 'MSGTYP'.
DESCRIBE FIELD LS_LOG_DATA-MSGTYP HELP-ID L_HELP_ID.
PERFORM GET_DDIF_DTEL USING    L_HELP_ID
CHANGING L_S_DD04V.
LS_FCAT_LOG-COLTEXT   = L_S_DD04V-REPTEXT.
LS_FCAT_LOG-SCRTEXT_S = L_S_DD04V-SCRTEXT_S.
LS_FCAT_LOG-SCRTEXT_M = L_S_DD04V-SCRTEXT_M.
LS_FCAT_LOG-SCRTEXT_L = L_S_DD04V-SCRTEXT_L.
APPEND LS_FCAT_LOG TO T_FCAT_LOG.

CLEAR LS_FCAT_LOG.
LS_FCAT_LOG-FIELDNAME = 'COLTEXT'.
DESCRIBE FIELD LS_LOG_DATA-COLTEXT HELP-ID L_HELP_ID.
PERFORM GET_DDIF_DTEL USING    L_HELP_ID
CHANGING L_S_DD04V.
LS_FCAT_LOG-COLTEXT   = L_S_DD04V-REPTEXT.
LS_FCAT_LOG-SCRTEXT_S = L_S_DD04V-SCRTEXT_S.
LS_FCAT_LOG-SCRTEXT_M = L_S_DD04V-SCRTEXT_M.
LS_FCAT_LOG-SCRTEXT_L = L_S_DD04V-SCRTEXT_L.
APPEND LS_FCAT_LOG TO T_FCAT_LOG.

CLEAR LS_FCAT_LOG.
LS_FCAT_LOG-FIELDNAME = 'MESSAGE'.
LS_FCAT_LOG-OUTPUTLEN = 80.
DESCRIBE FIELD LS_LOG_DATA-MESSAGE HELP-ID L_HELP_ID.
PERFORM GET_DDIF_DTEL USING    L_HELP_ID
CHANGING L_S_DD04V.
LS_FCAT_LOG-COLTEXT   = L_S_DD04V-REPTEXT.
LS_FCAT_LOG-SCRTEXT_S = L_S_DD04V-SCRTEXT_S.
LS_FCAT_LOG-SCRTEXT_M = L_S_DD04V-SCRTEXT_M.
LS_FCAT_LOG-SCRTEXT_L = L_S_DD04V-SCRTEXT_L.
APPEND LS_FCAT_LOG TO T_FCAT_LOG.

ENDFORM.                    " SET_T_FCAT_LOG
*&---------------------------------------------------------------------*
*&      Form  SET_S_VARIANT_0200
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM SET_S_VARIANT_0200 .
S_VARIANT_0200-REPORT = SY-REPID.
S_VARIANT_0200-HANDLE = '0200'.
ENDFORM.                    " SET_S_VARIANT_0200
*&---------------------------------------------------------------------*
*&      Form  SET_S_LAYOUT_0200
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM SET_S_LAYOUT_0200 .

CLEAR S_LAYOUT_0200.
S_LAYOUT_0200-CTAB_FNAME = 'YNCOLORS'.

ENDFORM.                    " SET_S_LAYOUT_0200
*&---------------------------------------------------------------------*
*&      Form  SET_S_LAYOUT_LOG
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM SET_S_LAYOUT_LOG .

S_LAYOUT_LOG-NO_TOOLBAR = 'X'.
S_LAYOUT_LOG-EXCP_LED = 'X'.
S_LAYOUT_LOG-EXCP_FNAME = 'MSGTYP'.

ENDFORM.                    " SET_S_LAYOUT_LOG
*&---------------------------------------------------------------------*
*&      Form  SET_T_TOOLBAR_0200
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
FORM SET_T_TOOLBAR_0200 .

DATA: L_FUNC TYPE UI_FUNC.

L_FUNC = CL_GUI_ALV_GRID=>MC_FC_CHECK.          " エントリチェック
APPEND L_FUNC TO T_TOOLBAR_0200.
L_FUNC = CL_GUI_ALV_GRID=>MC_FC_REFRESH.        " リフレッシュ
APPEND L_FUNC TO T_TOOLBAR_0200.
L_FUNC = CL_GUI_ALV_GRID=>MC_FC_LOC_CUT.        " ローカル: カット
APPEND L_FUNC TO T_TOOLBAR_0200.
L_FUNC = CL_GUI_ALV_GRID=>MC_FC_LOC_COPY.       " ローカル: コピー
APPEND L_FUNC TO T_TOOLBAR_0200.
*&Ver2 対応 2007/02/28 >>> 外部データ入力の明細コピーボタンの追加
L_FUNC = CL_GUI_ALV_GRID=>MC_FC_LOC_COPY_ROW.   " ローカル: 行コピー
APPEND L_FUNC TO T_TOOLBAR_0200.
*&Ver2 対応 2007/02/28 <<<
L_FUNC = CL_GUI_ALV_GRID=>MC_MB_PASTE.          " ペーストメニュー
APPEND L_FUNC TO T_TOOLBAR_0200.
L_FUNC = CL_GUI_ALV_GRID=>MC_FC_LOC_UNDO.       " 元に戻す
APPEND L_FUNC TO T_TOOLBAR_0200.
L_FUNC = CL_GUI_ALV_GRID=>MC_MB_FILTER.         " フィルタ
APPEND L_FUNC TO T_TOOLBAR_0200.
L_FUNC = CL_GUI_ALV_GRID=>MC_MB_VIEW.           " ビューメニュー
APPEND L_FUNC TO T_TOOLBAR_0200.
L_FUNC = CL_GUI_ALV_GRID=>MC_FC_GRAPH.          " グラフィック
APPEND L_FUNC TO T_TOOLBAR_0200.
L_FUNC = CL_GUI_ALV_GRID=>MC_FC_INFO .          " 情報
APPEND L_FUNC TO T_TOOLBAR_0200.

ENDFORM.                    " SET_T_TOOLBAR_0200
*&---------------------------------------------------------------------*
*&      Form  SET_VISIBLE_0200
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*      -->P_VISIBLE   text
*----------------------------------------------------------------------*
FORM SET_VISIBLE_0200  USING    P_VISIBLE.

CALL METHOD OBJ_GRID_0200->SET_VISIBLE
EXPORTING VISIBLE       = P_VISIBLE.

ENDFORM.                    " SET_VISIBLE_0200
